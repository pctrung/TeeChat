{"version":3,"sources":["app/chatSlice.js","app/appSlice.js","app/userSlice.js","app/store.js","logo.png","components/Loader/index.jsx","components/Button/index.jsx","components/Popup/index.jsx","assets/img/default-avatar.jpg","components/ImageCircle/index.jsx","utils/Constants.js","utils/UtilityMethods.js","components/ChatList/index.jsx","assets/icons/info-icon.svg","assets/icons/left-arrow-icon.svg","assets/icons/emoji.svg","assets/icons/image-icon.svg","assets/icons/send-icon.svg","components/ClickableIcon/index.jsx","hooks/useApi.js","hooks/useChatApi.js","components/ChatInput/index.jsx","components/ConfirmModal/index.jsx","hooks/useUserApi.js","components/EditChat/index.jsx","components/ChatWindow/index.jsx","hooks/useMessagePagination.js","components/CreateChat/index.jsx","components/UserInfo/index.jsx","hooks/useDarkMode.js","components/Header/index.jsx","pages/Chat/index.jsx","assets/img/forbid.jpg","pages/Forbid/index.jsx","assets/img/login-page.jpg","pages/Login/index.jsx","assets/img/not-found.jpg","pages/NotFound/index.jsx","pages/Register/index.jsx","assets/img/error.jpg","pages/ServerError/index.jsx","App.js","index.js"],"names":["chats","createSlice","name","initialState","reducers","addChat","state","action","some","chat","id","payload","push","editChat","updatedChat","index","findIndex","participants","editGroupAvatar","updatedChatId","chatId","groupAvatarUrl","addReadByUserName","readByUserName","readByUserNames","includes","appendMessageToChat","chatToAppend","messagesToAppend","messages","totalRecords","limit","page","pageCount","keyword","concat","refreshChats","addMessage","newMessage","message","SenderUserName","addNotification","numOfUnreadMessages","readChat","selectedId","setSelectedId","reducer","combineReducers","actions","isLoading","setIsLoading","popup","isOpen","content","title","setPopup","currentUser","getCurrentUser","user","token","window","localStorage","getItem","jwt","decodeCurrentUser","updateUser","userName","onlineUserNameList","updateOnlineUserNameList","rootReducer","chatReducer","app","appReducer","users","store","configureStore","Loader","className","circleCommonClasses","src","Logo","alt","Button","outline","onClick","onBlur","disabled","children","Popup","ImageCircle","onlineSize","avatarSize","DefaultAvatar","size","useSelector","isCurrentUser","isOnline","filter","x","map","DefaultName","ChatType","ChatClient","formatDate","d","date","Date","isNaN","isValidDate","now","moment","dateToFormat","diff","fromNow","format","checkRegex","value","regex","RegExp","test","identityObjectToString","obj","str","Object","values","val","toString","substring","length","ChatList","dispatch","useDispatch","useState","setKeyword","type","placeholder","onChange","e","target","getCurrentChats","currentUserName","friend","shift","lastMessage","reduce","a","b","dateCreated","handleClick","avatarUrl","fullName","imageUrl","result","sort","chatA","chatB","lastMessageA","lastMessageB","sortChat","toLowerCase","searchChat","ClickableIcon","icon","iconClass","useApi","history","useHistory","Api","axios","create","baseURL","process","timeout","headers","paramsSerializer","params","queryString","stringify","openPopup","interceptors","request","use","config","newConfig","Authorization","response","data","error","popupTitle","status","removeItem","location","href","errors","Promise","reject","baseApiUrl","useChatApi","getAll","url","get","getById","sendMessage","post","patch","sendImage","updateGroupAvatar","createGroupChat","groupName","updateGroupChat","newGroupName","createPrivateChat","ChatInput","setContent","isOpenEmoji","setIsOpenEmoji","ref","useRef","chatApi","preventDefault","file","files","formData","FormData","append","useEffect","checkIfClickedOutside","current","contains","document","addEventListener","removeEventListener","onSubmit","onSendMessage","hidden","accept","htmlFor","ImageIcon","position","EmojiIcon","onEmojiClick","event","emojiObject","emoji","disableAutoFocus","SendIconNormal","ConfirmModal","closeAction","confirmButtonTitle","confirmButtonAction","accountApiUrl","useUserApi","login","register","firstName","lastName","checkUserNameExists","getUserList","updateInformation","put","updateAvatar","EditChat","setIsOpen","isOpenModal","setIsOpenModal","modalContent","setModalContent","setGroupName","avatar","setAvatar","isValidButton","setIsValidButton","friendList","setFriendList","isOpenFriendList","setIsOpenFriendList","selectedFriendList","setSelectedFriendList","userApi","friendListRef","currentParticipantUserNames","selectedParticipantUserNames","participantFullNamesToAdd","participantFullNamesToRemove","participantUserNamesToRemove","forEach","openModal","submitEditChat","participantUserNamesToAdd","then","closeModal","trim","items","onFocus","autoComplete","selected","localeCompare","i","splice","creatorFullName","handleEditChat","ChatWindow","showTimeIndexes","setShowTimeIndexes","isOpenInfoPopup","setIsOpenInfoPopup","setFriend","seenBy","setSeenBy","handleMessageClick","setPage","currentChat","loading","setLoading","setError","appendChat","setAppendChat","hasMore","setHasMore","catch","useMessagePagination","endMessageRef","res","newFriend","newSeenBy","firstNameList","join","scrollIntoView","scrollToBottom","LeftArrowIcon","InfoIcon","prevPage","messageA","messageB","senderUserName","senderFullName","CreateChat","selectedMode","setSelectedMode","participantUserNames","participantUserName","handleCreateGroup","UserInfo","setFirstName","setLastName","aboutMe","phoneNumber","submit","useDarkMode","darkMode","setDarkMode","documentElement","classList","add","setItem","remove","Header","logout","isOpenCreateChat","setIsOpenCreateChat","isOpenUserInfo","setIsOpenUserInfo","confirmModal","setConfirmModal","userAvatar","isOpenMenu","setIsOpenMenu","openConfirmModal","Chat","connection","setConnection","stop","console","fetchData","newConnection","HubConnectionBuilder","withUrl","accessTokenFactory","withAutomaticReconnect","build","connectionStarted","start","on","creatorUserName","find","Forbid","ForbidImg","to","Login","username","setUsername","password","setPassword","isDirty","setIsDirty","LoginPageImage","NotFound","NotFoundImg","Register","isChanged","setIsChanged","isExistsUserName","setIsExistsUserName","schema","yup","shape","required","min","max","email","confirmPassword","watch","useForm","resolver","yupResolver","defaultValues","handleSubmit","control","clearErrors","reset","formState","useWatch","isExists","shouldFocus","ServerError","ErrorImg","App","basename","path","component","PrivateRoute","exact","Component","rest","isLogin","render","props","pathname","from","ReactDOM","StrictMode","getElementById"],"mappings":"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","file":"static/js/main.a9ef6653.chunk.js","sourcesContent":["import { combineReducers, createSlice } from \"@reduxjs/toolkit\";\r\n\r\nconst chats = createSlice({\r\n  name: \"chats\",\r\n  initialState: [],\r\n  reducers: {\r\n    addChat: (state, action) => {\r\n      var isExists = state.some((chat) => chat.id === action.payload.id);\r\n      if (!isExists) {\r\n        state.push(action.payload);\r\n      }\r\n    },\r\n    editChat: (state, action) => {\r\n      const updatedChat = action.payload;\r\n      const index = state.findIndex((chat) => {\r\n        return chat.id === updatedChat.id;\r\n      });\r\n      if (index >= 0) {\r\n        state[index].name = updatedChat.name;\r\n        state[index].participants = updatedChat.participants;\r\n      } else {\r\n        state.push(updatedChat);\r\n      }\r\n    },\r\n    editGroupAvatar: (state, action) => {\r\n      const updatedChatId = action.payload.chatId;\r\n      const index = state.findIndex((chat) => {\r\n        return chat.id === updatedChatId;\r\n      });\r\n      if (index >= 0) {\r\n        state[index].groupAvatarUrl = action.payload?.groupAvatarUrl;\r\n      }\r\n    },\r\n    addReadByUserName: (state, action) => {\r\n      const { chatId, readByUserName } = action.payload;\r\n      const index = state.findIndex((chat) => {\r\n        return chat.id === chatId;\r\n      });\r\n      if (index >= 0) {\r\n        if (!state[index].readByUserNames.includes(readByUserName)) {\r\n          state[index].readByUserNames.push(readByUserName);\r\n        }\r\n      }\r\n    },\r\n    appendMessageToChat: (state, action) => {\r\n      const chatToAppend = action.payload;\r\n      const messagesToAppend = chatToAppend?.messages;\r\n      const index = state.findIndex((chat) => {\r\n        return chat.id === chatToAppend.id;\r\n      });\r\n      if (index >= 0) {\r\n        state[index].totalRecords = chatToAppend.totalRecords;\r\n        state[index].limit = chatToAppend.limit;\r\n        state[index].page = chatToAppend.page;\r\n        state[index].pageCount = chatToAppend.pageCount;\r\n        if (chatToAppend.keyword) {\r\n          state[index].messages = messagesToAppend;\r\n        } else {\r\n          state[index].messages =\r\n            state[index].messages.concat(messagesToAppend);\r\n        }\r\n      }\r\n    },\r\n    refreshChats: (state, action) => {\r\n      state = action.payload ?? [];\r\n      return state;\r\n    },\r\n    addMessage: (state, action) => {\r\n      const newMessage = action.payload;\r\n      const index = state.findIndex((chat) => {\r\n        return chat.id === newMessage.chatId;\r\n      });\r\n      if (index >= 0) {\r\n        state[index].messages.push(newMessage?.message);\r\n        state[index].readByUserNames = [newMessage?.SenderUserName];\r\n      }\r\n    },\r\n    addNotification: (state, action) => {\r\n      const chatId = action.payload;\r\n      const index = state.findIndex((chat) => {\r\n        return chat.id === chatId;\r\n      });\r\n      if (index >= 0) {\r\n        state[index].numOfUnreadMessages += 1;\r\n      }\r\n    },\r\n    readChat: (state, action) => {\r\n      const chatId = action.payload;\r\n      const index = state.findIndex((chat) => {\r\n        return chat.id === chatId;\r\n      });\r\n      if (index >= 0) {\r\n        state[index].numOfUnreadMessages = 0;\r\n      }\r\n    },\r\n  },\r\n});\r\n\r\nconst selectedId = createSlice({\r\n  name: \"selectedId\",\r\n  initialState: 0,\r\n  reducers: {\r\n    setSelectedId: (state, action) => {\r\n      state = action.payload;\r\n      return state;\r\n    },\r\n  },\r\n});\r\n\r\nconst reducer = combineReducers({\r\n  chats: chats.reducer,\r\n  selectedId: selectedId.reducer,\r\n});\r\n\r\nexport const {\r\n  addChat,\r\n  editChat,\r\n  refreshChats,\r\n  addMessage,\r\n  appendMessageToChat,\r\n  editGroupAvatar,\r\n  readChat,\r\n  addNotification,\r\n  addReadByUserName,\r\n} = chats.actions;\r\nexport const { setSelectedId } = selectedId.actions;\r\nexport default reducer;\r\n","import { combineReducers, createSlice } from \"@reduxjs/toolkit\";\r\n\r\nconst isLoading = createSlice({\r\n  name: \"isLoading\",\r\n  initialState: false,\r\n  reducers: {\r\n    setIsLoading: (state, action) => {\r\n      state = action.payload;\r\n      return state;\r\n    },\r\n  },\r\n});\r\n\r\nconst popup = createSlice({\r\n  name: \"popup\",\r\n  initialState: {\r\n    isOpen: false,\r\n    content: \"\",\r\n    title: \"Notification\",\r\n  },\r\n  reducers: {\r\n    setPopup: (state, action) => {\r\n      state = action.payload;\r\n      return state;\r\n    },\r\n  },\r\n});\r\n\r\nconst reducer = combineReducers({\r\n  isLoading: isLoading.reducer,\r\n  popup: popup.reducer,\r\n});\r\n\r\nexport const { setIsLoading } = isLoading.actions;\r\nexport const { setPopup } = popup.actions;\r\nexport default reducer;\r\n","import { combineReducers, createSlice } from \"@reduxjs/toolkit\";\r\nimport jwt from \"jwt-decode\";\r\n\r\nconst currentUser = createSlice({\r\n  name: \"currentUser\",\r\n  initialState: {},\r\n  reducers: {\r\n    getCurrentUser: (state, action) => {\r\n      var user = decodeCurrentUser();\r\n      if (user) {\r\n        state = user;\r\n        return state;\r\n      }\r\n    },\r\n    updateUser: (state, action) => {\r\n      if (action.payload.userName) {\r\n        state = action.payload;\r\n        return state;\r\n      }\r\n    },\r\n  },\r\n});\r\n\r\nconst onlineUserNameList = createSlice({\r\n  name: \"onlineUserNameList\",\r\n  initialState: [],\r\n  reducers: {\r\n    updateOnlineUserNameList: (state, action) => {\r\n      state = action.payload;\r\n      return state;\r\n    },\r\n  },\r\n});\r\n\r\nconst reducer = combineReducers({\r\n  currentUser: currentUser.reducer,\r\n  onlineUserNameList: onlineUserNameList.reducer,\r\n});\r\n\r\nexport const { getCurrentUser, updateUser } = currentUser.actions;\r\nexport const { updateOnlineUserNameList } = onlineUserNameList.actions;\r\nexport default reducer;\r\n\r\nfunction decodeCurrentUser() {\r\n  var token = window.localStorage.getItem(\"token\");\r\n  if (token) {\r\n    const user = jwt(token);\r\n    return user;\r\n  }\r\n  return false;\r\n}\r\n","import { configureStore } from \"@reduxjs/toolkit\";\r\nimport chatReducer from \"app/chatSlice\";\r\nimport appReducer from \"app/appSlice\";\r\nimport userReducer from \"app/userSlice\";\r\n\r\nconst rootReducer = {\r\n  chats: chatReducer,\r\n  app: appReducer,\r\n  users: userReducer,\r\n};\r\n\r\nconst store = configureStore({\r\n  reducer: rootReducer,\r\n});\r\n\r\nexport default store;\r\n","export default __webpack_public_path__ + \"static/media/logo.3faacd46.png\";","import Logo from \"logo.png\";\r\n\r\nconst Loader = ({ className, isOpen = true }) => {\r\n  let circleCommonClasses =\r\n    \"h-3 w-3 bg-gradient-to-br from-green-300 to-green-600 shadow-md rounded-full\";\r\n\r\n  return (\r\n    <>\r\n      <div\r\n        className={\r\n          \"z-50 flex flex-col h-screen w-screen justify-center items-center fixed transition-all duration-200 bg-white dark:bg-dark-secondary\" +\r\n          \" \" +\r\n          (isOpen ? \"animate-fadeIn\" : \"animate-fadeOut\") +\r\n          (\" \" + className ?? \"\")\r\n        }\r\n      >\r\n        <img src={Logo} className=\"w-20 h-20 mb-10\" alt=\"logo\" />\r\n        <div className=\"flex justify-center items-center transition-all duration-200\">\r\n          <div className={`${circleCommonClasses} mr-3 animate-bounce`}></div>\r\n          <div\r\n            className={`${circleCommonClasses} mr-3 animate-bounce200`}\r\n          ></div>\r\n          <div className={`${circleCommonClasses} animate-bounce400`}></div>\r\n        </div>\r\n      </div>\r\n    </>\r\n  );\r\n};\r\n\r\nexport default Loader;\r\n","import React from \"react\";\r\nimport PropTypes from \"prop-types\";\r\n\r\nButton.propTypes = {\r\n  content: PropTypes.string,\r\n  className: PropTypes.string,\r\n};\r\n\r\nfunction Button({\r\n  outline = false,\r\n  content,\r\n  className,\r\n  onClick,\r\n  onBlur,\r\n  disabled,\r\n  children,\r\n}) {\r\n  return (\r\n    <>\r\n      <button\r\n        disabled={disabled}\r\n        onClick={onClick}\r\n        onBlur={onBlur}\r\n        className={\r\n          \"px-4 py-2 rounded-lg transition-all text-sm md:text-base duration-200 disabled:opacity-50 outline-none z-0 select-none min-w-70 \" +\r\n          \" \" +\r\n          (outline\r\n            ? \"ring-inset ring-1 ring-green-500 bg-white dark:bg-transparent dark:hover:bg-green-500 text-green-500 hover:text-white hover:bg-green-400 active:bg-green-500\"\r\n            : \"bg-gradient-to-br from-green-400 to-green-600 text-white active:from-green-500 active:to-green-600  \") +\r\n          \" \" +\r\n          (className ?? \"\") +\r\n          \" \" +\r\n          (!disabled ? \"active:scale-95 active:transform\" : \"cursor-default\")\r\n        }\r\n      >\r\n        {content ? content : children}\r\n      </button>\r\n    </>\r\n  );\r\n}\r\n\r\nexport default Button;\r\n","import Button from \"components/Button\";\r\nimport React from \"react\";\r\nimport PropTypes from \"prop-types\";\r\n\r\nPopup.propTypes = {\r\n  title: PropTypes.string,\r\n  isOpen: PropTypes.bool,\r\n  onClick: PropTypes.func,\r\n};\r\n\r\nfunction Popup({\r\n  title = \"Notification\",\r\n  isOpen,\r\n  content = \"Oops! Something went wrong!\",\r\n  onClick,\r\n}) {\r\n  return (\r\n    isOpen && (\r\n      <div className=\"px-4 animate-fadeIn h-screen fixed inset-0 w-screen flex justify-center items-center bg-gray-500 bg-opacity-30 dark:bg-dark-primary dark:bg-opacity-50 z-50\">\r\n        <div className=\"bg-white shadow-xl dark:bg-dark-secondary py-8 px-8 w-full md:w-2/3 lg:w-1/2 flex flex-col justify-between items-start rounded-xl space-y-6\">\r\n          <h3 className=\"font-semibold text-2xl break-words dark:text-dark-txt\">\r\n            {title}\r\n          </h3>\r\n          <span className=\"break-words dark:text-dark-txt\">{content}</span>\r\n          <div className=\"w-full flex justify-end\">\r\n            <Button content=\"Close\" onClick={onClick} />\r\n          </div>\r\n        </div>\r\n      </div>\r\n    )\r\n  );\r\n}\r\n\r\nexport default Popup;\r\n","export default __webpack_public_path__ + \"static/media/default-avatar.ae67bd1e.jpg\";","import DefaultAvatar from \"assets/img/default-avatar.jpg\";\r\nimport PropTypes from \"prop-types\";\r\nimport React from \"react\";\r\nimport { useSelector } from \"react-redux\";\r\n\r\nImageCircle.propTypes = {\r\n  src: PropTypes.string,\r\n  className: PropTypes.string,\r\n  alt: PropTypes.string,\r\n  size: PropTypes.string,\r\n};\r\n\r\nfunction ImageCircle({\r\n  src = DefaultAvatar,\r\n  className = \"\",\r\n  alt = \"Avatar\",\r\n  size = \"md\",\r\n  userName = \"\",\r\n  participants,\r\n}) {\r\n  const onlineUserNameList = useSelector(\r\n    (state) => state.users.onlineUserNameList,\r\n  );\r\n  const currentUser = useSelector((state) => state.users.currentUser);\r\n\r\n  const isCurrentUser = userName === currentUser.userName;\r\n\r\n  var isOnline = false;\r\n  if (!isCurrentUser) {\r\n    if (userName) {\r\n      isOnline = onlineUserNameList.includes(userName);\r\n    } else if (participants) {\r\n      isOnline = participants\r\n        .filter((x) => x.userName !== currentUser.userName)\r\n        .map((x) => x)\r\n        .some((x) => onlineUserNameList.includes(x.userName));\r\n    }\r\n  }\r\n\r\n  var onlineSize;\r\n  switch (size) {\r\n    case \"xs\":\r\n      onlineSize = \"w-2 h-2\";\r\n      break;\r\n    case \"sm\":\r\n      onlineSize = \"w-2 h-2\";\r\n      break;\r\n    case \"lg\":\r\n      onlineSize = \"border-2 w-4 h-4\";\r\n      break;\r\n    case \"xl\":\r\n      onlineSize = \"border-2 w-4 h-4\";\r\n      break;\r\n    case \"full\":\r\n      onlineSize = \"border-2 w-4 h-4\";\r\n      break;\r\n    default:\r\n      onlineSize = \"border-2 w-4 h-4\";\r\n  }\r\n\r\n  var avatarSize;\r\n  switch (size) {\r\n    case \"xs\":\r\n      avatarSize = \"h-5 w-5 md:h-6 md:w-6\";\r\n      break;\r\n    case \"sm\":\r\n      avatarSize = \"h-6 w-6 md:h-8 md:w-8\";\r\n      break;\r\n    case \"lg\":\r\n      avatarSize = \"h-14 w-14 md:h-16 md:w-16\";\r\n      break;\r\n    case \"xl\":\r\n      avatarSize = \"h-22 w-22 md:h-24 md:w-24\";\r\n      break;\r\n    case \"full\":\r\n      avatarSize = \"h-full w-full\";\r\n      break;\r\n    default:\r\n      avatarSize = \"h-10 w-10 md:h-12 md:w-12\";\r\n  }\r\n  return (\r\n    <div className=\"relative flex-shrink-0\">\r\n      <img\r\n        className={\r\n          avatarSize +\r\n            \" \" +\r\n            \"select-none bg-white rounded-full object-cover flex-shrink-0\" +\r\n            \" \" +\r\n            className ?? \"\"\r\n        }\r\n        src={!src || src === \"\" ? DefaultAvatar : src}\r\n        alt={alt}\r\n      />\r\n      {(isCurrentUser || isOnline) && (\r\n        <span\r\n          className={\r\n            \"absolute bg-green-500 dark:bg-green-400 bottom-0 right-0 rounded-full border-white dark:border-black\" +\r\n            \" \" +\r\n            onlineSize\r\n          }\r\n        ></span>\r\n      )}\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default ImageCircle;\r\n","const DefaultName = {\r\n  NO_NAME_GROUP: \"No name\",\r\n  NO_NAME_USER: \"Unknown\",\r\n};\r\n\r\nconst ChatType = {\r\n  PRIVATE: 1,\r\n  GROUP: 2,\r\n};\r\n\r\nconst ChatClient = {\r\n  RECEIVE_MESSAGE: \"ReceiveMessage\",\r\n  RECEIVE_CHAT: \"ReceiveChat\",\r\n  RECEIVE_UPDATED_CHAT: \"ReceiveUpdatedChat\",\r\n  RECEIVE_UPDATED_GROUP_AVATAR: \"ReceiveUpdatedGroupAvatar\",\r\n  RECEIVE_ADD_READ_BY_USERNAME: \"ReceiveAddReadByUserName\",\r\n  RECEIVE_UPDATED_ONLINE_USERNAME_LIST: \"ReceiveUpdatedOnlineUserNameList\",\r\n};\r\n\r\nexport { ChatType, DefaultName, ChatClient };\r\n","import moment from \"moment\";\r\n\r\nexport function formatDate(d) {\r\n  let date = new Date(d);\r\n  if (isValidDate(date)) {\r\n    let now = moment(new Date());\r\n    let dateToFormat = moment(date);\r\n    let diff = now.diff(dateToFormat, \"days\");\r\n    if (diff < 1) {\r\n      return dateToFormat.fromNow();\r\n    } else if (diff < 7) {\r\n      return dateToFormat.format(\"dddd, h:mm A\");\r\n    } else {\r\n      return dateToFormat.format(\"MMM D, YYYY, h:mm A\");\r\n    }\r\n  } else {\r\n    return \"--\";\r\n  }\r\n}\r\n\r\nfunction isValidDate(d) {\r\n  return d instanceof Date && !isNaN(d);\r\n}\r\n\r\nexport function checkRegex(value, regex) {\r\n  if (value && regex) {\r\n    var pattern = new RegExp(regex);\r\n    var res = pattern.test(value);\r\n    return res;\r\n  }\r\n}\r\n\r\nexport function identityObjectToString(obj) {\r\n  let str = \"\";\r\n  for (const val of Object.values(obj)) {\r\n    str += `${val.toString()}, `;\r\n  }\r\n  str = str.substring(0, str.length - 2);\r\n  return str;\r\n}\r\n","import { setSelectedId } from \"app/chatSlice\";\r\nimport ImageCircle from \"components/ImageCircle\";\r\nimport Logo from \"logo.png\";\r\nimport React, { useState } from \"react\";\r\nimport { useDispatch, useSelector } from \"react-redux\";\r\nimport { ChatType, DefaultName } from \"utils/Constants\";\r\nimport { formatDate } from \"utils/UtilityMethods\";\r\n\r\nfunction ChatList() {\r\n  const chats = useSelector((state) => state.chats.chats);\r\n  const selectedId = useSelector((state) => state.chats.selectedId);\r\n  const currentUser = useSelector((state) => state.users.currentUser);\r\n  const dispatch = useDispatch();\r\n\r\n  const [keyword, setKeyword] = useState(\"\");\r\n\r\n  function handleClick(id) {\r\n    if (id !== selectedId) {\r\n      const action = setSelectedId(id);\r\n      dispatch(action);\r\n    }\r\n  }\r\n\r\n  return (\r\n    <>\r\n      <div className=\"relative\">\r\n        <input\r\n          type=\"search\"\r\n          className=\"my-3 rounded-3xl bg-gray-100 px-4 pl-10 pr-3 py-2 focus:ring-2 focus:ring-green-400 focus:ring-opacity-50 outline-none transition-all duration-200 w-full dark:bg-dark-secondary dark:text-white\"\r\n          placeholder=\"Search chat\"\r\n          onChange={(e) => setKeyword(e.target.value)}\r\n        />\r\n        <i className=\"bx bx-search absolute text-xl top-1/2 left-3 transform text-gray-400 -translate-y-1/2 cursor-pointer\"></i>\r\n      </div>\r\n\r\n      <div className=\"h-full overflow-x-hidden space-y-2 overflow-y-auto pr-2 pb-48 md:pb-0\">\r\n        {chats &&\r\n          getCurrentChats(chats, keyword).map((chat, index) => {\r\n            const currentUserName = currentUser.userName;\r\n\r\n            // check current user still exist in chat (remove participant case)\r\n            var isValid = chat?.participants.some(\r\n              (x) => x.userName === currentUserName,\r\n            );\r\n            if (!isValid) {\r\n              return;\r\n            }\r\n\r\n            const friend =\r\n              chat?.participants.length > 1\r\n                ? chat?.participants\r\n                    ?.filter((x) => x.userName !== currentUserName)\r\n                    .shift()\r\n                : currentUser;\r\n            let lastMessage = {};\r\n            if (chat.messages?.length !== 0) {\r\n              lastMessage = chat.messages?.reduce((a, b) =>\r\n                a?.dateCreated > b?.dateCreated ? a : b,\r\n              );\r\n            }\r\n            return (\r\n              <div\r\n                key={chat.id}\r\n                className={\r\n                  \"relative select-none w-full h-20 flex flex-start cursor-pointer hover:bg-gray-100 p-2 rounded-lg transition-all duration-150 ease-in dark:hover:bg-dark-secondary dark:text-dark-txt\" +\r\n                  \" \" +\r\n                  (selectedId === chat.id\r\n                    ? \"bg-gray-100 dark:bg-dark-secondary\"\r\n                    : \"\")\r\n                }\r\n                onClick={() => handleClick(chat.id)}\r\n              >\r\n                {chat.numOfUnreadMessages > 0 && selectedId !== chat.id && (\r\n                  <span className=\"w-6 h-6 absolute right-7 top-1/2 text-xs font-bold p-1 bg-green-500 dark:bg-green-600 text-white rounded-full text-center align-middle\">\r\n                    {chat.numOfUnreadMessages > 9\r\n                      ? \"9+\"\r\n                      : chat.numOfUnreadMessages}\r\n                  </span>\r\n                )}\r\n                <ImageCircle\r\n                  src={\r\n                    chat?.type === ChatType.PRIVATE\r\n                      ? friend?.avatarUrl\r\n                      : chat?.groupAvatarUrl\r\n                  }\r\n                  size=\"lg\"\r\n                  participants={chat?.participants}\r\n                />\r\n\r\n                <div className=\"font-primary flex flex-col px-3 py-2 justify-between truncate w-full\">\r\n                  <div className=\"flex justify-between items-center w-full min-w-0 space-x-3\">\r\n                    <span\r\n                      className={\r\n                        \"text-gray-800 truncate dark:text-dark-txt\" +\r\n                        \" \" +\r\n                        (chat.numOfUnreadMessages > 0 && selectedId !== chat.id\r\n                          ? \"font-bold\"\r\n                          : \"\")\r\n                      }\r\n                    >\r\n                      {chat?.type === ChatType.PRIVATE\r\n                        ? friend?.fullName\r\n                        : chat?.name ?? DefaultName.NO_NAME_GROUP}\r\n                    </span>\r\n                    <span className=\"text-sm text-gray-500 truncate flex-shrink-0\">\r\n                      {formatDate(\r\n                        lastMessage?.dateCreated ?? chat?.dateCreated,\r\n                      )}\r\n                    </span>\r\n                  </div>\r\n                  <div className=\"flex\">\r\n                    <span\r\n                      className={\r\n                        \"mr-2 text-sm text-gray-500 truncate overflow-hidden flex-grow\" +\r\n                        \" \" +\r\n                        (chat.numOfUnreadMessages > 0 && selectedId !== chat.id\r\n                          ? \"font-bold mr-10\"\r\n                          : \"\")\r\n                      }\r\n                    >\r\n                      {lastMessage.content\r\n                        ? lastMessage.content\r\n                        : lastMessage.imageUrl\r\n                        ? \"Sent an image\"\r\n                        : \"\"}\r\n                    </span>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            );\r\n          })}\r\n        {chats?.length === 0 && (\r\n          <div className=\"animate-fadeIn flex md:hidden items-center justify-center lg:col-span-9 md:col-span-8 col-span-12 flex-col h-full w-full\">\r\n            <img src={Logo} className=\"w-16 h-16 mb-3\" alt=\"logo\" />\r\n            <span className=\"text-center\">\r\n              {\" \"}\r\n              Welcome to{\" \"}\r\n              <span className=\"text-green-600 dark:text-green-400 font-bold\">\r\n                TeeChat!\r\n              </span>{\" \"}\r\n              <br />\r\n              You do not have any chats, please start a chat!{\" \"}\r\n            </span>\r\n            <span></span>\r\n          </div>\r\n        )}\r\n      </div>\r\n    </>\r\n  );\r\n}\r\n\r\nexport default ChatList;\r\n\r\nfunction getCurrentChats(chats, keyword) {\r\n  var result = sortChat(chats);\r\n  result = searchChat(result, keyword);\r\n  return result;\r\n}\r\n\r\nfunction sortChat(chats) {\r\n  if (chats) {\r\n    return [...chats].sort((chatA, chatB) => {\r\n      let lastMessageA = {};\r\n      let lastMessageB = {};\r\n      // check if chat no message => return date created of chat\r\n      if (chatA.messages?.length !== 0) {\r\n        lastMessageA = chatA.messages?.reduce((a, b) => {\r\n          return a?.dateCreated > b?.dateCreated ? a : b;\r\n        });\r\n      } else {\r\n        lastMessageA.dateCreated = chatA?.dateCreated;\r\n      }\r\n      if (chatB.messages?.length !== 0) {\r\n        lastMessageB = chatB.messages?.reduce((a, b) =>\r\n          a?.dateCreated > b?.dateCreated ? a : b,\r\n        );\r\n      } else {\r\n        lastMessageB.dateCreated = chatB?.dateCreated;\r\n      }\r\n\r\n      return lastMessageA?.dateCreated < lastMessageB?.dateCreated ? 1 : -1;\r\n    });\r\n  }\r\n}\r\n\r\nfunction searchChat(chats, keyword) {\r\n  if (chats) {\r\n    return chats.filter((chat) => {\r\n      let isValid = chat?.participants.some((x) => {\r\n        if (\r\n          x.fullName.toLowerCase().includes(keyword.toLowerCase()) ||\r\n          x?.userName.toLowerCase().includes(keyword.toLowerCase())\r\n        ) {\r\n          return true;\r\n        }\r\n        return false;\r\n      });\r\n      return (\r\n        isValid || chat?.name?.toLowerCase().includes(keyword.toLowerCase())\r\n      );\r\n    });\r\n  }\r\n}\r\n","export default __webpack_public_path__ + \"static/media/info-icon.b4879a5e.svg\";","export default __webpack_public_path__ + \"static/media/left-arrow-icon.07714e5b.svg\";","export default __webpack_public_path__ + \"static/media/emoji.21d0cbf4.svg\";","export default __webpack_public_path__ + \"static/media/image-icon.c8ad9f46.svg\";","export default __webpack_public_path__ + \"static/media/send-icon.666dadc9.svg\";","import React from \"react\";\r\nimport PropTypes from \"prop-types\";\r\n\r\nClickableIcon.propTypes = {\r\n  className: PropTypes.string,\r\n  alt: PropTypes.string,\r\n};\r\n\r\nfunction ClickableIcon({ className, icon, iconClass, alt, onClick, onBlur }) {\r\n  return (\r\n    <>\r\n      <div\r\n        onBlur={onBlur}\r\n        onClick={onClick}\r\n        className={\r\n          \"p-1 rounded-full hover:bg-gray-200 active:bg-gray-300 dark:hover:bg-dark-hover dark:border-dark-third transition-all duration-200 cursor-pointer ease-in dark:active:bg-dark-third active:scale-90 active:transform select-none flex-shrink-0 \" +\r\n          (className ?? \"\")\r\n        }\r\n      >\r\n        {icon ? (\r\n          <img\r\n            alt={alt ?? \"Clickable Icon\"}\r\n            src={icon}\r\n            onClick={onClick}\r\n            className=\"w-full\"\r\n          />\r\n        ) : (\r\n          <i\r\n            className={\r\n              \"text-center align-middle text-xl text-black dark:text-dark-txt w-7 h-7 \" +\r\n              \" \" +\r\n              iconClass\r\n            }\r\n          ></i>\r\n        )}\r\n      </div>\r\n    </>\r\n  );\r\n}\r\n\r\nexport default ClickableIcon;\r\n","import { setIsLoading, setPopup } from \"app/appSlice\";\r\nimport axios from \"axios\";\r\nimport queryString from \"query-string\";\r\nimport { useDispatch } from \"react-redux\";\r\nimport { useHistory } from \"react-router-dom\";\r\nimport { identityObjectToString } from \"utils/UtilityMethods\";\r\n\r\nexport default function useApi() {\r\n  const dispatch = useDispatch();\r\n  const history = useHistory();\r\n\r\n  const Api = axios.create({\r\n    baseURL: process.env.REACT_APP_API_URL,\r\n    timeout: 300000,\r\n    headers: {\r\n      \"Content-Type\": \"application/json\",\r\n    },\r\n    paramsSerializer: (params) => queryString.stringify(params),\r\n  });\r\n\r\n  Api.interceptors.request.use(async (config) => {\r\n    var token = window.localStorage.getItem(\"token\");\r\n\r\n    var newConfig = config;\r\n    if (token) {\r\n      newConfig = {\r\n        ...config,\r\n        headers: { Authorization: `Bearer ${token}` },\r\n      };\r\n    }\r\n    return newConfig;\r\n  });\r\n  Api.interceptors.response.use(\r\n    (response) => {\r\n      dispatch(setIsLoading(false));\r\n\r\n      if (response && response.data) {\r\n        return response.data;\r\n      }\r\n      return response;\r\n    },\r\n    (error) => {\r\n      dispatch(setIsLoading(false));\r\n      var message =\r\n        typeof error.response?.data === \"string\"\r\n          ? error.response?.data\r\n          : \"Oops, something went wrong! Please contact administrator.\";\r\n\r\n      if (error.response) {\r\n        var popupTitle = \"Notification\";\r\n        switch (error.response.status) {\r\n          case 401:\r\n            popupTitle = \"Login required\";\r\n            window.localStorage.removeItem(\"token\");\r\n            window.location.href = process.env.PUBLIC_URL + \"/\";\r\n            break;\r\n          case 403:\r\n            popupTitle = \"Forbidden\";\r\n            history?.push(\"/ForBid\");\r\n            break;\r\n          case 500:\r\n            popupTitle = \"Server error\";\r\n            history?.push(\"/ServerError\");\r\n            break;\r\n          default:\r\n            // for model binding error\r\n            message = error.response?.data?.errors\r\n              ? identityObjectToString(error.response?.data?.errors)\r\n              : message;\r\n\r\n            openPopup(popupTitle, message);\r\n            return Promise.reject(error.response?.data);\r\n        }\r\n      }\r\n\r\n      if (message.toLowerCase().includes(\"Unable to identify user\")) {\r\n        openPopup(popupTitle, message);\r\n        window.localStorage.removeItem(\"token\");\r\n        window.location.href = process.env.PUBLIC_URL + \"/\";\r\n      }\r\n      history?.push(\"/ServerError\");\r\n\r\n      return Promise.reject(error?.response?.data);\r\n    },\r\n  );\r\n\r\n  function openPopup(title, content) {\r\n    const popup = {\r\n      isOpen: true,\r\n      title: title,\r\n      content: content,\r\n    };\r\n    dispatch(setPopup(popup));\r\n  }\r\n\r\n  return Api;\r\n}\r\n","import { setIsLoading } from \"app/appSlice.js\";\r\nimport { useDispatch } from \"react-redux\";\r\nimport useApi from \"./useApi.js\";\r\n\r\nconst baseApiUrl = \"/chats\";\r\n\r\nexport default function useChatApi() {\r\n  const Api = useApi();\r\n  const dispatch = useDispatch();\r\n\r\n  const chatApi = {\r\n    getAll: () => {\r\n      dispatch(setIsLoading(true));\r\n      const url = `${baseApiUrl}`;\r\n      return Api.get(url);\r\n    },\r\n    getById: (chatId, params) => {\r\n      dispatch(setIsLoading(true));\r\n      const url = `${baseApiUrl}/${chatId}`;\r\n      return Api.get(url, { params });\r\n    },\r\n    sendMessage: (chatId, content) => {\r\n      const url = `${baseApiUrl}/${chatId}/send`;\r\n      return Api.post(url, content);\r\n    },\r\n    readChat: (chatId) => {\r\n      const url = `${baseApiUrl}/${chatId}/read`;\r\n      return Api.patch(url);\r\n    },\r\n    sendImage: (chatId, content) => {\r\n      dispatch(setIsLoading(true));\r\n      const url = `${baseApiUrl}/${chatId}/sendImage`;\r\n\r\n      Api.interceptors.request.use(async (config) => {\r\n        var token = window.localStorage.getItem(\"token\");\r\n        var newConfig = {};\r\n        if (token) {\r\n          newConfig = {\r\n            ...config,\r\n            headers: {\r\n              \"content-type\": \"multipart/form-data\",\r\n              Authorization: `Bearer ${token}`,\r\n            },\r\n          };\r\n        }\r\n        return newConfig;\r\n      });\r\n      return Api.post(url, content);\r\n    },\r\n    updateGroupAvatar: (chatId, content) => {\r\n      dispatch(setIsLoading(true));\r\n      const url = `${baseApiUrl}/${chatId}/avatar`;\r\n\r\n      Api.interceptors.request.use(async (config) => {\r\n        var token = window.localStorage.getItem(\"token\");\r\n        var newConfig = {};\r\n        if (token) {\r\n          newConfig = {\r\n            ...config,\r\n            headers: {\r\n              \"content-type\": \"multipart/form-data\",\r\n              Authorization: `Bearer ${token}`,\r\n            },\r\n          };\r\n        }\r\n        return newConfig;\r\n      });\r\n      return Api.patch(url, content);\r\n    },\r\n    createGroupChat: (content) => {\r\n      content.groupName = content?.groupName?.substring(0, 99);\r\n\r\n      dispatch(setIsLoading(true));\r\n      const url = `${baseApiUrl}/group`;\r\n      return Api.post(url, content);\r\n    },\r\n    updateGroupChat: (chatId, content) => {\r\n      content.newGroupName = content?.newGroupName?.substring(0, 99);\r\n\r\n      dispatch(setIsLoading(true));\r\n      const url = `${baseApiUrl}/${chatId}`;\r\n      return Api.patch(url, content);\r\n    },\r\n    createPrivateChat: (content) => {\r\n      dispatch(setIsLoading(true));\r\n      const url = `${baseApiUrl}/private`;\r\n      return Api.post(url, content);\r\n    },\r\n  };\r\n  return chatApi;\r\n}\r\n","import EmojiIcon from \"assets/icons/emoji.svg\";\r\nimport ImageIcon from \"assets/icons/image-icon.svg\";\r\nimport SendIconNormal from \"assets/icons/send-icon.svg\";\r\nimport ClickableIcon from \"components/ClickableIcon\";\r\nimport Picker from \"emoji-picker-react\";\r\nimport useChatApi from \"hooks/useChatApi\";\r\nimport PropTypes from \"prop-types\";\r\nimport React, { useEffect, useRef, useState } from \"react\";\r\n\r\nChatInput.propTypes = {\r\n  chatId: PropTypes.number,\r\n};\r\n\r\nfunction ChatInput({ chatId }) {\r\n  const [content, setContent] = useState(\"\");\r\n  const [isOpenEmoji, setIsOpenEmoji] = useState(false);\r\n  const ref = useRef();\r\n\r\n  const chatApi = useChatApi();\r\n\r\n  async function onSendMessage(e) {\r\n    e.preventDefault();\r\n    if (!content) {\r\n      return;\r\n    }\r\n    setContent(\"\");\r\n\r\n    var request = { content };\r\n    await chatApi.sendMessage(chatId, request);\r\n  }\r\n\r\n  const onEmojiClick = (event, emojiObject) => {\r\n    if (emojiObject?.emoji) {\r\n      setContent(content + emojiObject?.emoji);\r\n    }\r\n  };\r\n\r\n  useEffect(() => {\r\n    const checkIfClickedOutside = (e) => {\r\n      // If the menu is open and the clicked target is not within the menu,\r\n      // then close the menu\r\n      if (isOpenEmoji && ref.current && !ref.current.contains(e.target)) {\r\n        setIsOpenEmoji(false);\r\n      }\r\n    };\r\n    document.addEventListener(\"mousedown\", checkIfClickedOutside);\r\n    return () => {\r\n      // Cleanup the event listener\r\n      document.removeEventListener(\"mousedown\", checkIfClickedOutside);\r\n    };\r\n  }, [isOpenEmoji]);\r\n\r\n  async function sendImage(e) {\r\n    var file = e.target.files[0];\r\n    const formData = new FormData();\r\n    formData.append(\"Image\", file);\r\n\r\n    await chatApi.sendImage(chatId, formData);\r\n  }\r\n  return (\r\n    <div>\r\n      <form\r\n        onSubmit={(e) => onSendMessage(e)}\r\n        className=\"flex justify-between items-center space-x-1 pl-4 pr-2 md:pr-6 z-0\"\r\n      >\r\n        <div className=\"relative w-full flex\">\r\n          <input\r\n            id=\"imageFile\"\r\n            type=\"file\"\r\n            hidden\r\n            accept=\"image/png, image/jpg, image/tiff, image/tif, image/jpeg\"\r\n            onChange={sendImage}\r\n          />\r\n          <label htmlFor=\"imageFile\">\r\n            <ClickableIcon className=\"h-10 w-10 p-2 mr-2\" icon={ImageIcon} />\r\n          </label>\r\n          <input\r\n            value={content}\r\n            onChange={(e) => setContent(e.target.value)}\r\n            type=\"text\"\r\n            placeholder=\"Aa\"\r\n            className=\"bg-gray-200 dark:bg-dark-secondary rounded-3xl w-full py-2 px-4 pr-12 focus:ring-2 focus:ring-green-500 focus:ring-opacity-50 outline-none transition-all duration-200 relative\"\r\n          />\r\n          <div ref={ref} position=\"relative\">\r\n            <ClickableIcon\r\n              className=\"absolute h-10 w-10 p-2 right-1 top-0\"\r\n              icon={EmojiIcon}\r\n              onClick={() => setIsOpenEmoji(!isOpenEmoji)}\r\n            />\r\n            <div\r\n              className={\r\n                \"animate-fadeIn absolute right-0 bottom-full \" +\r\n                \" \" +\r\n                (isOpenEmoji ? \"visible\" : \"invisible\")\r\n              }\r\n            >\r\n              <Picker onEmojiClick={onEmojiClick} />\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n        <button>\r\n          <ClickableIcon\r\n            disableAutoFocus\r\n            icon={SendIconNormal}\r\n            className=\"w-12 h-12 p-3\"\r\n          />\r\n        </button>\r\n      </form>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default ChatInput;\r\n","import Button from \"components/Button\";\r\nimport React from \"react\";\r\nimport PropTypes from \"prop-types\";\r\n\r\nConfirmModal.propTypes = {\r\n  title: PropTypes.string,\r\n  isOpen: PropTypes.bool,\r\n  confirmButtonTitle: PropTypes.string,\r\n  confirmButtonAction: PropTypes.func,\r\n};\r\n\r\nfunction ConfirmModal({\r\n  title,\r\n  isOpen,\r\n  content = \"Are you sure?\",\r\n  closeAction,\r\n  confirmButtonTitle,\r\n  confirmButtonAction,\r\n}) {\r\n  return (\r\n    isOpen && (\r\n      <div className=\"px-4 animate-fadeIn h-screen fixed inset-0 w-screen flex justify-center items-center bg-gray-500 dark:bg-dark-primary dark:bg-opacity-50 bg-opacity-30 z-50\">\r\n        <div className=\"bg-white dark:bg-dark-secondary dark:border-dark-third py-8 px-8 w-full md:w-2/3 lg:w-1/2 flex flex-col justify-between items-start rounded-xl space-y-6 shadow-xl\">\r\n          <h3 className=\"font-semibold text-2xl break-words dark:text-dark-txt\">\r\n            {title !== \"\" ? title : \"Notification\"}\r\n          </h3>\r\n          <span className=\"break-words dark:text-dark-txt\">{content}</span>\r\n          <div className=\"w-full flex justify-end space-x-2\">\r\n            <Button outline content=\"No\" onClick={closeAction} />\r\n            <Button\r\n              content={confirmButtonTitle ?? \"Ok\"}\r\n              onClick={confirmButtonAction}\r\n            />\r\n          </div>\r\n        </div>\r\n      </div>\r\n    )\r\n  );\r\n}\r\n\r\nexport default ConfirmModal;\r\n","import { setIsLoading } from \"app/appSlice.js\";\r\nimport { useDispatch } from \"react-redux\";\r\nimport useApi from \"./useApi.js\";\r\n\r\nconst baseApiUrl = \"/users\";\r\nconst accountApiUrl = \"/accounts\";\r\n\r\nexport default function useUserApi() {\r\n  const Api = useApi();\r\n  const dispatch = useDispatch();\r\n\r\n  const userApi = {\r\n    login: (content) => {\r\n      dispatch(setIsLoading(true));\r\n      const url = `${accountApiUrl}/login`;\r\n      return Api.post(url, content);\r\n    },\r\n    register: (content) => {\r\n      content.firstName = content?.firstName?.substring(0, 49);\r\n      content.lastName = content?.lastName?.substring(0, 49);\r\n\r\n      dispatch(setIsLoading(true));\r\n      const url = `${accountApiUrl}/register`;\r\n      return Api.post(url, content);\r\n    },\r\n    checkUserNameExists: (userName) => {\r\n      if (userName) {\r\n        const url = `${accountApiUrl}/${userName}/isExists`;\r\n        return Api.get(url);\r\n      }\r\n      return Promise.reject();\r\n    },\r\n    getUserList: () => {\r\n      const url = `${baseApiUrl}`;\r\n      return Api.get(url);\r\n    },\r\n    getCurrentUser: () => {\r\n      const url = `${baseApiUrl}/current`;\r\n      return Api.get(url);\r\n    },\r\n    updateInformation: (content) => {\r\n      dispatch(setIsLoading(true));\r\n      const url = `${baseApiUrl}`;\r\n      return Api.put(url, content);\r\n    },\r\n    updateAvatar: (content) => {\r\n      dispatch(setIsLoading(true));\r\n      const url = `${baseApiUrl}/avatar`;\r\n      Api.interceptors.request.use(async (config) => {\r\n        var token = window.localStorage.getItem(\"token\");\r\n        var newConfig = {};\r\n        if (token) {\r\n          newConfig = {\r\n            ...config,\r\n            headers: {\r\n              \"content-type\": \"multipart/form-data\",\r\n              Authorization: `Bearer ${token}`,\r\n            },\r\n          };\r\n        }\r\n        return newConfig;\r\n      });\r\n      return Api.patch(url, content);\r\n    },\r\n  };\r\n  return userApi;\r\n}\r\n","import { setSelectedId } from \"app/chatSlice\";\r\nimport Button from \"components/Button\";\r\nimport ConfirmModal from \"components/ConfirmModal\";\r\nimport ImageCircle from \"components/ImageCircle\";\r\nimport Popup from \"components/Popup\";\r\nimport useChatApi from \"hooks/useChatApi\";\r\nimport useUserApi from \"hooks/useUserApi\";\r\nimport React, { useEffect, useRef, useState } from \"react\";\r\nimport { useDispatch, useSelector } from \"react-redux\";\r\nimport { ChatType, DefaultName } from \"utils/Constants\";\r\nimport { formatDate } from \"utils/UtilityMethods\";\r\n\r\nfunction EditChat({ isOpen, setIsOpen, chat }) {\r\n  const [isOpenModal, setIsOpenModal] = useState(false);\r\n  const [modalContent, setModalContent] = useState(\"\");\r\n\r\n  const [groupName, setGroupName] = useState(chat?.name);\r\n  const [keyword, setKeyword] = useState(\"\");\r\n  const [avatar, setAvatar] = useState(false);\r\n\r\n  const [isValidButton, setIsValidButton] = useState(false);\r\n  const [friendList, setFriendList] = useState([]);\r\n  const [isOpenFriendList, setIsOpenFriendList] = useState(false);\r\n  const [selectedFriendList, setSelectedFriendList] = useState(\r\n    chat?.participants,\r\n  );\r\n\r\n  const chatApi = useChatApi();\r\n  const userApi = useUserApi();\r\n\r\n  const [popup, setPopup] = useState({\r\n    isOpen: false,\r\n    content: \"\",\r\n    title: \"Notification\",\r\n  });\r\n\r\n  const currentUser = useSelector((state) => state.users.currentUser);\r\n  const dispatch = useDispatch();\r\n  const ref = useRef();\r\n  const friendListRef = useRef();\r\n\r\n  useEffect(() => {\r\n    setIsValidButton(groupName?.trim() ? true : false);\r\n  }, [groupName]);\r\n  useEffect(() => {\r\n    const checkIfClickedOutside = (e) => {\r\n      // If the menu is open and the clicked target is not within the menu,\r\n      // then close the menu\r\n      if (isOpen && ref.current && !ref.current.contains(e.target)) {\r\n        setIsOpen(false);\r\n      }\r\n    };\r\n    document.addEventListener(\"mousedown\", checkIfClickedOutside);\r\n    return () => {\r\n      // Cleanup the event listener\r\n      document.removeEventListener(\"mousedown\", checkIfClickedOutside);\r\n    };\r\n  }, [isOpen]);\r\n  useEffect(() => {\r\n    const checkIfClickedOutside = (e) => {\r\n      // If the menu is open and the clicked target is not within the menu,\r\n      // then close the menu\r\n      if (\r\n        isOpenFriendList &&\r\n        friendListRef.current &&\r\n        !friendListRef.current.contains(e.target)\r\n      ) {\r\n        setIsOpenFriendList(false);\r\n      }\r\n    };\r\n    document.addEventListener(\"mousedown\", checkIfClickedOutside);\r\n    return () => {\r\n      // Cleanup the event listener\r\n      document.removeEventListener(\"mousedown\", checkIfClickedOutside);\r\n    };\r\n  }, [isOpenFriendList]);\r\n\r\n  useEffect(() => {\r\n    userApi.getUserList().then((response) => {\r\n      if (response) {\r\n        setFriendList(response.items ?? response);\r\n      }\r\n    });\r\n  }, []);\r\n  useEffect(() => {\r\n    setSelectedFriendList(chat?.participants);\r\n    setGroupName(chat?.name);\r\n  }, [chat]);\r\n\r\n  async function handleEditChat() {\r\n    var currentParticipantUserNames = chat?.participants.map((x) => x.userName);\r\n    var selectedParticipantUserNames = selectedFriendList.map(\r\n      (x) => x.userName,\r\n    );\r\n    var participantFullNamesToAdd = [];\r\n    var participantFullNamesToRemove = [];\r\n    var participantUserNamesToRemove = [];\r\n\r\n    // create request with added username and removed username\r\n    selectedFriendList.forEach((user) => {\r\n      if (!currentParticipantUserNames.some((x) => x === user.userName)) {\r\n        participantFullNamesToAdd.push(user.fullName);\r\n      }\r\n    });\r\n    chat?.participants.forEach((user) => {\r\n      if (!selectedParticipantUserNames.some((x) => x === user.userName)) {\r\n        participantFullNamesToRemove.push(user.fullName);\r\n        participantUserNamesToRemove.push(user.userName);\r\n      }\r\n    });\r\n\r\n    if (participantFullNamesToRemove.length > 0) {\r\n      var content = \"\";\r\n\r\n      if (\r\n        participantUserNamesToRemove.some((x) => x === currentUser.userName)\r\n      ) {\r\n        if (participantFullNamesToRemove.length === 1) {\r\n          content = \"Do you want to leave this group?\";\r\n          openModal(content);\r\n          return <></>;\r\n        } else {\r\n          content = \"Do you want to leave this group and remove \";\r\n        }\r\n      } else {\r\n        content = \"Do you want to remove \";\r\n      }\r\n\r\n      participantFullNamesToRemove.forEach((fullName, index) => {\r\n        if (participantUserNamesToRemove[index] !== currentUser.userName) {\r\n          content += `'${fullName}'`;\r\n          if (index !== participantFullNamesToRemove.length - 1) {\r\n            content += \", \";\r\n          }\r\n        }\r\n      });\r\n\r\n      content += \" from this chat?\";\r\n      openModal(content);\r\n    } else {\r\n      await submitEditChat();\r\n    }\r\n  }\r\n  async function submitEditChat() {\r\n    var currentParticipantUserNames = chat?.participants.map((x) => x.userName);\r\n    var selectedParticipantUserNames = selectedFriendList.map(\r\n      (x) => x.userName,\r\n    );\r\n    var participantUserNamesToAdd = [];\r\n    var participantUserNamesToRemove = [];\r\n\r\n    // create request with added username and removed username\r\n    selectedParticipantUserNames.forEach((userName) => {\r\n      if (!currentParticipantUserNames.includes(userName)) {\r\n        participantUserNamesToAdd.push(userName);\r\n      }\r\n    });\r\n    currentParticipantUserNames.forEach((userName) => {\r\n      if (!selectedParticipantUserNames.includes(userName)) {\r\n        participantUserNamesToRemove.push(userName);\r\n      }\r\n    });\r\n\r\n    const request = {\r\n      newGroupName: groupName,\r\n      participantUserNamesToAdd,\r\n      participantUserNamesToRemove,\r\n    };\r\n\r\n    chatApi.updateGroupChat(chat?.id, request).then(async (response) => {\r\n      if (avatar) {\r\n        await updateGroupAvatar();\r\n      }\r\n      openPopup(\"Success\", \"Update info successfully!\");\r\n    });\r\n\r\n    const isLeaveGroup = participantUserNamesToRemove.some(\r\n      (x) => x === currentUser.userName,\r\n    );\r\n    if (isLeaveGroup) {\r\n      dispatch(setSelectedId(0));\r\n    }\r\n    closeModal();\r\n  }\r\n\r\n  async function updateGroupAvatar(e) {\r\n    const formData = new FormData();\r\n    formData.append(\"Avatar\", avatar);\r\n    await chatApi.updateGroupAvatar(chat?.id, formData);\r\n    setAvatar(false);\r\n  }\r\n\r\n  function openPopup(title, content) {\r\n    const popup = {\r\n      isOpen: true,\r\n      title: title,\r\n      content: content,\r\n    };\r\n    setPopup(popup);\r\n  }\r\n  function openModal(content) {\r\n    setIsOpenModal(true);\r\n    setModalContent(content);\r\n  }\r\n  function closeModal() {\r\n    setIsOpenModal(false);\r\n    setModalContent(\"\");\r\n  }\r\n\r\n  return isOpen ? (\r\n    <div className=\"animate-fadeIn fixed inset-0 grid place-items-center h-screen w-screen px-4 py-10 z-30 bg-gray-500 bg-opacity-30 dark:bg-dark-primary dark:bg-opacity-50\">\r\n      <div\r\n        ref={ref}\r\n        className={\r\n          \"px-6 md:px-14 md:py-6 flex flex-col bg-white dark:bg-dark-secondary dark:border-dark-third rounded-xl shadow-xl border border-gray-300 w-full md:w-5/6 lg:w-2/5 transition-all duration-300 max-h-full overflow-y-auto\" +\r\n          \" \" +\r\n          (isOpenFriendList ? \"mb-16\" : \"\")\r\n        }\r\n      >\r\n        <Popup\r\n          title={popup.title}\r\n          isOpen={popup.isOpen}\r\n          content={popup.content}\r\n          onClick={() => setPopup({ isOpen: false })}\r\n        />\r\n        <ConfirmModal\r\n          isOpen={isOpenModal}\r\n          closeAction={() => setIsOpenModal(false)}\r\n          title=\"Are you sure?\"\r\n          content={modalContent}\r\n          confirmButtonTitle=\"Yes\"\r\n          confirmButtonAction={submitEditChat}\r\n        />\r\n        <div className=\"flex pt-6 pb-5 h-full\">\r\n          <h3 className=\"font-semibold text-lg md:text-2xl text-green-600 dark:text-green-400\">\r\n            Chat info!\r\n          </h3>\r\n        </div>\r\n        <div className=\"space-y-2 md:space-y-4\">\r\n          {chat?.type === ChatType.GROUP ? (\r\n            <>\r\n              <div className=\"space-y-2\">\r\n                <label\r\n                  htmlFor=\"groupName\"\r\n                  className=\"font-semibold dark:text-dark-txt text-base md:text-lg\"\r\n                >\r\n                  Group name <span className=\"text-red-500\">*</span>\r\n                </label>\r\n                <input\r\n                  id=\"groupName\"\r\n                  value={groupName}\r\n                  onChange={(e) => setGroupName(e.target.value)}\r\n                  type=\"text\"\r\n                  className=\"dark:bg-dark-third bg-gray-100 rounded-lg w-full py-2 px-3 focus:ring-2 focus:ring-green-500 focus:ring-opacity-50 outline-none transition-all duration-200 mb-2 \"\r\n                />\r\n              </div>\r\n              <div ref={friendListRef} className=\"space-y-2\">\r\n                <label\r\n                  htmlFor=\"search\"\r\n                  className=\"font-semibold dark:text-dark-txt text-base md:text-lg\"\r\n                >\r\n                  Add Members\r\n                </label>\r\n                <div className=\"relative\">\r\n                  <input\r\n                    id=\"search\"\r\n                    type=\"search\"\r\n                    onFocus={() => setIsOpenFriendList(true)}\r\n                    value={keyword}\r\n                    autoComplete=\"off\"\r\n                    onChange={(e) => setKeyword(e.target.value)}\r\n                    className=\"dark:bg-dark-third bg-gray-100 rounded-lg w-full py-2 px-3 focus:ring-2 focus:ring-green-500 focus:ring-opacity-50 outline-none transition-all duration-200 mb-2 \"\r\n                  />\r\n                  {isOpenFriendList && (\r\n                    <>\r\n                      <div className=\"animate-fadeIn absolute top-full bg-white dark:bg-dark-third border border-gray-400 border-opacity-50 rounded-lg w-full md:py-4 py-2 md:px-8 px-6 space-y-1 max-h-48 md:max-h-72 overflow-y-auto select-none z-10 shadow-2xl \">\r\n                        <h4 className=\"font-semibold dark:text-gray-200 mb-2\">\r\n                          Friend list\r\n                        </h4>\r\n                        {friendList\r\n                          .filter(\r\n                            (x) =>\r\n                              (x.fullName\r\n                                ?.toLowerCase()\r\n                                .includes(keyword?.toLowerCase()) ||\r\n                                x.userName\r\n                                  ?.toLowerCase()\r\n                                  .includes(keyword?.toLowerCase())) &&\r\n                              !selectedFriendList.some(\r\n                                (selected) => selected.userName === x.userName,\r\n                              ),\r\n                          )\r\n                          .sort((a, b) => a.fullName.localeCompare(b.fullName))\r\n                          .map((friend, index) => (\r\n                            <div\r\n                              onClick={() => {\r\n                                var result = [...selectedFriendList];\r\n                                if (\r\n                                  !result.some(\r\n                                    (x) => x.userName === friend.userName,\r\n                                  )\r\n                                ) {\r\n                                  result.push(friend);\r\n                                  setSelectedFriendList(result);\r\n                                }\r\n                              }}\r\n                              key={friend?.id ?? \"friend\" + index}\r\n                              className=\"h-full w-full rounded-lg px-3 py-2 flex items-center space-x-2  dark:bg-dark-hover bg-gray-100 hover:bg-green-200 dark:hover:bg-green-600 cursor-pointer transform active:scale-100 hover:scale-105 hover:shadow-xl transition-all duration-300\"\r\n                            >\r\n                              <ImageCircle\r\n                                size=\"xs\"\r\n                                src={friend.avatarUrl}\r\n                                userName={friend?.userName}\r\n                              />\r\n                              <span className=\"break-full w-full overflow-ellipsis truncate md:text-base text-sm\">\r\n                                {friend.fullName ?? DefaultName.NO_NAME_USER}\r\n                              </span>\r\n                            </div>\r\n                          ))}\r\n                      </div>\r\n                    </>\r\n                  )}\r\n                </div>\r\n              </div>\r\n              <div className=\"space-y-2\">\r\n                <label\r\n                  htmlFor=\"search\"\r\n                  className=\"font-semibold text-base md:text-lg dark:text-dark-txt\"\r\n                >\r\n                  Members <span className=\"text-red-500\">*</span>{\" \"}\r\n                  <span className=\"text-sm text-gray-400\">\r\n                    {\"(Click to remove)\"}\r\n                  </span>\r\n                </label>\r\n                <div className=\"bg-white border dark:bg-dark-third dark:border-dark-third border-gray-400 border-opacity-50 rounded-lg w-full py-4 md:px-8 px-6 space-y-1 max-h-48 md:max-h-72 overflow-y-auto select-none\">\r\n                  {[...selectedFriendList]\r\n                    .sort((a, b) => a.fullName.localeCompare(b.fullName))\r\n                    .map((friend, index) => (\r\n                      <div\r\n                        onClick={() => {\r\n                          var result = [...selectedFriendList];\r\n                          var i = result.findIndex(\r\n                            (x) => x.userName === friend.userName,\r\n                          );\r\n                          if (i >= 0) {\r\n                            result.splice(i, 1);\r\n                            setSelectedFriendList(result);\r\n                          }\r\n                        }}\r\n                        key={friend?.id ?? \"friend\" + index}\r\n                        className=\"h-full w-full rounded-lg px-3 py-2 flex items-center space-x-2 dark:hover:bg-red-500 dark:bg-dark-hover bg-gray-100 hover:bg-red-200 cursor-pointer transform active:scale-100 hover:scale-105 hover:shadow-xl transition-all duration-300\"\r\n                      >\r\n                        <ImageCircle\r\n                          size=\"xs\"\r\n                          src={friend.avatarUrl}\r\n                          userName={friend?.userName}\r\n                        />\r\n                        <span className=\"break-full w-full overflow-ellipsis truncate md:text-base text-sm\">\r\n                          {friend.fullName ?? DefaultName.NO_NAME_USER}\r\n                        </span>\r\n                      </div>\r\n                    ))}\r\n                </div>\r\n              </div>\r\n              <div className=\"space-y-2 mr-2 flex flex-col\">\r\n                <label\r\n                  htmlFor=\"avatar\"\r\n                  className=\"dark:text-dark-txt text-base md:text-lg font-semibold \"\r\n                >\r\n                  Group Avatar\r\n                </label>\r\n                <input\r\n                  id=\"avatar\"\r\n                  onChange={(e) => setAvatar(e.target.files[0])}\r\n                  type=\"file\"\r\n                  className=\"w-full\"\r\n                  accept=\"image/png, image/jpg, image/tiff, image/tif, image/jpeg\"\r\n                />\r\n              </div>\r\n            </>\r\n          ) : (\r\n            <div ref={friendListRef} className=\"space-y-2\">\r\n              <div className=\"font-bold dark:text-dark-txt\">\r\n                Creator:{\" \"}\r\n                <span className=\"font-normal\">{chat?.creatorFullName}</span>\r\n              </div>\r\n              <div className=\"font-bold dark:text-dark-txt\">\r\n                Created at:{\" \"}\r\n                <span className=\"font-normal\">\r\n                  {formatDate(chat?.dateCreated)}\r\n                </span>\r\n              </div>\r\n              <div className=\"font-bold dark:text-dark-txt\">\r\n                Total messages:{\" \"}\r\n                <span className=\"font-normal\">{chat?.totalRecords}</span>\r\n              </div>\r\n            </div>\r\n          )}\r\n        </div>\r\n        <div className=\"flex justify-end py-6 space-x-4\">\r\n          <div className=\"space-x-2 flex items-center\">\r\n            <Button outline content=\"Close\" onClick={() => setIsOpen(false)} />\r\n            {chat?.type === ChatType.GROUP ? (\r\n              <Button\r\n                disabled={!isValidButton}\r\n                content=\"Save\"\r\n                onClick={() => handleEditChat()}\r\n              />\r\n            ) : (\r\n              \"\"\r\n            )}\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  ) : (\r\n    \"\"\r\n  );\r\n}\r\n\r\nexport default EditChat;\r\n","import { appendMessageToChat, readChat, setSelectedId } from \"app/chatSlice\";\r\nimport InfoIcon from \"assets/icons/info-icon.svg\";\r\nimport LeftArrowIcon from \"assets/icons/left-arrow-icon.svg\";\r\nimport ChatInput from \"components/ChatInput\";\r\nimport ClickableIcon from \"components/ClickableIcon\";\r\nimport EditChat from \"components/EditChat\";\r\nimport ImageCircle from \"components/ImageCircle\";\r\nimport useChatApi from \"hooks/useChatApi\";\r\nimport useMessagePagination from \"hooks/useMessagePagination\";\r\nimport React, { useEffect, useRef, useState } from \"react\";\r\nimport { useDispatch, useSelector } from \"react-redux\";\r\nimport { ChatType, DefaultName } from \"utils/Constants\";\r\nimport { formatDate } from \"utils/UtilityMethods\";\r\n\r\nfunction ChatWindow({ chat }) {\r\n  const dispatch = useDispatch();\r\n  const currentUser = useSelector((state) => state.users.currentUser);\r\n  const chatApi = useChatApi();\r\n\r\n  const [showTimeIndexes, setShowTimeIndexes] = useState([]);\r\n  const [isOpenInfoPopup, setIsOpenInfoPopup] = useState(false);\r\n  const [friend, setFriend] = useState({});\r\n  const [seenBy, setSeenBy] = useState(\"\");\r\n\r\n  function backToChats() {\r\n    const action = setSelectedId(0);\r\n    dispatch(action);\r\n  }\r\n\r\n  function handleMessageClick(index) {\r\n    var result = [...showTimeIndexes];\r\n    const i = result.findIndex((x) => x === index);\r\n    if (i >= 0) {\r\n      result = result.filter((x) => x !== index);\r\n    } else {\r\n      result.push(index);\r\n    }\r\n    setShowTimeIndexes(result);\r\n  }\r\n\r\n  // infinity scrolling\r\n  const [page, setPage] = useState(1);\r\n  const { appendChat, hasMore, loading, error } = useMessagePagination(\r\n    chat,\r\n    page,\r\n  );\r\n  const endMessageRef = useRef();\r\n\r\n  useEffect(() => {\r\n    if (chat?.numOfUnreadMessages > 0) {\r\n      chatApi.readChat(chat?.id).then((res) => {\r\n        dispatch(readChat(chat?.id));\r\n      });\r\n    }\r\n    if (chat?.participants.length > 0) {\r\n      let newFriend = chat?.participants\r\n        ?.filter((x) => x.userName !== currentUser?.userName)\r\n        .shift();\r\n      setFriend(newFriend ?? currentUser);\r\n\r\n      if (chat?.readByUserNames?.length > 1) {\r\n        let newSeenBy = \"\";\r\n        let firstNameList = chat?.readByUserNames\r\n          ?.filter((userName) => userName !== currentUser?.userName)\r\n          ?.map((userName) => {\r\n            let firstName = chat.participants\r\n              .filter((x) => x.userName === userName)\r\n              ?.shift()?.firstName;\r\n            return firstName;\r\n          });\r\n\r\n        if (firstNameList?.length > 1) {\r\n          newSeenBy = \"Seen by \" + firstNameList.filter((x) => x).join(\", \");\r\n          setSeenBy(newSeenBy);\r\n        } else {\r\n          setSeenBy(\"\");\r\n        }\r\n      }\r\n    }\r\n  }, [chat]);\r\n\r\n  useEffect(() => {\r\n    dispatch(appendMessageToChat(appendChat));\r\n  }, [appendChat]);\r\n\r\n  const scrollToBottom = () => {\r\n    if (endMessageRef) {\r\n      endMessageRef?.current?.scrollIntoView();\r\n    }\r\n  };\r\n\r\n  useEffect(() => {\r\n    if (chat?.page < 2) {\r\n      scrollToBottom();\r\n    }\r\n  }, [chat]);\r\n\r\n  function loadMore() {\r\n    if (page < chat?.pageCount) {\r\n      setPage((prevPage) => prevPage + 1);\r\n    }\r\n  }\r\n  return (\r\n    <>\r\n      <EditChat\r\n        isOpen={isOpenInfoPopup}\r\n        setIsOpen={setIsOpenInfoPopup}\r\n        chat={chat}\r\n      />\r\n      <div className=\"flex flex-col w-full h-full pb-4 flex-shrink-0 min-w-0\">\r\n        {/* Header chat window */}\r\n        <div className=\"w-full border-b border-gray-300 dark:border-dark-third flex justify-between items-center md:p-3 md:px-4 p-2 px-3 flex-shrink-0 overflow-hidden\">\r\n          <div className=\"flex min-w-0 justify-start items-center space-x-3\">\r\n            <img\r\n              src={LeftArrowIcon}\r\n              alt=\"Arrow icon\"\r\n              className=\"h-5 w-5 md:hidden cursor-pointer\"\r\n              onClick={backToChats}\r\n            />\r\n            <ImageCircle\r\n              src={\r\n                chat?.groupAvatarUrl !== \"\"\r\n                  ? chat?.groupAvatarUrl\r\n                  : friend?.avatarUrl\r\n              }\r\n              participants={chat?.participants}\r\n            />\r\n            <span className=\"text-lg font-semibold dark:text-dark-txt truncate overflow-hidden\">\r\n              {chat?.type === ChatType.PRIVATE\r\n                ? friend?.fullName\r\n                : chat?.name ?? DefaultName.NO_NAME_GROUP}\r\n            </span>\r\n          </div>\r\n          <ClickableIcon\r\n            className=\"h-10 w-10 p-2 mr-2\"\r\n            icon={InfoIcon}\r\n            onClick={() => setIsOpenInfoPopup(!isOpenInfoPopup)}\r\n          />\r\n        </div>\r\n        {/* End header chat window */}\r\n\r\n        {/* Chat content */}\r\n        {chat?.messages && (\r\n          <div className=\"flex-grow overflow-y-auto overflow-x-hidden px-4 pb-4 pt-2 space-y-1 flex flex-col min-w-0\">\r\n            {loading && (\r\n              <div className=\"text-gray-500 text-center my-2\">Loading...</div>\r\n            )}\r\n            {hasMore && !loading && (\r\n              <div className=\"flex\">\r\n                <button\r\n                  className=\"mx-auto px-4 bg-gray-200 py-2 rounded-lg transform active:scale-95 hover:bg-gray-300 dark:hover:bg-dark-hover dark:bg-dark-third dark:text-gray-300 text-xs md:text-sm transition-all duration-200\"\r\n                  onClick={loadMore}\r\n                >\r\n                  Load more messages...\r\n                </button>\r\n              </div>\r\n            )}\r\n            {!hasMore && (\r\n              <div className=\"text-gray-500 text-xs md:text-sm text-center mb-2\">\r\n                {formatDate(chat?.dateCreated)}\r\n              </div>\r\n            )}\r\n            <div>{error ? \"Error\" : \"\"}</div>\r\n            {[...chat?.messages]\r\n              ?.sort((messageA, messageB) => {\r\n                return messageA?.dateCreated > messageB?.dateCreated ? 1 : -1;\r\n              })\r\n              .map((message, index) =>\r\n                message.senderUserName === currentUser.userName ? (\r\n                  <div\r\n                    className=\"flex-shrink-0\"\r\n                    key={message.id ?? \"message\" + index}\r\n                  >\r\n                    <div className=\"flex-shrink-0 flex flex-col items-end w-full\">\r\n                      {showTimeIndexes.includes(index) && (\r\n                        <span className=\"transition-all animate-fadeIn text-xs md:text-sm text-gray-400 left-0 bottom-full mb-1 ml-1 space-x-2 md:w-80 w-60 truncate overflow-ellipsis text-right\">\r\n                          {formatDate(message.dateCreated) ?? \"\"}\r\n                        </span>\r\n                      )}\r\n                      {message.imageUrl ? (\r\n                        <img\r\n                          onClick={() => handleMessageClick(index)}\r\n                          className=\"md:max-w-300 max-w-200 rounded-lg shadow transition-all duration-200 cursor-pointer\"\r\n                          src={message.imageUrl}\r\n                          alt=\"Message\"\r\n                        />\r\n                      ) : (\r\n                        <span\r\n                          onClick={() => handleMessageClick(index)}\r\n                          className={\r\n                            \"text-white rounded-3xl md:px-5 md:py-3 px-3 py-2 break-word rounded-br-none cursor-pointer overflow-x-auto max-w-3/4 text-sm md:text-base\" +\r\n                            \" \" +\r\n                            (showTimeIndexes.includes(index)\r\n                              ? \"bg-green-600 dark:bg-green-800\"\r\n                              : \"bg-gradient-to-br from-green-400 to-green-600 dark:from-green-500 dark:to-green-800 shadow-md\")\r\n                          }\r\n                        >\r\n                          {message.content}\r\n                        </span>\r\n                      )}\r\n                    </div>\r\n                    {chat?.type === ChatType.PRIVATE &&\r\n                      chat?.messages?.length === index + 1 && (\r\n                        <>\r\n                          <div className=\"text-xs font-semibold text-right text-gray-600 dark:text-dark-txt mr-2 select-none\">\r\n                            {chat?.readByUserNames?.includes(friend?.userName)\r\n                              ? \"Seen\"\r\n                              : \"\"}\r\n                          </div>\r\n                        </>\r\n                      )}\r\n                  </div>\r\n                ) : (\r\n                  <div\r\n                    key={message.id ?? \"message\" + index}\r\n                    className=\"flex-shrink-0 flex items-end space-x-2\"\r\n                  >\r\n                    <ImageCircle\r\n                      src={\r\n                        chat?.participants\r\n                          .filter((x) => x.userName === message.senderUserName)\r\n                          .shift()?.avatarUrl\r\n                      }\r\n                      size=\"sm\"\r\n                      userName={message.senderUserName}\r\n                    />\r\n                    <div className=\"flex flex-col w-full items-start\">\r\n                      {showTimeIndexes.includes(index) && (\r\n                        <span className=\"transition-all animate-fadeIn text-xs md:text-sm text-gray-400 bottom-full mb-1 ml-1 space-x-2 md:w-80 w-60 truncate overflow-ellipsis text-left\">\r\n                          {(chat?.type === ChatType.GROUP\r\n                            ? message.senderFullName + \" - \"\r\n                            : \"\") + formatDate(message.dateCreated) ?? \"\"}\r\n                        </span>\r\n                      )}\r\n                      {message.imageUrl ? (\r\n                        <img\r\n                          onClick={() => handleMessageClick(index)}\r\n                          className=\"md:max-w-300 max-w-200 rounded-lg shadow cursor-pointer\"\r\n                          src={message.imageUrl}\r\n                          alt=\"Message\"\r\n                        />\r\n                      ) : (\r\n                        <span\r\n                          className={\r\n                            \" rounded-3xl md:px-5 md:py-3 px-3 py-2 break-word rounded-bl-none shadow-sm cursor-pointer overflow-x-auto max-w-3/4 text-sm md:text-base\" +\r\n                            \" \" +\r\n                            (showTimeIndexes.includes(index)\r\n                              ? \"bg-gray-300 dark:bg-dark-third\"\r\n                              : \"bg-gradient-to-br from-gray-100 to-gray-300 dark:from-gray-500 dark:to-gray-600 \")\r\n                          }\r\n                          onClick={() => handleMessageClick(index)}\r\n                        >\r\n                          {message.content}\r\n                        </span>\r\n                      )}\r\n                    </div>\r\n                  </div>\r\n                ),\r\n              )}\r\n            {chat?.type === ChatType.GROUP && (\r\n              <>\r\n                <div className=\"text-xs font-semibold text-right text-gray-600 dark:text-dark-txt mr-2 select-none\">\r\n                  {seenBy}\r\n                </div>\r\n              </>\r\n            )}\r\n            <div ref={endMessageRef}></div>\r\n          </div>\r\n        )}\r\n        {/* End chat content */}\r\n\r\n        <ChatInput chatId={chat?.id} />\r\n      </div>\r\n    </>\r\n  );\r\n}\r\n\r\nexport default ChatWindow;\r\n","import { useEffect, useState } from \"react\";\r\nimport useChatApi from \"./useChatApi\";\r\n\r\nexport default function useMessagePagination(currentChat, page) {\r\n  const [loading, setLoading] = useState(false);\r\n  const [error, setError] = useState(\"\");\r\n  const [appendChat, setAppendChat] = useState({});\r\n  const [hasMore, setHasMore] = useState(false);\r\n\r\n  const chatApi = useChatApi();\r\n\r\n  useEffect(() => {\r\n    if (page > 1 && hasMore) {\r\n      setLoading(true);\r\n      setError(false);\r\n\r\n      const request = { page };\r\n      chatApi\r\n        .getById(currentChat.id, request)\r\n        .then((response) => {\r\n          setAppendChat(response);\r\n          setHasMore(page < response.pageCount);\r\n          setLoading(false);\r\n        })\r\n        .catch((e) => {\r\n          setError(e);\r\n        });\r\n    }\r\n  }, [page]);\r\n\r\n  useEffect(() => {\r\n    setHasMore(page < currentChat?.pageCount);\r\n  }, [currentChat]);\r\n\r\n  return { loading, error, appendChat, hasMore };\r\n}\r\n","import { setSelectedId } from \"app/chatSlice\";\r\nimport Button from \"components/Button\";\r\nimport ImageCircle from \"components/ImageCircle\";\r\nimport useChatApi from \"hooks/useChatApi\";\r\nimport useUserApi from \"hooks/useUserApi\";\r\nimport React, { useEffect, useRef, useState } from \"react\";\r\nimport { useDispatch } from \"react-redux\";\r\nimport { ChatType, DefaultName } from \"utils/Constants\";\r\n\r\nfunction CreateChat({ isOpen, setIsOpen }) {\r\n  const [selectedMode, setSelectedMode] = useState(ChatType.PRIVATE);\r\n  const [isOpenFriendList, setIsOpenFriendList] = useState(false);\r\n  const [isValidButton, setIsValidButton] = useState(false);\r\n  const [groupName, setGroupName] = useState(\"\");\r\n  const [keyword, setKeyword] = useState(\"\");\r\n  const [friendList, setFriendList] = useState([]);\r\n  const [selectedFriendList, setSelectedFriendList] = useState([]);\r\n\r\n  const ref = useRef();\r\n  const friendListRef = useRef();\r\n  const dispatch = useDispatch();\r\n\r\n  const chatApi = useChatApi();\r\n  const userApi = useUserApi();\r\n\r\n  useEffect(() => {\r\n    const checkIfClickedOutside = (e) => {\r\n      // If the menu is open and the clicked target is not within the menu,\r\n      // then close the menu\r\n      if (isOpen && ref.current && !ref.current.contains(e.target)) {\r\n        setIsOpen(false);\r\n      }\r\n    };\r\n    document.addEventListener(\"mousedown\", checkIfClickedOutside);\r\n    return () => {\r\n      // Cleanup the event listener\r\n      document.removeEventListener(\"mousedown\", checkIfClickedOutside);\r\n    };\r\n  }, [isOpen]);\r\n  useEffect(() => {\r\n    const checkIfClickedOutside = (e) => {\r\n      // If the menu is open and the clicked target is not within the menu,\r\n      // then close the menu\r\n      if (\r\n        isOpenFriendList &&\r\n        friendListRef.current &&\r\n        !friendListRef.current.contains(e.target)\r\n      ) {\r\n        setIsOpenFriendList(false);\r\n      }\r\n    };\r\n    document.addEventListener(\"mousedown\", checkIfClickedOutside);\r\n    return () => {\r\n      // Cleanup the event listener\r\n      document.removeEventListener(\"mousedown\", checkIfClickedOutside);\r\n    };\r\n  }, [isOpenFriendList]);\r\n\r\n  useEffect(() => {\r\n    userApi.getUserList().then((response) => {\r\n      if (response) {\r\n        setFriendList(response.items ?? response);\r\n      }\r\n    });\r\n    return () => {\r\n      setSelectedFriendList([]);\r\n      setGroupName(\"\");\r\n    };\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    if (selectedMode === ChatType.GROUP) {\r\n      var result = selectedFriendList?.length >= 2 && groupName?.trim();\r\n      setIsValidButton(result);\r\n    } else if (selectedMode === ChatType.PRIVATE) {\r\n      setIsValidButton(selectedFriendList?.length !== 0 ? true : false);\r\n    }\r\n  }, [selectedFriendList, groupName, selectedMode]);\r\n\r\n  async function handleCreateGroup() {\r\n    if (isValidButton) {\r\n      if (selectedMode === ChatType.GROUP) {\r\n        const request = {\r\n          participantUserNames: selectedFriendList.map((x) => x.userName),\r\n          name: groupName,\r\n        };\r\n        chatApi.createGroupChat(request).then((response) => {\r\n          if (response.id) {\r\n            dispatch(setSelectedId(response.id));\r\n          }\r\n          setSelectedFriendList([]);\r\n          setGroupName(\"\");\r\n          setIsOpen(false);\r\n        });\r\n      } else if (selectedMode === ChatType.PRIVATE) {\r\n        const request = {\r\n          participantUserName: selectedFriendList\r\n            .map((x) => x.userName)\r\n            .shift(),\r\n        };\r\n        chatApi.createPrivateChat(request).then((response) => {\r\n          if (response.id) {\r\n            dispatch(setSelectedId(response.id));\r\n          }\r\n          setSelectedFriendList([]);\r\n          setGroupName(\"\");\r\n          setIsOpen(false);\r\n        });\r\n      }\r\n    }\r\n  }\r\n\r\n  return isOpen ? (\r\n    <div className=\"animate-fadeIn fixed inset-0 grid place-items-center h-screen w-screen px-4 py-10  z-30 bg-gray-500 bg-opacity-30 dark:bg-dark-primary dark:bg-opacity-50\">\r\n      <div\r\n        ref={ref}\r\n        className={\r\n          \"px-6 md:px-14 md:py-6 flex flex-col bg-white dark:bg-dark-secondary dark:border-dark-third rounded-xl shadow-xl border border-gray-300 w-full md:w-5/6 lg:w-2/5 transition-all duration-300 max-h-full overflow-y-auto md:overflow-visible\" +\r\n          \" \" +\r\n          (isOpenFriendList ? \"mb-16\" : \"\")\r\n        }\r\n      >\r\n        <div className=\"flex pt-6 pb-5 justify-between h-full items-center\">\r\n          <h3 className=\"font-semibold text-lg md:text-2xl text-green-600 dark:text-green-400\">\r\n            New chat!\r\n          </h3>\r\n\r\n          <div className=\"relative flex rounded-lg items-center border border-green-500 cursor-pointer overflow-hidden\">\r\n            <div\r\n              className={\r\n                \"absolute bg-gradient-to-br from-green-400 to-green-600 w-1/2 h-full rounded transition-all duration-200 z-0\" +\r\n                \" \" +\r\n                (selectedMode === ChatType.GROUP\r\n                  ? \"transform translate-x-full left-0\"\r\n                  : \"left-0 \")\r\n              }\r\n            ></div>\r\n            <span\r\n              className={\r\n                \" px-3 py-2 z-10 text-xs md:text-sm select-none \" +\r\n                \" \" +\r\n                (selectedMode === ChatType.PRIVATE\r\n                  ? \"text-white\"\r\n                  : \" text-green-600 dark:text-green-400\")\r\n              }\r\n              onClick={() => setSelectedMode(ChatType.PRIVATE)}\r\n            >\r\n              Private\r\n            </span>\r\n            <span\r\n              className={\r\n                \" px-3 py-2 z-10 text-xs md:text-sm select-none \" +\r\n                \" \" +\r\n                (selectedMode === ChatType.GROUP\r\n                  ? \"text-white\"\r\n                  : \" text-green-600 dark:text-green-400\")\r\n              }\r\n              onClick={() => setSelectedMode(ChatType.GROUP)}\r\n            >\r\n              Group\r\n            </span>\r\n          </div>\r\n        </div>\r\n        <div className=\"space-y-2 md:space-y-4\">\r\n          {selectedMode === ChatType.GROUP ? (\r\n            <>\r\n              <div className=\"space-y-2\">\r\n                <label\r\n                  htmlFor=\"groupName\"\r\n                  className=\"font-semibold text-base md:text-lg dark:text-gray-200\"\r\n                >\r\n                  Group name <span className=\"text-red-500\">*</span>\r\n                </label>\r\n                <input\r\n                  id=\"groupName\"\r\n                  value={groupName}\r\n                  onChange={(e) => setGroupName(e.target.value)}\r\n                  type=\"text\"\r\n                  className=\"dark:bg-dark-third bg-gray-100 rounded-lg w-full py-2 px-3 focus:ring-2 focus:ring-green-500 focus:ring-opacity-50 outline-none transition-all duration-200 mb-2 \"\r\n                />\r\n              </div>\r\n              <div ref={friendListRef} className=\"space-y-2\">\r\n                <label\r\n                  htmlFor=\"search\"\r\n                  className=\"font-semibold text-base md:text-lg dark:text-gray-200\"\r\n                >\r\n                  Find Friends\r\n                </label>\r\n                <div className=\"relative\">\r\n                  <input\r\n                    id=\"search\"\r\n                    type=\"search\"\r\n                    onFocus={() => setIsOpenFriendList(true)}\r\n                    value={keyword}\r\n                    autoComplete=\"off\"\r\n                    onChange={(e) => setKeyword(e.target.value)}\r\n                    className=\"dark:bg-dark-third bg-gray-100 rounded-lg w-full py-2 px-3 focus:ring-2 focus:ring-green-500 focus:ring-opacity-50 outline-none transition-all duration-200 mb-2 \"\r\n                  />\r\n                  {isOpenFriendList && (\r\n                    <>\r\n                      <div className=\"animate-fadeIn absolute top-full bg-white dark:bg-dark-secondary dark:border-dark-hover border border-gray-300 border-opacity-50 rounded-lg w-full py-2 md:py-4 md:px-8 px-6 space-y-1 max-h-36 md:max-h-72 overflow-y-auto select-none z-10 shadow-2xl\">\r\n                        <h4 className=\"font-semibold mb-2 dark:text-gray-200\">\r\n                          Friend list\r\n                        </h4>\r\n                        {friendList\r\n                          ?.filter(\r\n                            (x) =>\r\n                              (x.fullName\r\n                                ?.toLowerCase()\r\n                                .includes(keyword?.toLowerCase()) ||\r\n                                x.userName\r\n                                  ?.toLowerCase()\r\n                                  .includes(keyword?.toLowerCase())) &&\r\n                              !selectedFriendList.some(\r\n                                (selected) => selected.userName === x.userName,\r\n                              ),\r\n                          )\r\n                          ?.sort((a, b) => a.fullName.localeCompare(b.fullName))\r\n                          ?.map((friend, index) => (\r\n                            <div\r\n                              onClick={() => {\r\n                                var result = [...selectedFriendList];\r\n                                if (\r\n                                  !result.some(\r\n                                    (x) => x.userName === friend.userName,\r\n                                  )\r\n                                ) {\r\n                                  result.push(friend);\r\n                                  setSelectedFriendList(result);\r\n                                }\r\n                              }}\r\n                              key={friend?.id ?? \"friend\" + index}\r\n                              className=\"h-full w-full rounded-lg px-3 py-2 flex items-center space-x-2  dark:bg-dark-third bg-gray-100 hover:bg-green-200 dark:hover:bg-green-600 cursor-pointer transform active:scale-100 hover:scale-105 hover:shadow-xl transition-all duration-300\"\r\n                            >\r\n                              <ImageCircle\r\n                                size=\"xs\"\r\n                                src={friend.avatarUrl}\r\n                                userName={friend?.userName}\r\n                              />\r\n                              <span className=\"break-full w-full overflow-ellipsis truncate md:text-base text-sm\">\r\n                                {friend.fullName ?? DefaultName.NO_NAME_USER}\r\n                              </span>\r\n                            </div>\r\n                          ))}\r\n                      </div>\r\n                    </>\r\n                  )}\r\n                </div>\r\n              </div>\r\n              <div className=\"space-y-2\">\r\n                <label\r\n                  htmlFor=\"search\"\r\n                  className=\"font-semibold text-base md:text-lg dark:text-gray-200\"\r\n                >\r\n                  Selected <span className=\"text-red-500\">*</span>{\" \"}\r\n                  <span className=\"text-sm text-gray-400\">\r\n                    {\"(At least 2 people. Click to remove)\"}\r\n                  </span>\r\n                </label>\r\n                <div className=\"bg-white dark:bg-dark-secondary border dark:border-dark-hover border-gray-400 border-opacity-50 rounded-lg w-full py-4 md:px-8 px-6 space-y-1 max-h-48 md:max-h-72 overflow-y-auto select-none\">\r\n                  {selectedFriendList\r\n                    .sort((a, b) => a.fullName.localeCompare(b.fullName))\r\n                    .map((friend, index) => (\r\n                      <div\r\n                        onClick={() => {\r\n                          var result = [...selectedFriendList];\r\n                          var i = result.findIndex(\r\n                            (x) => x.userName === friend.userName,\r\n                          );\r\n                          if (i >= 0) {\r\n                            result.splice(i, 1);\r\n                            setSelectedFriendList(result);\r\n                          }\r\n                        }}\r\n                        key={friend?.id ?? \"friend\" + index}\r\n                        className=\"h-full w-full rounded-lg px-3 py-2 flex items-center space-x-2  dark:bg-dark-third bg-gray-100 hover:bg-red-200 dark:hover:bg-red-500 cursor-pointer transform active:scale-100 hover:scale-105 hover:shadow-xl transition-all duration-300\"\r\n                      >\r\n                        <ImageCircle\r\n                          size=\"xs\"\r\n                          src={friend.avatarUrl}\r\n                          userName={friend?.userName}\r\n                        />\r\n                        <span className=\"break-full w-full overflow-ellipsis truncate md:text-base text-sm\">\r\n                          {friend.fullName ?? DefaultName.NO_NAME_USER}\r\n                        </span>\r\n                      </div>\r\n                    ))}\r\n                </div>\r\n              </div>\r\n            </>\r\n          ) : (\r\n            <div ref={friendListRef} className=\"space-y-2\">\r\n              <label\r\n                htmlFor=\"selectFriend\"\r\n                className=\"font-semibold md:text-lg dark:text-gray-200\"\r\n              >\r\n                Select Friend\r\n              </label>\r\n              <div className=\"relative\">\r\n                <input\r\n                  id=\"selectFriend\"\r\n                  type=\"search\"\r\n                  onFocus={() => setIsOpenFriendList(true)}\r\n                  value={keyword}\r\n                  autoComplete=\"off\"\r\n                  onChange={(e) => setKeyword(e.target.value)}\r\n                  className=\"dark:bg-dark-third bg-gray-100 rounded-lg w-full py-2 px-3 focus:ring-2 focus:ring-green-500 focus:ring-opacity-50 outline-none transition-all duration-200 mb-2 \"\r\n                />\r\n                {isOpenFriendList && (\r\n                  <>\r\n                    <div className=\"animate-fadeIn absolute top-full bg-white dark:bg-dark-secondary border border-gray-400 border-opacity-50 rounded-lg w-full space-y-1 max-h-36 md:max-h-72 overflow-y-auto select-none z-10 shadow-2xl py-2 md:py-4 md:px-8 px-6\">\r\n                      <h4 className=\"font-semibold mb-2 text-start dark:text-gray-200\">\r\n                        Friend list\r\n                      </h4>\r\n                      {friendList\r\n                        ?.sort((a, b) => a.fullName.localeCompare(b.fullName))\r\n                        ?.filter(\r\n                          (x) =>\r\n                            (x.fullName\r\n                              ?.toLowerCase()\r\n                              .includes(keyword?.toLowerCase()) ||\r\n                              x.userName\r\n                                ?.toLowerCase()\r\n                                .includes(keyword?.toLowerCase())) &&\r\n                            !selectedFriendList.some(\r\n                              (selected) => selected.userName === x.userName,\r\n                            ),\r\n                        )\r\n                        ?.map((friend, index) => (\r\n                          <div\r\n                            onClick={() => {\r\n                              var result = [];\r\n                              result.push(friend);\r\n                              setIsOpenFriendList(false);\r\n                              setSelectedFriendList(result);\r\n                            }}\r\n                            key={friend?.id ?? \"friend\" + index}\r\n                            className=\"h-full w-full rounded-lg px-3 py-2 flex items-center space-x-2  dark:bg-dark-third bg-gray-100 hover:bg-green-200 dark:hover:bg-green-600 cursor-pointer transform active:scale-100 hover:scale-105 hover:shadow-xl transition-all duration-300\"\r\n                          >\r\n                            <ImageCircle\r\n                              size=\"xs\"\r\n                              src={friend.avatarUrl}\r\n                              userName={friend?.userName}\r\n                            />\r\n                            <span className=\"break-full w-full overflow-ellipsis truncate text-sm md:text-base\">\r\n                              {friend.fullName ?? DefaultName.NO_NAME_USER}\r\n                            </span>\r\n                          </div>\r\n                        ))}\r\n                    </div>\r\n                  </>\r\n                )}\r\n              </div>\r\n              <div className=\"space-y-2\">\r\n                <label\r\n                  htmlFor=\"search\"\r\n                  className=\"font-semibold md:text-lg dark:text-gray-200\"\r\n                >\r\n                  Selected <span className=\"text-red-500\">*</span>{\" \"}\r\n                  <span className=\"text-sm text-gray-400\">\r\n                    {\"(Click to remove)\"}\r\n                  </span>\r\n                </label>\r\n                <div className=\"bg-white dark:bg-dark-secondary border dark:border-dark-hover border-gray-400 border-opacity-50 rounded-lg w-full py-4 md:px-8 px-6 space-y-1 max-h-48 md:max-h-72 overflow-y-auto select-none \">\r\n                  {[...selectedFriendList].map((friend, index) => {\r\n                    if (index === 0) {\r\n                      return (\r\n                        <div\r\n                          onClick={() => {\r\n                            var result = [...selectedFriendList];\r\n                            var i = result.findIndex(\r\n                              (x) => x.userName === friend.userName,\r\n                            );\r\n                            if (i >= 0) {\r\n                              result.splice(i, 1);\r\n                              setSelectedFriendList(result);\r\n                            }\r\n                          }}\r\n                          key={friend?.id ?? \"friend\" + index}\r\n                          className=\"h-full w-full rounded-lg px-3 py-2 flex items-center space-x-2  dark:bg-dark-third bg-gray-100 hover:bg-red-200 cursor-pointer transform active:scale-100 hover:scale-105 hover:shadow-xl transition-all duration-300 dark:hover:bg-red-500\"\r\n                        >\r\n                          <ImageCircle\r\n                            size=\"xs\"\r\n                            src={friend.avatarUrl}\r\n                            userName={friend?.userName}\r\n                          />\r\n                          <span className=\"break-full w-full overflow-ellipsis truncate md:text-base text-sm\">\r\n                            {friend.fullName ?? DefaultName.NO_NAME_USER}\r\n                          </span>\r\n                        </div>\r\n                      );\r\n                    } else {\r\n                      return <></>;\r\n                    }\r\n                  })}\r\n                </div>\r\n              </div>\r\n            </div>\r\n          )}\r\n        </div>\r\n        <div className=\"flex justify-end py-6 space-x-4\">\r\n          <div className=\"space-x-2 flex items-center\">\r\n            <Button outline content=\"Close\" onClick={() => setIsOpen(false)} />\r\n            <Button\r\n              disabled={!isValidButton}\r\n              content=\"Create\"\r\n              onClick={() => handleCreateGroup()}\r\n            />\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  ) : (\r\n    \"\"\r\n  );\r\n}\r\n\r\nexport default CreateChat;\r\n","import { setPopup } from \"app/appSlice\";\r\nimport { updateUser } from \"app/userSlice\";\r\nimport Button from \"components/Button\";\r\nimport useUserApi from \"hooks/useUserApi\";\r\nimport React, { useEffect, useRef, useState } from \"react\";\r\nimport { useDispatch } from \"react-redux\";\r\n\r\nfunction UserInfo({ isOpen, setIsOpen, currentUser }) {\r\n  const [firstName, setFirstName] = useState(\"\");\r\n  const [lastName, setLastName] = useState(\"\");\r\n  const [avatar, setAvatar] = useState({});\r\n\r\n  const userApi = useUserApi();\r\n  const ref = useRef();\r\n  const dispatch = useDispatch();\r\n\r\n  useEffect(() => {\r\n    const checkIfClickedOutside = (e) => {\r\n      // If the menu is open and the clicked target is not within the menu,\r\n      // then close the menu\r\n      if (isOpen && ref.current && !ref.current.contains(e.target)) {\r\n        setIsOpen(false);\r\n      }\r\n    };\r\n    document.addEventListener(\"mousedown\", checkIfClickedOutside);\r\n    return () => {\r\n      // Cleanup the event listener\r\n      document.removeEventListener(\"mousedown\", checkIfClickedOutside);\r\n    };\r\n  }, [isOpen]);\r\n\r\n  useEffect(() => {\r\n    if (currentUser.firstName && currentUser.lastName) {\r\n      setFirstName(currentUser.firstName);\r\n      setLastName(currentUser.lastName);\r\n    }\r\n  }, [currentUser]);\r\n\r\n  async function submit() {\r\n    const request = new FormData();\r\n    request.append(\"File\", avatar);\r\n\r\n    userApi.updateAvatar(request).then((response) => {\r\n      userApi\r\n        .updateInformation({\r\n          firstName,\r\n          lastName,\r\n          aboutMe: currentUser.aboutMe,\r\n          phoneNumber: currentUser.phoneNumber,\r\n        })\r\n        .then((response) => {\r\n          dispatch(updateUser(response));\r\n          openPopup(\"Success\", \"Update info successfully!\");\r\n        });\r\n    });\r\n\r\n    setIsOpen(false);\r\n  }\r\n  function openPopup(title, content) {\r\n    const popup = {\r\n      isOpen: true,\r\n      title: title,\r\n      content: content,\r\n    };\r\n    dispatch(setPopup(popup));\r\n  }\r\n\r\n  return isOpen ? (\r\n    <div className=\"animate-fadeIn fixed inset-0 grid place-items-center h-screen w-screen px-4 py-10  z-30 bg-gray-500 bg-opacity-30 dark:bg-dark-primary dark:bg-opacity-50\">\r\n      <div\r\n        ref={ref}\r\n        className={\r\n          \"w-full md:w-5/6 lg:w-2/5 md:px-14 px-6 md:py-6 flex flex-col dark:bg-dark-secondary dark:border-dark-third bg-white rounded-xl shadow-xl border border-gray-300 transition-all duration-300\"\r\n        }\r\n      >\r\n        <h3 className=\"pt-6 pb-5 font-semibold text-lg md:text-2xl text-green-600 dark:text-green-400\">\r\n          User info!\r\n        </h3>\r\n        <div className=\"space-y-4\">\r\n          <div className=\"mb-3 flex flex-col md:grid md:grid-cols-2 md:place-items-start space-y-4 md:space-y-0\">\r\n            <div className=\"md:col-span-1 md:mr-2 space-y-2\">\r\n              <label\r\n                htmlFor=\"fistName\"\r\n                className=\"md:text-lg font-semibold dark:text-dark-txt\"\r\n              >\r\n                First Name <span className=\"text-red-500\">*</span>\r\n              </label>\r\n              <input\r\n                id=\"firstName\"\r\n                value={firstName}\r\n                onChange={(e) => setFirstName(e.target.value)}\r\n                type=\"text\"\r\n                className=\"bg-gray-100 dark:bg-dark-third rounded-lg w-full py-2 px-3 focus:ring-2 focus:ring-green-500 focus:ring-opacity-50 outline-none transition-all duration-200\"\r\n              />\r\n            </div>\r\n            <div className=\"md:col-span-1 md:ml-2 space-y-2\">\r\n              <label\r\n                htmlFor=\"lastName\"\r\n                className=\"md:text-lg font-semibold dark:text-dark-txt\"\r\n              >\r\n                Last Name <span className=\"text-red-500\">*</span>\r\n              </label>\r\n              <input\r\n                id=\"lastName\"\r\n                value={lastName}\r\n                onChange={(e) => setLastName(e.target.value)}\r\n                type=\"text\"\r\n                className=\"bg-gray-100 dark:bg-dark-third rounded-lg w-full py-2 px-3 focus:ring-2 focus:ring-green-500 focus:ring-opacity-50 outline-none transition-all duration-200 mb-2\"\r\n              />\r\n            </div>\r\n            <div className=\"space-y-2 flex flex-col\">\r\n              <label\r\n                htmlFor=\"avatar\"\r\n                className=\"md:text-lg font-semibold md:mt-4 dark:text-dark-txt\"\r\n              >\r\n                Avatar\r\n              </label>\r\n              <input\r\n                id=\"avatar\"\r\n                onChange={(e) => setAvatar(e.target.files[0])}\r\n                type=\"file\"\r\n                className=\"w-full\"\r\n                accept=\"image/png, image/jpg, image/tiff, image/tif, image/jpeg\"\r\n              />\r\n            </div>\r\n          </div>\r\n          <div className=\"flex justify-end space-x-2 items-center py-6\">\r\n            <Button outline content=\"Close\" onClick={() => setIsOpen(false)} />\r\n            <Button content=\"Save\" onClick={() => submit()} />\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  ) : (\r\n    \"\"\r\n  );\r\n}\r\nexport default UserInfo;\r\n","import { useEffect, useState } from \"react\";\r\n\r\nfunction useDarkMode() {\r\n  const [darkMode, setDarkMode] = useState(false);\r\n\r\n  useEffect(() => {\r\n    var mode = window.localStorage.getItem(\"theme\");\r\n\r\n    if (mode === \"dark\") {\r\n      window.document.documentElement.classList.add(\"dark\");\r\n      setDarkMode(true);\r\n    }\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    if (darkMode) {\r\n      window.document.documentElement.classList.add(\"dark\");\r\n      window.localStorage.setItem(\"theme\", \"dark\");\r\n    } else {\r\n      window.document.documentElement.classList.remove(\"dark\");\r\n      window.localStorage.setItem(\"theme\", \"light\");\r\n    }\r\n  }, [darkMode]);\r\n\r\n  return { darkMode, setDarkMode };\r\n}\r\n\r\nexport default useDarkMode;\r\n","import ConfirmModal from \"components/ConfirmModal\";\r\nimport CreateChat from \"components/CreateChat\";\r\nimport ImageCircle from \"components/ImageCircle\";\r\nimport UserInfo from \"components/UserInfo\";\r\nimport useDarkMode from \"hooks/useDarkMode\";\r\nimport PropTypes from \"prop-types\";\r\nimport React, { useEffect, useRef, useState } from \"react\";\r\nimport { useSelector } from \"react-redux\";\r\nimport ClickableIcon from \"../ClickableIcon\";\r\n\r\nHeader.propTypes = {\r\n  logout: PropTypes.func,\r\n};\r\n\r\nfunction Header({ logout }) {\r\n  const currentUser = useSelector((state) => state.users.currentUser);\r\n\r\n  const [isOpenCreateChat, setIsOpenCreateChat] = useState(false);\r\n  const [isOpenUserInfo, setIsOpenUserInfo] = useState(false);\r\n  const [confirmModal, setConfirmModal] = useState({\r\n    isOpen: false,\r\n    title: \"\",\r\n    content: \"\",\r\n    confirmButtonTitle: \"\",\r\n  });\r\n\r\n  const { darkMode, setDarkMode } = useDarkMode();\r\n\r\n  const userAvatar = currentUser.avatarUrl;\r\n  const [isOpenMenu, setIsOpenMenu] = useState(false);\r\n  const ref = useRef();\r\n\r\n  useEffect(() => {\r\n    const checkIfClickedOutside = (e) => {\r\n      // If the menu is open and the clicked target is not within the menu,\r\n      // then close the menu\r\n      if (isOpenMenu && ref.current && !ref.current.contains(e.target)) {\r\n        setIsOpenMenu(false);\r\n      }\r\n    };\r\n    document.addEventListener(\"mousedown\", checkIfClickedOutside);\r\n    return () => {\r\n      // Cleanup the event listener\r\n      document.removeEventListener(\"mousedown\", checkIfClickedOutside);\r\n    };\r\n  }, [isOpenMenu]);\r\n\r\n  function openConfirmModal(\r\n    content,\r\n    confirmButtonAction,\r\n    confirmButtonTitle = \"Yes\",\r\n    title,\r\n  ) {\r\n    const confirmModal = {\r\n      isOpen: true,\r\n      title: title,\r\n      content: content,\r\n      confirmButtonTitle: confirmButtonTitle,\r\n      confirmButtonAction: confirmButtonAction,\r\n    };\r\n    setConfirmModal(confirmModal);\r\n  }\r\n\r\n  return (\r\n    <>\r\n      {confirmModal.isOpen && (\r\n        <ConfirmModal\r\n          isOpen={confirmModal.isOpen}\r\n          closeAction={() => setConfirmModal({ isOpen: false })}\r\n          title=\"Are you sure?\"\r\n          content={confirmModal.content}\r\n          confirmButtonTitle={confirmModal.confirmButtonTitle}\r\n          confirmButtonAction={confirmModal.confirmButtonAction}\r\n        />\r\n      )}\r\n      <UserInfo\r\n        currentUser={currentUser}\r\n        isOpen={isOpenUserInfo}\r\n        setIsOpen={setIsOpenUserInfo}\r\n      />\r\n      <CreateChat isOpen={isOpenCreateChat} setIsOpen={setIsOpenCreateChat} />\r\n      <div className=\"pb-1 pt-4 flex justify-between items-center\">\r\n        <div className=\"flex items-center space-x-3\">\r\n          <div\r\n            className=\"transition-all duration-200 ring ring-green-500 p-1 transform active:scale-95 rounded-full cursor-pointer\"\r\n            onClick={() => setIsOpenUserInfo((x) => !x)}\r\n          >\r\n            <ImageCircle\r\n              src={userAvatar}\r\n              size=\"md\"\r\n              userName={currentUser.userName}\r\n            />\r\n          </div>\r\n          <h1 className=\"font-bold text-3xl\">Chats</h1>\r\n        </div>\r\n\r\n        <div className=\"flex space-x-2 items-center\">\r\n          <ClickableIcon\r\n            iconClass=\"bx bxs-edit\"\r\n            onClick={() => setIsOpenCreateChat(true)}\r\n            className=\"dark:bg-dark-third bg-gray-100\"\r\n          />\r\n          <div className=\"relative\" ref={ref}>\r\n            <ClickableIcon\r\n              iconClass=\"bx bx-dots-horizontal-rounded\"\r\n              onClick={() => setIsOpenMenu(!isOpenMenu)}\r\n              className=\"dark:bg-dark-third bg-gray-100\"\r\n            />\r\n            {isOpenMenu && (\r\n              <div className=\"animate-fadeIn transition-all duration-200 absolute right-0 border border-gray-200 bg-white w-52 rounded-lg shadow-md overflow-hidden p-1 dark:bg-dark-secondary dark:border-dark-third mt-2 select-none z-30\">\r\n                <button\r\n                  className=\"flex items-center space-x-3 w-full pl-2 pr-4 py-2 rounded-md text-left hover:bg-gray-200 active:bg-gray-300 transition-all duration-200 transform active:scale-95 dark:hover:bg-dark-third\"\r\n                  onClick={() => setDarkMode(!darkMode)}\r\n                >\r\n                  <span className=\"p-1 bg-gray-100 dark:bg-dark-hover rounded-full select-none\">\r\n                    <i\r\n                      className={\r\n                        \"text-center-middle text-center text-xl align-middle text-black dark:text-dark-txt w-7 h-7 bx \" +\r\n                        \" \" +\r\n                        (darkMode ? \" bx-sun\" : \" bx-moon\")\r\n                      }\r\n                    ></i>\r\n                  </span>\r\n                  <span>{darkMode ? \"Light Mode\" : \"Dark Mode\"}</span>\r\n                </button>\r\n                <button\r\n                  className=\"flex items-center space-x-3 w-full pl-2 pr-4 py-2 rounded-md text-left hover:bg-gray-200 active:bg-gray-300 transition-all duration-200 transform active:scale-95 dark:hover:bg-dark-third\"\r\n                  onClick={() => {\r\n                    openConfirmModal(\"Do you want to log out?\", logout);\r\n                  }}\r\n                >\r\n                  <span className=\"p-1 bg-gray-100 dark:bg-dark-hover rounded-full select-none\">\r\n                    <i className=\" bx bx-log-in-circle text-center text-xl align-middle text-black dark:text-dark-txt w-7 h-7\"></i>\r\n                  </span>\r\n                  <span>Log Out</span>\r\n                </button>\r\n              </div>\r\n            )}\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </>\r\n  );\r\n}\r\n\r\nexport default Header;\r\n","import { HubConnectionBuilder } from \"@microsoft/signalr\";\r\nimport {\r\n  addChat,\r\n  addMessage,\r\n  addNotification,\r\n  addReadByUserName,\r\n  editChat,\r\n  editGroupAvatar,\r\n  refreshChats,\r\n  setSelectedId,\r\n} from \"app/chatSlice\";\r\nimport { updateOnlineUserNameList, updateUser } from \"app/userSlice\";\r\nimport ChatList from \"components/ChatList\";\r\nimport ChatWindow from \"components/ChatWindow\";\r\nimport Header from \"components/Header\";\r\nimport useChatApi from \"hooks/useChatApi\";\r\nimport useUserApi from \"hooks/useUserApi\";\r\nimport Logo from \"logo.png\";\r\nimport React, { useEffect, useState } from \"react\";\r\nimport { useDispatch, useSelector } from \"react-redux\";\r\nimport { useHistory } from \"react-router\";\r\nimport { ChatClient } from \"utils/Constants\";\r\n\r\nfunction Chat() {\r\n  const [connection, setConnection] = useState(null);\r\n  const history = useHistory();\r\n\r\n  const dispatch = useDispatch();\r\n  const chats = useSelector((state) => state.chats.chats);\r\n  const currentUser = useSelector((state) => state.users.currentUser);\r\n  const selectedId = useSelector((state) => state.chats.selectedId);\r\n\r\n  const chatApi = useChatApi();\r\n  const userApi = useUserApi();\r\n\r\n  function logout() {\r\n    window.localStorage.removeItem(\"token\");\r\n    connection?.stop();\r\n    history.push(\"/login\");\r\n  }\r\n\r\n  useEffect(() => {\r\n    async function fetchData() {\r\n      chatApi\r\n        .getAll()\r\n        .then((response) => {\r\n          dispatch(refreshChats(response.data));\r\n        })\r\n        .catch((error) => {\r\n          console.error(\"Connection failed: \", error);\r\n        });\r\n\r\n      userApi\r\n        .getCurrentUser()\r\n        .then((response) => {\r\n          dispatch(updateUser(response));\r\n        })\r\n        .catch((error) => {\r\n          logout();\r\n        });\r\n    }\r\n\r\n    fetchData();\r\n  }, []);\r\n\r\n  // for realtime\r\n  useEffect(() => {\r\n    const newConnection = new HubConnectionBuilder()\r\n      .withUrl(process.env.REACT_APP_CHAT_HUB_URL, {\r\n        accessTokenFactory: () => localStorage.getItem(\"token\"),\r\n      })\r\n      .withAutomaticReconnect()\r\n      .build();\r\n\r\n    setConnection(newConnection);\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    if (connection && !connection.connectionStarted) {\r\n      connection.start().then((result) => {\r\n        connection.on(ChatClient.RECEIVE_MESSAGE, (response) => {\r\n          const action = addMessage(response);\r\n          dispatch(action);\r\n          if (response.chatId && selectedId !== response.chatId) {\r\n            dispatch(addNotification(response.chatId));\r\n          }\r\n        });\r\n        connection.on(ChatClient.RECEIVE_CHAT, (chat) => {\r\n          const action = addChat(chat);\r\n          dispatch(action);\r\n          if (chat.creatorUserName === currentUser.userName) {\r\n            dispatch(setSelectedId(chat.id));\r\n          }\r\n        });\r\n        connection.on(ChatClient.RECEIVE_UPDATED_CHAT, (chat) => {\r\n          const action = editChat(chat);\r\n          dispatch(action);\r\n        });\r\n        connection.on(ChatClient.RECEIVE_UPDATED_GROUP_AVATAR, (response) => {\r\n          const action = editGroupAvatar(response);\r\n          dispatch(action);\r\n        });\r\n        connection.on(ChatClient.RECEIVE_ADD_READ_BY_USERNAME, (response) => {\r\n          const action = addReadByUserName(response);\r\n          dispatch(action);\r\n        });\r\n        connection.on(\r\n          ChatClient.RECEIVE_UPDATED_ONLINE_USERNAME_LIST,\r\n          (response) => {\r\n            const action = updateOnlineUserNameList(response);\r\n            dispatch(action);\r\n          },\r\n        );\r\n      });\r\n    }\r\n    return () => {\r\n      if (connection && connection.connectionStarted) {\r\n        connection.stop();\r\n      }\r\n    };\r\n  }, [connection]);\r\n\r\n  return (\r\n    <>\r\n      <div className=\"dark:bg-dark-primary dark:text-white animate-fadeIn grid grid-cols-12 h-screen w-screen overflow-hidden\">\r\n        <div\r\n          className={\r\n            \"animate-fadeIn lg:col-span-3 md:col-span-4 col-span-12 md:flex flex-col h-screen border-r px-4 dark:border-dark-third border-gray-300 pt-1\" +\r\n            (selectedId !== 0 ? \" hidden\" : \"flex\")\r\n          }\r\n        >\r\n          <Header logout={logout} />\r\n          <ChatList />\r\n        </div>\r\n        {!selectedId ? (\r\n          chats?.length === 0 ? (\r\n            <div className=\"dark:bg-black animate-fadeIn hidden text-lg items-center justify-center lg:col-span-9 md:col-span-8 col-span-12 md:flex flex-col h-full w-full \">\r\n              <img src={Logo} className=\"w-32 h-32 mb-3\" alt=\"logo\" />\r\n              <span className=\"text-center\">\r\n                {\" \"}\r\n                Welcome to{\" \"}\r\n                <span className=\"text-green-600 dark:text-green-400 font-bold\">\r\n                  TeeChat!\r\n                </span>{\" \"}\r\n                <br />\r\n                You do not have any chats, please start a chat!{\" \"}\r\n              </span>\r\n              <span></span>\r\n            </div>\r\n          ) : (\r\n            <div className=\"dark:bg-black animate-fadeIn hidden text-lg items-center justify-center lg:col-span-9 md:col-span-8 col-span-12 md:flex flex-col h-full w-full \">\r\n              <img src={Logo} className=\"w-32 h-32 mb-3\" alt=\"logo\" />\r\n              <span className=\"text-center\">\r\n                {\" \"}\r\n                Welcome to{\" \"}\r\n                <span className=\"text-green-600 dark:text-green-400 font-bold\">\r\n                  TeeChat!\r\n                </span>{\" \"}\r\n                <br />\r\n                Select a chat to start.{\" \"}\r\n              </span>\r\n            </div>\r\n          )\r\n        ) : (\r\n          <div className=\"dark:bg-dark-primary md:dark:bg-black animate-fadeIn lg:col-span-9 md:col-span-8 col-span-12 flex h-screen w-full overflow-y-auto\">\r\n            <ChatWindow chat={chats.find((chat) => chat.id === selectedId)} />\r\n          </div>\r\n        )}\r\n      </div>\r\n    </>\r\n  );\r\n}\r\n\r\nexport default Chat;\r\n","export default __webpack_public_path__ + \"static/media/forbid.7d678d5c.jpg\";","import React from \"react\";\r\nimport ForbidImg from \"assets/img/forbid.jpg\";\r\nimport Button from \"components/Button\";\r\nimport { Link } from \"react-router-dom\";\r\n\r\nfunction Forbid({ message }) {\r\n  return (\r\n    <div className=\"animate-fadeIn fixed h-screen w-screen flex flex-col justify-center items-center space-y-8 px-2\">\r\n      <img className=\"md:w-1/3 object-cover\" src={ForbidImg} alt=\"Error\" />\r\n      <span className=\"font-bold text-2xl md:text-3xl text-center\">\r\n        {message ?? \"You don't have permission to access this resources\"}\r\n      </span>\r\n      <Link to=\"/\">\r\n        <Button content=\"Return home page\" />\r\n      </Link>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default Forbid;\r\n","export default __webpack_public_path__ + \"static/media/login-page.dc5637a7.jpg\";","import { getCurrentUser } from \"app/userSlice\";\r\nimport LoginPageImage from \"assets/img/login-page.jpg\";\r\nimport Button from \"components/Button\";\r\nimport useUserApi from \"hooks/useUserApi\";\r\nimport Logo from \"logo.png\";\r\nimport React, { useEffect, useState } from \"react\";\r\nimport { useDispatch } from \"react-redux\";\r\nimport { Link } from \"react-router-dom\";\r\n\r\nfunction Login() {\r\n  const [username, setUsername] = useState(\"\");\r\n  const [error, setError] = useState(\"\");\r\n  const [password, setPassword] = useState(\"\");\r\n  const [isDirty, setIsDirty] = useState(false);\r\n  const dispatch = useDispatch();\r\n\r\n  const userApi = useUserApi();\r\n\r\n  useEffect(() => {\r\n    if (username && password) {\r\n      setIsDirty(true);\r\n    } else {\r\n      setIsDirty(false);\r\n    }\r\n  }, [username, password]);\r\n  function login(e) {\r\n    e.preventDefault();\r\n\r\n    const request = { username, password };\r\n    setError(\"\");\r\n\r\n    userApi\r\n      .login(request)\r\n      .then((response) => {\r\n        dispatch(getCurrentUser());\r\n        window.localStorage.setItem(\"token\", response);\r\n        window.location.href = process.env.PUBLIC_URL + \"/\";\r\n      })\r\n      .catch((error) => {\r\n        var message =\r\n          typeof error === \"string\"\r\n            ? error\r\n            : \"Oops, something went wrong! Please contact administrator.\";\r\n        setError(message);\r\n      });\r\n  }\r\n  return (\r\n    <div className=\"animate-fadeIn h-screen grid md:grid-cols-7 place-items-center px-6\">\r\n      <img\r\n        src={LoginPageImage}\r\n        alt=\"login\"\r\n        className=\"md:block hidden col-span-3 w-full ml-44\"\r\n      />\r\n      <form\r\n        onSubmit={(e) => login(e)}\r\n        className=\"container rounded-2xl flex flex-col py-10 md:w-auto md:col-span-4\"\r\n      >\r\n        <img src={Logo} alt=\"login\" className=\"h-20 w-20 mx-auto mb-3\" />\r\n        <h1 className=\"text-3xl font-bold text-primary text-green-600 text-center mb-8\">\r\n          Login to TeeChat!\r\n        </h1>\r\n\r\n        {error && (\r\n          <span className=\"bg-red-500 rounded-md text-white text-lg mb-2 py-2 text-center\">\r\n            {error ?? \"Username or password is incorrect\"}\r\n          </span>\r\n        )}\r\n        <div className=\"space-y-2 mb-3\">\r\n          <label htmlFor=\"username\" className=\"text-lg font-semibold px-1\">\r\n            Username or email address\r\n          </label>\r\n          <input\r\n            value={username}\r\n            onChange={(e) => setUsername(e.target.value)}\r\n            id=\"username\"\r\n            type=\"text\"\r\n            className=\"bg-gray-100 rounded-lg w-full py-2 px-4 focus:ring-2 focus:ring-green-500 focus:ring-opacity-50 outline-none transition-all duration-200 mb-2\"\r\n          />\r\n        </div>\r\n        <div className=\"space-y-2 mb-2\">\r\n          <label htmlFor=\"password\" className=\"text-lg font-semibold px-1\">\r\n            Password\r\n          </label>\r\n          <input\r\n            value={password}\r\n            onChange={(e) => setPassword(e.target.value)}\r\n            type=\"password\"\r\n            id=\"password\"\r\n            className=\"bg-gray-100 rounded-lg w-full py-2 px-4 focus:ring-2 focus:ring-green-500 focus:ring-opacity-50 outline-none transition-all duration-200\"\r\n          />\r\n        </div>\r\n\r\n        <Button\r\n          disabled={!isDirty}\r\n          content=\"Login\"\r\n          className=\"mb-4 mt-2 font-bold\"\r\n        />\r\n        <div className=\"text-center\">\r\n          Not a member?{\" \"}\r\n          <Link to=\"/register\" className=\"text-green-500 font-bold\">\r\n            Sign up now\r\n          </Link>\r\n        </div>\r\n      </form>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default Login;\r\n","export default __webpack_public_path__ + \"static/media/not-found.500f302c.jpg\";","import React from \"react\";\r\nimport NotFoundImg from \"assets/img/not-found.jpg\";\r\nimport Button from \"components/Button\";\r\nimport { Link } from \"react-router-dom\";\r\n\r\nfunction NotFound({ message }) {\r\n  return (\r\n    <div className=\"animate-fadeIn fixed h-screen w-screen flex flex-col justify-center items-center space-y-8 px-2\">\r\n      <img className=\"md:w-1/3 object-cover\" src={NotFoundImg} alt=\"Error\" />\r\n      <span className=\" font-bold text-2xl md:text-3xl text-center\">\r\n        {message ?? \"Not found resources\"}\r\n      </span>\r\n      <Link to=\"/\">\r\n        <Button content=\"Return home page\" />\r\n      </Link>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default NotFound;\r\n","import { yupResolver } from \"@hookform/resolvers/yup\";\r\nimport LoginPageImage from \"assets/img/login-page.jpg\";\r\nimport Button from \"components/Button\";\r\nimport Popup from \"components/Popup\";\r\nimport useUserApi from \"hooks/useUserApi\";\r\nimport Logo from \"logo.png\";\r\nimport React, { useEffect, useState } from \"react\";\r\nimport { useForm, useWatch } from \"react-hook-form\";\r\nimport { Link, useHistory } from \"react-router-dom\";\r\nimport { checkRegex, identityObjectToString } from \"utils/UtilityMethods\";\r\nimport * as yup from \"yup\";\r\n\r\nfunction Register() {\r\n  const [isChanged, setIsChanged] = useState(false);\r\n  const [isExistsUserName, setIsExistsUserName] = useState(true);\r\n  const [popup, setPopup] = useState({\r\n    isOpen: false,\r\n    content: \"\",\r\n    title: \"Notification\",\r\n  });\r\n\r\n  const history = useHistory();\r\n  const userApi = useUserApi();\r\n\r\n  // yup validation\r\n  const schema = yup.object().shape({\r\n    firstName: yup.string().required(\"First Name is required\"),\r\n    lastName: yup.string().required(\"Last Name is required\"),\r\n    userName: yup\r\n      .string()\r\n      .required(\"User Name is required\")\r\n      .min(6, \"Username must be 6-20 characters\")\r\n      .max(20, \"Username must be 6-20 characters\")\r\n      .test(\r\n        \"checkUsername\",\r\n        \"Username does not contain special characters\",\r\n        (value) => {\r\n          return checkRegex(value, \"^[a-zA-Z0-9!@#$%^&*)(+=._-]{6,}$\");\r\n        },\r\n      )\r\n      .test(\r\n        \"existsUsername\",\r\n        \"Username is already taken\",\r\n        (value) => !isExistsUserName,\r\n      ),\r\n    email: yup\r\n      .string()\r\n      .required(\"Email is required\")\r\n      .test(\"checkEmail\", \"Email is invalid\", (value) => {\r\n        return checkRegex(\r\n          value,\r\n          /^[a-zA-Z0-9_.+-]+@[a-zA-Z0-9-]+\\.[a-zA-Z0-9-.]+$/,\r\n        );\r\n      }),\r\n    password: yup\r\n      .string()\r\n      .required(\"Password is required\")\r\n      .test(\r\n        \"checkPassword\",\r\n        \"Passwords must be at least 8 characters, one digit, one uppercase, one non alphanumeric character\",\r\n        (value) => {\r\n          return checkRegex(\r\n            value,\r\n            \"^(?=.*[a-z])(?=.*[A-Z])(?=.*\\\\d)(?=.*[#$^+=!*()@%&]).{8,}$\",\r\n          );\r\n        },\r\n      ),\r\n    confirmPassword: yup\r\n      .string()\r\n      .required(\"Confirm Password is required\")\r\n      .test(\r\n        \"ConfirmPasswordMatch\",\r\n        \"Password and Confirmation Password must match\",\r\n        (confirmPassword) => {\r\n          return confirmPassword === watch.password;\r\n        },\r\n      ),\r\n  });\r\n\r\n  // react hook form\r\n  const {\r\n    register,\r\n    handleSubmit,\r\n    control,\r\n    setError,\r\n    clearErrors,\r\n    reset,\r\n    formState: { errors },\r\n  } = useForm({\r\n    resolver: yupResolver(schema),\r\n    defaultValues: {},\r\n  });\r\n  const watch = useWatch({\r\n    control,\r\n  });\r\n\r\n  useEffect(() => {\r\n    userApi.checkUserNameExists(watch.userName).then((response) => {\r\n      if (response.isExists) {\r\n        setError(\r\n          \"userName\",\r\n          {\r\n            type: \"required\",\r\n            message: `Username '${watch.userName}' is already taken`,\r\n          },\r\n          { shouldFocus: true },\r\n        );\r\n        setIsExistsUserName(true);\r\n      } else {\r\n        clearErrors(\"userName\");\r\n        setIsExistsUserName(false);\r\n      }\r\n    });\r\n  }, [watch.userName]);\r\n\r\n  useEffect(() => {\r\n    const onChange = () => {\r\n      var isValid =\r\n        watch.firstName?.trim() &&\r\n        watch.lastName?.trim() &&\r\n        watch.userName?.trim() &&\r\n        watch.email &&\r\n        watch.password &&\r\n        watch.confirmPassword;\r\n\r\n      if (isValid) {\r\n        setIsChanged(true);\r\n        return;\r\n      }\r\n      setIsChanged(false);\r\n    };\r\n\r\n    onChange();\r\n  }, [watch]);\r\n\r\n  // handle submit\r\n  const onSubmit = (content) => {\r\n    userApi\r\n      .register(content)\r\n      .then((response) => {\r\n        openPopup(\r\n          \"Success\",\r\n          <span>\r\n            \"Create account successfully! Please{\" \"}\r\n            <Link className=\"font-bold text-green-600\" to=\"/login\">\r\n              log in\r\n            </Link>\r\n            !\"\r\n          </span>,\r\n        );\r\n        reset({});\r\n      })\r\n      .catch((error) => {\r\n        let message = error?.errors\r\n          ? identityObjectToString(error?.errors)\r\n          : \"\";\r\n        openPopup(\"Notification\", message);\r\n      });\r\n  };\r\n\r\n  function openPopup(title, content) {\r\n    const popup = {\r\n      isOpen: true,\r\n      title: title,\r\n      content: content,\r\n    };\r\n    setPopup(popup);\r\n  }\r\n\r\n  return (\r\n    <>\r\n      <Popup\r\n        title={popup.title}\r\n        isOpen={popup.isOpen}\r\n        content={popup.content}\r\n        onClick={() => {\r\n          setPopup({ isOpen: false });\r\n          history.push(\"/login\");\r\n        }}\r\n      />\r\n      <div className=\"animate-fadeIn z-10 h-screen grid md:grid-cols-7 place-items-center px-6\">\r\n        <img\r\n          src={LoginPageImage}\r\n          alt=\"login\"\r\n          className=\"md:block hidden col-span-3 w-full ml-44\"\r\n        />\r\n        <form\r\n          onSubmit={handleSubmit(onSubmit)}\r\n          className=\"container rounded-2xl flex flex-col py-10 md:w-full md:col-span-4 md:px-20 lg:px-48\"\r\n        >\r\n          <img src={Logo} alt=\"login\" className=\"h-20 w-20 mx-auto mb-3\" />\r\n          <h1 className=\"text-3xl font-bold text-primary text-green-600 text-center mb-8\">\r\n            Sign up to TeeChat!\r\n          </h1>\r\n          <div className=\"mb-3 grid grid-cols-2 place-items-start \">\r\n            <div className=\"col-span-1 space-y-2 mr-2 w-full\">\r\n              <label htmlFor=\"fistName\" className=\"text-lg font-semibold \">\r\n                First Name <span className=\"text-red-500\">*</span>\r\n              </label>\r\n              <input\r\n                {...register(\"firstName\")}\r\n                type=\"text\"\r\n                className=\"bg-gray-100 rounded-lg w-full py-2 px-3 focus:ring-2 focus:ring-green-500 focus:ring-opacity-50 outline-none transition-all duration-200\"\r\n              />\r\n              <div className=\"text-red-500 text-sm\">\r\n                {errors.firstName?.message}\r\n              </div>\r\n            </div>\r\n            <div className=\"col-span-1 space-y-2 ml-2 w-full\">\r\n              <label htmlFor=\"lastName\" className=\"text-lg font-semibold \">\r\n                Last Name <span className=\"text-red-500\">*</span>\r\n              </label>\r\n              <input\r\n                {...register(\"lastName\")}\r\n                type=\"text\"\r\n                className=\"bg-gray-100 rounded-lg w-full py-2 px-3 focus:ring-2 focus:ring-green-500 focus:ring-opacity-50 outline-none transition-all duration-200 mb-2\"\r\n              />\r\n              <div className=\"text-red-500 text-sm\">\r\n                {errors.lastName?.message}\r\n              </div>\r\n            </div>\r\n          </div>\r\n          <div className=\"space-y-2 mb-3\">\r\n            <label htmlFor=\"userName\" className=\"text-lg font-semibold \">\r\n              Username <span className=\"text-red-500\">*</span>\r\n            </label>\r\n            <input\r\n              {...register(\"userName\")}\r\n              type=\"text\"\r\n              className=\"bg-gray-100 rounded-lg w-full py-2 px-3 focus:ring-2 focus:ring-green-500 focus:ring-opacity-50 outline-none transition-all duration-200 mb-2\"\r\n            />\r\n            <div className=\"text-red-500 text-sm\">\r\n              {errors.userName?.message}\r\n            </div>\r\n          </div>\r\n          <div className=\"space-y-2 mb-3\">\r\n            <label htmlFor=\"email\" className=\"text-lg font-semibold \">\r\n              Email <span className=\"text-red-500\">*</span>\r\n            </label>\r\n            <input\r\n              {...register(\"email\")}\r\n              type=\"text\"\r\n              className=\"bg-gray-100 rounded-lg w-full py-2 px-3 focus:ring-2 focus:ring-green-500 focus:ring-opacity-50 outline-none transition-all duration-200 mb-2\"\r\n            />\r\n            <div className=\"text-red-500 text-sm\">{errors.email?.message}</div>\r\n          </div>\r\n\r\n          <div className=\"space-y-2 mb-2\">\r\n            <label htmlFor=\"password\" className=\"text-lg font-semibold \">\r\n              Password <span className=\"text-red-500\">*</span>\r\n            </label>\r\n            <input\r\n              type=\"password\"\r\n              {...register(\"password\")}\r\n              className=\"bg-gray-100 rounded-lg w-full py-2 px-3 focus:ring-2 focus:ring-green-500 focus:ring-opacity-50 outline-none transition-all duration-200\"\r\n            />\r\n            <div className=\"text-red-500 text-sm\">\r\n              {errors.password?.message}\r\n            </div>\r\n          </div>\r\n          <div className=\"space-y-2 mb-2\">\r\n            <label htmlFor=\"confirmPassword\" className=\"text-lg font-semibold \">\r\n              Confirm Password <span className=\"text-red-500\">*</span>\r\n            </label>\r\n            <input\r\n              type=\"password\"\r\n              {...register(\"confirmPassword\")}\r\n              className=\"bg-gray-100 rounded-lg w-full py-2 px-3 focus:ring-2 focus:ring-green-500 focus:ring-opacity-50 outline-none transition-all duration-200\"\r\n            />\r\n            <div className=\"text-red-500 text-sm\">\r\n              {errors.confirmPassword?.message}\r\n            </div>\r\n          </div>\r\n          <Button\r\n            disabled={!isChanged}\r\n            content=\"Sign Up\"\r\n            className=\"mb-4 mt-2 font-bold\"\r\n          />\r\n          <div className=\"text-center\">\r\n            Already a member?{\" \"}\r\n            <Link to=\"/login\" className=\"text-green-500 font-bold\">\r\n              Sign in\r\n            </Link>\r\n          </div>\r\n        </form>\r\n      </div>\r\n    </>\r\n  );\r\n}\r\n\r\nexport default Register;\r\n","export default __webpack_public_path__ + \"static/media/error.c72c9a3e.jpg\";","import React from \"react\";\r\nimport ErrorImg from \"assets/img/error.jpg\";\r\nimport Button from \"components/Button\";\r\nimport { Link } from \"react-router-dom\";\r\n\r\nfunction ServerError({ message }) {\r\n  return (\r\n    <div className=\"animate-fadeIn fixed h-screen w-screen flex flex-col justify-center items-center space-y-8 px-2\">\r\n      <img className=\"md:w-1/3 object-cover\" src={ErrorImg} alt=\"Error\" />\r\n      <span className=\"font-bold text-2xl md:text-3xl text-center\">\r\n        {message ?? \"Oops! Something went wrong!\"}\r\n      </span>\r\n      <Link to=\"/\">\r\n        <Button content=\"Return home page\" />\r\n      </Link>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default ServerError;\r\n","import React from \"react\";\r\nimport { useDispatch, useSelector } from \"react-redux\";\r\nimport {\r\n  HashRouter as BrowserRouter,\r\n  Redirect,\r\n  Route,\r\n  Switch,\r\n} from \"react-router-dom\";\r\n\r\nimport { setPopup } from \"app/appSlice\";\r\nimport Loader from \"components/Loader\";\r\nimport Popup from \"components/Popup\";\r\nimport Chat from \"./pages/Chat\";\r\nimport Forbid from \"./pages/Forbid\";\r\nimport Login from \"./pages/Login\";\r\nimport NotFound from \"./pages/NotFound\";\r\nimport Register from \"./pages/Register\";\r\nimport ServerError from \"./pages/ServerError\";\r\n\r\nfunction App() {\r\n  const isLoading = useSelector((state) => state.app.isLoading);\r\n  const popup = useSelector((state) => state.app.popup);\r\n  const dispatch = useDispatch();\r\n\r\n  function closePopup() {\r\n    dispatch(setPopup({ isOpen: false }));\r\n  }\r\n  return (\r\n    <>\r\n      <BrowserRouter basename={process.env.PUBLIC_URL}>\r\n        <Loader isOpen={isLoading} className=\"z-50\" />\r\n        <Popup\r\n          title={popup.title}\r\n          isOpen={popup.isOpen}\r\n          content={popup.content}\r\n          onClick={closePopup}\r\n        />\r\n\r\n        <Switch>\r\n          <Route path=\"/login\" component={Login} />\r\n          <Route path=\"/register\" component={Register} />\r\n          <Route path=\"/forbid\" component={Forbid} />\r\n          <Route path=\"/ServerError\" component={ServerError} />\r\n          <PrivateRoute path=\"/chats\" component={Chat} />\r\n          <PrivateRoute exact path=\"/\" component={Chat} />\r\n          <Route path=\"*\" component={NotFound} />\r\n        </Switch>\r\n      </BrowserRouter>\r\n    </>\r\n  );\r\n}\r\n\r\nexport default App;\r\n\r\nfunction PrivateRoute({ component: Component, ...rest }) {\r\n  var isLogin = window.localStorage.getItem(\"token\") ? true : false;\r\n\r\n  return (\r\n    <Route\r\n      {...rest}\r\n      render={(props) =>\r\n        isLogin === true ? (\r\n          <Component {...props} />\r\n        ) : (\r\n          <Redirect\r\n            to={{ pathname: \"/login\", state: { from: props.location } }}\r\n          />\r\n        )\r\n      }\r\n    />\r\n  );\r\n}\r\n","import React from \"react\";\r\nimport ReactDOM from \"react-dom\";\r\nimport { Provider } from \"react-redux\";\r\nimport store from \"app/store\";\r\n\r\nimport \"./index.css\";\r\nimport App from \"./App\";\r\nimport \"boxicons/css/boxicons.min.css\";\r\n\r\nReactDOM.render(\r\n  <React.StrictMode>\r\n    <Provider store={store}>\r\n      <App />\r\n    </Provider>\r\n  </React.StrictMode>,\r\n  document.getElementById(\"root\"),\r\n);\r\n"],"sourceRoot":""}