(this["webpackJsonptee-chat"]=this["webpackJsonptee-chat"]||[]).push([[0],{114:function(e,t,n){},252:function(e,t,n){"use strict";n.r(t);var a=n(1),r=n.n(a),s=n(47),c=n.n(s),i=n(7),o=n(21),l=n(22),d=Object(o.b)({name:"chats",initialState:[],reducers:{addChat:function(e,t){e.some((function(e){return e.id===t.payload.id}))||e.push(t.payload)},editChat:function(e,t){var n=t.payload,a=e.findIndex((function(e){return e.id===n.id}));a>=0?(e[a].name=n.name,e[a].participants=n.participants):e.push(n)},editGroupAvatar:function(e,t){var n,a=t.payload.chatId,r=e.findIndex((function(e){return e.id===a}));r>=0&&(e[r].groupAvatarUrl=null===(n=t.payload)||void 0===n?void 0:n.groupAvatarUrl)},addReadByUserName:function(e,t){var n=t.payload,a=n.chatId,r=n.readByUserName,s=e.findIndex((function(e){return e.id===a}));s>=0&&(e[s].readByUserNames.includes(r)||e[s].readByUserNames.push(r))},appendMessageToChat:function(e,t){var n=t.payload,a=null===n||void 0===n?void 0:n.messages,r=e.findIndex((function(e){return e.id===n.id}));r>=0&&(e[r].totalRecords=n.totalRecords,e[r].limit=n.limit,e[r].page=n.page,e[r].pageCount=n.pageCount,n.keyword?e[r].messages=a:e[r].messages=e[r].messages.concat(a))},refreshChats:function(e,t){var n;return null!==(n=t.payload)&&void 0!==n?n:[]},addMessage:function(e,t){var n=t.payload,a=e.findIndex((function(e){return e.id===n.chatId}));a>=0&&(e[a].messages.push(null===n||void 0===n?void 0:n.message),e[a].readByUserNames=[null===n||void 0===n?void 0:n.SenderUserName])},addNotification:function(e,t){var n=t.payload,a=e.findIndex((function(e){return e.id===n}));a>=0&&(e[a].numOfUnreadMessages+=1)},readChat:function(e,t){var n=t.payload,a=e.findIndex((function(e){return e.id===n}));a>=0&&(e[a].numOfUnreadMessages=0)}}}),u=Object(o.b)({name:"selectedId",initialState:0,reducers:{setSelectedId:function(e,t){return t.payload}}}),m=Object(l.b)({chats:d.reducer,selectedId:u.reducer}),b=d.actions,f=b.addChat,j=b.editChat,x=b.refreshChats,p=b.addMessage,v=b.appendMessageToChat,g=b.editGroupAvatar,h=b.readChat,O=b.addNotification,N=b.addReadByUserName,w=u.actions.setSelectedId,y=m,k=Object(o.b)({name:"isLoading",initialState:!1,reducers:{setIsLoading:function(e,t){return t.payload}}}),C=Object(o.b)({name:"popup",initialState:{isOpen:!1,content:"",title:"Notification"},reducers:{setPopup:function(e,t){return t.payload}}}),S=Object(l.b)({isLoading:k.reducer,popup:C.reducer}),U=k.actions.setIsLoading,I=C.actions.setPopup,E=S,F=n(95),L=Object(o.b)({name:"currentUser",initialState:{},reducers:{getCurrentUser:function(e,t){var n=function(){var e=window.localStorage.getItem("token");if(e){return Object(F.a)(e)}return!1}();if(n)return n},updateUser:function(e,t){if(t.payload.userName)return t.payload}}}),A=Object(o.b)({name:"onlineUserNameList",initialState:[],reducers:{updateOnlineUserNameList:function(e,t){return t.payload}}}),z=Object(l.b)({currentUser:L.reducer,onlineUserNameList:A.reducer}),M=L.actions,B=M.getCurrentUser,R=M.updateUser,P=A.actions.updateOnlineUserNameList;var T={chats:y,app:E,users:z},q=Object(o.a)({reducer:T}),D=(n(114),n(12)),G=n(105),Y=n(15),Z=n(13),$=n.p+"static/media/logo.3faacd46.png",W=n(0),J=function(e){var t,n=e.className,a=e.isOpen,r=void 0===a||a,s="h-3 w-3 bg-gradient-to-br from-green-300 to-green-600 shadow-md rounded-full";return Object(W.jsx)(W.Fragment,{children:Object(W.jsxs)("div",{className:"z-50 flex flex-col h-screen w-screen justify-center items-center fixed transition-all duration-200 bg-white dark:bg-dark-secondary "+(r?"animate-fadeIn":"animate-fadeOut")+(null!==(t=" "+n)&&void 0!==t?t:""),children:[Object(W.jsx)("img",{src:$,className:"w-20 h-20 mb-10",alt:"logo"}),Object(W.jsxs)("div",{className:"flex justify-center items-center transition-all duration-200",children:[Object(W.jsx)("div",{className:"".concat(s," mr-3 animate-bounce")}),Object(W.jsx)("div",{className:"".concat(s," mr-3 animate-bounce200")}),Object(W.jsx)("div",{className:"".concat(s," animate-bounce400")})]})]})})};var V=function(e){var t=e.outline,n=void 0!==t&&t,a=e.content,r=e.className,s=e.onClick,c=e.onBlur,i=e.disabled,o=e.children;return Object(W.jsx)(W.Fragment,{children:Object(W.jsx)("button",{disabled:i,onClick:s,onBlur:c,className:"px-4 py-2 rounded-lg transition-all text-sm md:text-base duration-200 disabled:opacity-50 outline-none z-0 select-none min-w-70  "+(n?"ring-inset ring-1 ring-green-500 bg-white dark:bg-transparent dark:hover:bg-green-500 text-green-500 hover:text-white hover:bg-green-400 active:bg-green-500":"bg-gradient-to-br from-green-400 to-green-600 text-white active:from-green-500 active:to-green-600  ")+" "+(null!==r&&void 0!==r?r:"")+" "+(i?"cursor-default":"active:scale-95 active:transform"),children:a||o})})};var _=function(e){var t=e.title,n=void 0===t?"Notification":t,a=e.isOpen,r=e.content,s=void 0===r?"Oops! Something went wrong!":r,c=e.onClick;return a&&Object(W.jsx)("div",{className:"px-4 animate-fadeIn h-screen fixed inset-0 w-screen flex justify-center items-center bg-gray-500 bg-opacity-30 dark:bg-dark-primary dark:bg-opacity-50 z-50",children:Object(W.jsxs)("div",{className:"bg-white shadow-xl dark:bg-dark-secondary py-8 px-8 w-full md:w-2/3 lg:w-1/2 flex flex-col justify-between items-start rounded-xl space-y-6",children:[Object(W.jsx)("h3",{className:"font-semibold text-2xl break-words dark:text-dark-txt",children:n}),Object(W.jsx)("span",{className:"break-words dark:text-dark-txt",children:s}),Object(W.jsx)("div",{className:"w-full flex justify-end",children:Object(W.jsx)(V,{content:"Close",onClick:c})})]})})},H=n(5),K=n.n(H),Q=n(8),X=n(3),ee=n(104),te=n(6),ne=n.p+"static/media/default-avatar.ae67bd1e.jpg";var ae=function(e){var t,n,a,r=e.src,s=void 0===r?ne:r,c=e.className,o=void 0===c?"":c,l=e.alt,d=void 0===l?"Avatar":l,u=e.size,m=void 0===u?"md":u,b=e.userName,f=void 0===b?"":b,j=e.participants,x=Object(i.c)((function(e){return e.users.onlineUserNameList})),p=Object(i.c)((function(e){return e.users.currentUser})),v=f===p.userName,g=!1;switch(v||(f?g=x.includes(f):j&&(g=j.filter((function(e){return e.userName!==p.userName})).map((function(e){return e})).some((function(e){return x.includes(e.userName)})))),m){case"xs":case"sm":n="w-2 h-2";break;case"lg":case"xl":case"full":n="border-2 w-4 h-4";break;default:n="border-2 w-4 h-4"}switch(m){case"xs":a="h-5 w-5 md:h-6 md:w-6";break;case"sm":a="h-6 w-6 md:h-8 md:w-8";break;case"lg":a="h-14 w-14 md:h-16 md:w-16";break;case"xl":a="h-22 w-22 md:h-24 md:w-24";break;case"full":a="h-full w-full";break;default:a="h-10 w-10 md:h-12 md:w-12"}return Object(W.jsxs)("div",{className:"relative flex-shrink-0",children:[Object(W.jsx)("img",{className:null!==(t=a+" select-none bg-white rounded-full object-cover flex-shrink-0 "+o)&&void 0!==t?t:"",src:s&&""!==s?s:ne,alt:d}),(v||g)&&Object(W.jsx)("span",{className:"absolute bg-green-500 dark:bg-green-400 bottom-0 right-0 rounded-full border-white dark:border-black "+n})]})},re="No name",se="Unknown",ce=1,ie=2,oe="ReceiveMessage",le="ReceiveChat",de="ReceiveUpdatedChat",ue="ReceiveUpdatedGroupAvatar",me="ReceiveAddReadByUserName",be="ReceiveUpdatedOnlineUserNameList",fe=n(61),je=n.n(fe);function xe(e){var t=new Date(e);if(function(e){return e instanceof Date&&!isNaN(e)}(t)){var n=je()(new Date),a=je()(t),r=n.diff(a,"days");return r<1?a.fromNow():r<7?a.format("dddd, h:mm A"):a.format("MMM D, YYYY, h:mm A")}return"--"}function pe(e,t){if(e&&t)return new RegExp(t).test(e)}function ve(e){for(var t="",n=0,a=Object.values(e);n<a.length;n++){var r=a[n];t+="".concat(r.toString(),", ")}return t=t.substring(0,t.length-2)}var ge=function(){var e=Object(i.c)((function(e){return e.chats.chats})),t=Object(i.c)((function(e){return e.chats.selectedId})),n=Object(i.c)((function(e){return e.users.currentUser})),r=Object(i.b)(),s=Object(a.useState)(""),c=Object(X.a)(s,2),o=c[0],l=c[1];return Object(W.jsxs)(W.Fragment,{children:[Object(W.jsxs)("div",{className:"relative",children:[Object(W.jsx)("input",{type:"search",className:"my-3 rounded-3xl bg-gray-100 px-4 pl-10 pr-3 py-2 focus:ring-2 focus:ring-green-400 focus:ring-opacity-50 outline-none transition-all duration-200 w-full dark:bg-dark-secondary dark:text-white",placeholder:"Search chat",onChange:function(e){return l(e.target.value)}}),Object(W.jsx)("i",{className:"bx bx-search absolute text-xl top-1/2 left-3 transform text-gray-400 -translate-y-1/2 cursor-pointer"})]}),Object(W.jsxs)("div",{className:"h-full overflow-x-hidden space-y-2 overflow-y-auto pr-2 pb-48 md:pb-0",children:[e&&he(e,o).map((function(e,a){var s,c,i,o,l,d=n.userName;if(null===e||void 0===e?void 0:e.participants.some((function(e){return e.userName===d}))){var u,m=(null===e||void 0===e?void 0:e.participants.length)>1?null===e||void 0===e||null===(s=e.participants)||void 0===s?void 0:s.filter((function(e){return e.userName!==d})).shift():n,b={};if(0!==(null===(c=e.messages)||void 0===c?void 0:c.length))b=null===(u=e.messages)||void 0===u?void 0:u.reduce((function(e,t){return(null===e||void 0===e?void 0:e.dateCreated)>(null===t||void 0===t?void 0:t.dateCreated)?e:t}));return Object(W.jsxs)("div",{className:"relative select-none w-full h-20 flex flex-start cursor-pointer hover:bg-gray-100 p-2 rounded-lg transition-all duration-150 ease-in dark:hover:bg-dark-secondary dark:text-dark-txt "+(t===e.id?"bg-gray-100 dark:bg-dark-secondary":""),onClick:function(){return function(e){if(e!==t){var n=w(e);r(n)}}(e.id)},children:[e.numOfUnreadMessages>0&&t!==e.id&&Object(W.jsx)("span",{className:"w-6 h-6 absolute right-7 top-1/2 text-xs font-bold p-1 bg-green-500 dark:bg-green-600 text-white rounded-full text-center align-middle",children:e.numOfUnreadMessages>9?"9+":e.numOfUnreadMessages}),Object(W.jsx)(ae,{src:(null===e||void 0===e?void 0:e.type)===ce?null===m||void 0===m?void 0:m.avatarUrl:null===e||void 0===e?void 0:e.groupAvatarUrl,size:"lg",participants:null===e||void 0===e?void 0:e.participants}),Object(W.jsxs)("div",{className:"font-primary flex flex-col px-3 py-2 justify-between truncate w-full",children:[Object(W.jsxs)("div",{className:"flex justify-between items-center w-full min-w-0 space-x-3",children:[Object(W.jsx)("span",{className:"text-gray-800 truncate dark:text-dark-txt "+(e.numOfUnreadMessages>0&&t!==e.id?"font-bold":""),children:(null===e||void 0===e?void 0:e.type)===ce?null===m||void 0===m?void 0:m.fullName:null!==(i=null===e||void 0===e?void 0:e.name)&&void 0!==i?i:re}),Object(W.jsx)("span",{className:"text-sm text-gray-500 truncate flex-shrink-0",children:xe(null!==(o=null===(l=b)||void 0===l?void 0:l.dateCreated)&&void 0!==o?o:null===e||void 0===e?void 0:e.dateCreated)})]}),Object(W.jsx)("div",{className:"flex",children:Object(W.jsx)("span",{className:"mr-2 text-sm text-gray-500 truncate overflow-hidden flex-grow "+(e.numOfUnreadMessages>0&&t!==e.id?"font-bold mr-10":""),children:b.content?b.content:b.imageUrl?"Sent an image":""})})]})]},e.id)}})),0===(null===e||void 0===e?void 0:e.length)&&Object(W.jsxs)("div",{className:"animate-fadeIn flex md:hidden items-center justify-center lg:col-span-9 md:col-span-8 col-span-12 flex-col h-full w-full",children:[Object(W.jsx)("img",{src:$,className:"w-16 h-16 mb-3",alt:"logo"}),Object(W.jsxs)("span",{className:"text-center",children:[" ","Welcome to"," ",Object(W.jsx)("span",{className:"text-green-600 dark:text-green-400 font-bold",children:"TeeChat!"})," ",Object(W.jsx)("br",{}),"You do not have any chats, please start a chat!"," "]}),Object(W.jsx)("span",{})]})]})]})};function he(e,t){var n=function(e){if(e)return Object(te.a)(e).sort((function(e,t){var n,a,r,s,c,i,o={},l={};0!==(null===(n=e.messages)||void 0===n?void 0:n.length)?o=null===(c=e.messages)||void 0===c?void 0:c.reduce((function(e,t){return(null===e||void 0===e?void 0:e.dateCreated)>(null===t||void 0===t?void 0:t.dateCreated)?e:t})):o.dateCreated=null===e||void 0===e?void 0:e.dateCreated;0!==(null===(a=t.messages)||void 0===a?void 0:a.length)?l=null===(i=t.messages)||void 0===i?void 0:i.reduce((function(e,t){return(null===e||void 0===e?void 0:e.dateCreated)>(null===t||void 0===t?void 0:t.dateCreated)?e:t})):l.dateCreated=null===t||void 0===t?void 0:t.dateCreated;return(null===(r=o)||void 0===r?void 0:r.dateCreated)<(null===(s=l)||void 0===s?void 0:s.dateCreated)?1:-1}))}(e);return n=function(e,t){if(e)return e.filter((function(e){var n;return(null===e||void 0===e?void 0:e.participants.some((function(e){return!(!e.fullName.toLowerCase().includes(t.toLowerCase())&&!(null===e||void 0===e?void 0:e.userName.toLowerCase().includes(t.toLowerCase())))})))||(null===e||void 0===e||null===(n=e.name)||void 0===n?void 0:n.toLowerCase().includes(t.toLowerCase()))}))}(n,t)}var Oe=n.p+"static/media/info-icon.b4879a5e.svg",Ne=n.p+"static/media/left-arrow-icon.07714e5b.svg",we=n.p+"static/media/emoji.21d0cbf4.svg",ye=n.p+"static/media/image-icon.c8ad9f46.svg",ke=n.p+"static/media/send-icon.666dadc9.svg";var Ce=function(e){var t=e.className,n=e.icon,a=e.iconClass,r=e.alt,s=e.onClick,c=e.onBlur;return Object(W.jsx)(W.Fragment,{children:Object(W.jsx)("div",{onBlur:c,onClick:s,className:"p-1 rounded-full hover:bg-gray-200 active:bg-gray-300 dark:hover:bg-dark-hover dark:border-dark-third transition-all duration-200 cursor-pointer ease-in dark:active:bg-dark-third active:scale-90 active:transform select-none flex-shrink-0 "+(null!==t&&void 0!==t?t:""),children:n?Object(W.jsx)("img",{alt:null!==r&&void 0!==r?r:"Clickable Icon",src:n,onClick:s,className:"w-full"}):Object(W.jsx)("i",{className:"text-center align-middle text-xl text-black dark:text-dark-txt w-7 h-7  "+a})})})},Se=n(97),Ue=n.n(Se),Ie=n(98),Ee=n.n(Ie),Fe=n(99),Le=n.n(Fe);function Ae(){var e=Object(i.b)(),t=Object(Z.g)(),n=Ee.a.create({baseURL:"https://teeappapi.azurewebsites.net/api",timeout:3e5,headers:{"Content-Type":"application/json"},paramsSerializer:function(e){return Le.a.stringify(e)}});function a(t,n){e(I({isOpen:!0,title:t,content:n}))}return n.interceptors.request.use(function(){var e=Object(Q.a)(K.a.mark((function e(t){var n,a;return K.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=window.localStorage.getItem("token"),a=t,n&&(a=Object(D.a)(Object(D.a)({},t),{},{headers:{Authorization:"Bearer ".concat(n)}})),e.abrupt("return",a);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),n.interceptors.response.use((function(t){return e(U(!1)),t&&t.data?t.data:t}),(function(n){var r,s,c,i,o,l,d,u;e(U(!1));var m="string"===typeof(null===(r=n.response)||void 0===r?void 0:r.data)?null===(s=n.response)||void 0===s?void 0:s.data:"Oops, something went wrong! Please contact administrator.";if(n.response){var b="Notification";switch(n.response.status){case 401:b="Login required",window.localStorage.removeItem("token"),window.location.href="/TeeChat/";break;case 403:b="Forbidden",null===t||void 0===t||t.push("/ForBid");break;case 500:b="Server error",null===t||void 0===t||t.push("/ServerError");break;default:return a(b,m=(null===(c=n.response)||void 0===c||null===(i=c.data)||void 0===i?void 0:i.errors)?ve(null===(o=n.response)||void 0===o||null===(l=o.data)||void 0===l?void 0:l.errors):m),Promise.reject(null===(d=n.response)||void 0===d?void 0:d.data)}}return m.toLowerCase().includes("Unable to identify user")&&(a(b,m),window.localStorage.removeItem("token"),window.location.href="/TeeChat/"),null===t||void 0===t||t.push("/ServerError"),Promise.reject(null===n||void 0===n||null===(u=n.response)||void 0===u?void 0:u.data)})),n}var ze="/chats";function Me(){var e=Ae(),t=Object(i.b)();return{getAll:function(){t(U(!0));var n="".concat(ze);return e.get(n)},getById:function(n,a){t(U(!0));var r="".concat(ze,"/").concat(n);return e.get(r,{params:a})},sendMessage:function(t,n){var a="".concat(ze,"/").concat(t,"/send");return e.post(a,n)},readChat:function(t){var n="".concat(ze,"/").concat(t,"/read");return e.patch(n)},sendImage:function(n,a){t(U(!0));var r="".concat(ze,"/").concat(n,"/sendImage");return e.interceptors.request.use(function(){var e=Object(Q.a)(K.a.mark((function e(t){var n,a;return K.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=window.localStorage.getItem("token"),a={},n&&(a=Object(D.a)(Object(D.a)({},t),{},{headers:{"content-type":"multipart/form-data",Authorization:"Bearer ".concat(n)}})),e.abrupt("return",a);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),e.post(r,a)},updateGroupAvatar:function(n,a){t(U(!0));var r="".concat(ze,"/").concat(n,"/avatar");return e.interceptors.request.use(function(){var e=Object(Q.a)(K.a.mark((function e(t){var n,a;return K.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=window.localStorage.getItem("token"),a={},n&&(a=Object(D.a)(Object(D.a)({},t),{},{headers:{"content-type":"multipart/form-data",Authorization:"Bearer ".concat(n)}})),e.abrupt("return",a);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),e.patch(r,a)},createGroupChat:function(n){var a;n.groupName=null===n||void 0===n||null===(a=n.groupName)||void 0===a?void 0:a.substring(0,99),t(U(!0));var r="".concat(ze,"/group");return e.post(r,n)},updateGroupChat:function(n,a){var r;a.newGroupName=null===a||void 0===a||null===(r=a.newGroupName)||void 0===r?void 0:r.substring(0,99),t(U(!0));var s="".concat(ze,"/").concat(n);return e.patch(s,a)},createPrivateChat:function(n){t(U(!0));var a="".concat(ze,"/private");return e.post(a,n)}}}var Be=function(e){var t=e.chatId,n=Object(a.useState)(""),r=Object(X.a)(n,2),s=r[0],c=r[1],i=Object(a.useState)(!1),o=Object(X.a)(i,2),l=o[0],d=o[1],u=Object(a.useRef)(),m=Me();function b(){return(b=Object(Q.a)(K.a.mark((function e(n){var a;return K.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n.preventDefault(),s){e.next=3;break}return e.abrupt("return");case 3:return c(""),a={content:s},e.next=7,m.sendMessage(t,a);case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function f(){return(f=Object(Q.a)(K.a.mark((function e(n){var a,r;return K.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=n.target.files[0],(r=new FormData).append("Image",a),e.next=5,m.sendImage(t,r);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(a.useEffect)((function(){var e=function(e){l&&u.current&&!u.current.contains(e.target)&&d(!1)};return document.addEventListener("mousedown",e),function(){document.removeEventListener("mousedown",e)}}),[l]),Object(W.jsx)("div",{children:Object(W.jsxs)("form",{onSubmit:function(e){return function(e){return b.apply(this,arguments)}(e)},className:"flex justify-between items-center space-x-1 pl-4 pr-2 md:pr-6 z-0",children:[Object(W.jsxs)("div",{className:"relative w-full flex",children:[Object(W.jsx)("input",{id:"imageFile",type:"file",hidden:!0,accept:"image/png, image/jpg, image/tiff, image/tif, image/jpeg",onChange:function(e){return f.apply(this,arguments)}}),Object(W.jsx)("label",{htmlFor:"imageFile",children:Object(W.jsx)(Ce,{className:"h-10 w-10 p-2 mr-2",icon:ye})}),Object(W.jsx)("input",{value:s,onChange:function(e){return c(e.target.value)},type:"text",placeholder:"Aa",className:"bg-gray-200 dark:bg-dark-secondary rounded-3xl w-full py-2 px-4 pr-12 focus:ring-2 focus:ring-green-500 focus:ring-opacity-50 outline-none transition-all duration-200 relative"}),Object(W.jsxs)("div",{ref:u,position:"relative",children:[Object(W.jsx)(Ce,{className:"absolute h-10 w-10 p-2 right-1 top-0",icon:we,onClick:function(){return d(!l)}}),Object(W.jsx)("div",{className:"animate-fadeIn absolute right-0 bottom-full  "+(l?"visible":"invisible"),children:Object(W.jsx)(Ue.a,{onEmojiClick:function(e,t){(null===t||void 0===t?void 0:t.emoji)&&c(s+(null===t||void 0===t?void 0:t.emoji))}})})]})]}),Object(W.jsx)("button",{children:Object(W.jsx)(Ce,{disableAutoFocus:!0,icon:ke,className:"w-12 h-12 p-3"})})]})})};var Re=function(e){var t=e.title,n=e.isOpen,a=e.content,r=void 0===a?"Are you sure?":a,s=e.closeAction,c=e.confirmButtonTitle,i=e.confirmButtonAction;return n&&Object(W.jsx)("div",{className:"px-4 animate-fadeIn h-screen fixed inset-0 w-screen flex justify-center items-center bg-gray-500 dark:bg-dark-primary dark:bg-opacity-50 bg-opacity-30 z-50",children:Object(W.jsxs)("div",{className:"bg-white dark:bg-dark-secondary dark:border-dark-third py-8 px-8 w-full md:w-2/3 lg:w-1/2 flex flex-col justify-between items-start rounded-xl space-y-6 shadow-xl",children:[Object(W.jsx)("h3",{className:"font-semibold text-2xl break-words dark:text-dark-txt",children:""!==t?t:"Notification"}),Object(W.jsx)("span",{className:"break-words dark:text-dark-txt",children:r}),Object(W.jsxs)("div",{className:"w-full flex justify-end space-x-2",children:[Object(W.jsx)(V,{outline:!0,content:"No",onClick:s}),Object(W.jsx)(V,{content:null!==c&&void 0!==c?c:"Ok",onClick:i})]})]})})},Pe="/users",Te="/accounts";function qe(){var e=Ae(),t=Object(i.b)();return{login:function(n){t(U(!0));var a="".concat(Te,"/login");return e.post(a,n)},register:function(n){var a,r;n.firstName=null===n||void 0===n||null===(a=n.firstName)||void 0===a?void 0:a.substring(0,49),n.lastName=null===n||void 0===n||null===(r=n.lastName)||void 0===r?void 0:r.substring(0,49),t(U(!0));var s="".concat(Te,"/register");return e.post(s,n)},checkUserNameExists:function(t){if(t){var n="".concat(Te,"/").concat(t,"/isExists");return e.get(n)}return Promise.reject()},getUserList:function(){var t="".concat(Pe);return e.get(t)},getCurrentUser:function(){var t="".concat(Pe,"/current");return e.get(t)},updateInformation:function(n){t(U(!0));var a="".concat(Pe);return e.put(a,n)},updateAvatar:function(n){t(U(!0));var a="".concat(Pe,"/avatar");return e.interceptors.request.use(function(){var e=Object(Q.a)(K.a.mark((function e(t){var n,a;return K.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=window.localStorage.getItem("token"),a={},n&&(a=Object(D.a)(Object(D.a)({},t),{},{headers:{"content-type":"multipart/form-data",Authorization:"Bearer ".concat(n)}})),e.abrupt("return",a);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),e.patch(a,n)}}}var De=function(e){var t=e.isOpen,n=e.setIsOpen,r=e.chat,s=Object(a.useState)(!1),c=Object(X.a)(s,2),o=c[0],l=c[1],d=Object(a.useState)(""),u=Object(X.a)(d,2),m=u[0],b=u[1],f=Object(a.useState)(null===r||void 0===r?void 0:r.name),j=Object(X.a)(f,2),x=j[0],p=j[1],v=Object(a.useState)(""),g=Object(X.a)(v,2),h=g[0],O=g[1],N=Object(a.useState)(!1),y=Object(X.a)(N,2),k=y[0],C=y[1],S=Object(a.useState)(!1),U=Object(X.a)(S,2),I=U[0],E=U[1],F=Object(a.useState)([]),L=Object(X.a)(F,2),A=L[0],z=L[1],M=Object(a.useState)(!1),B=Object(X.a)(M,2),R=B[0],P=B[1],T=Object(a.useState)(null===r||void 0===r?void 0:r.participants),q=Object(X.a)(T,2),D=q[0],G=q[1],Y=Me(),Z=qe(),$=Object(a.useState)({isOpen:!1,content:"",title:"Notification"}),J=Object(X.a)($,2),H=J[0],ee=J[1],ne=Object(i.c)((function(e){return e.users.currentUser})),re=Object(i.b)(),ce=Object(a.useRef)(),oe=Object(a.useRef)();function le(){return(le=Object(Q.a)(K.a.mark((function e(){var t,n,a,s,c,i;return K.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=null===r||void 0===r?void 0:r.participants.map((function(e){return e.userName})),n=D.map((function(e){return e.userName})),a=[],s=[],c=[],D.forEach((function(e){t.some((function(t){return t===e.userName}))||a.push(e.fullName)})),null===r||void 0===r||r.participants.forEach((function(e){n.some((function(t){return t===e.userName}))||(s.push(e.fullName),c.push(e.userName))})),!(s.length>0)){e.next=25;break}if(i="",!c.some((function(e){return e===ne.userName}))){e.next=19;break}if(1!==s.length){e.next=16;break}return je(i="Do you want to leave this group?"),e.abrupt("return",Object(W.jsx)(W.Fragment,{}));case 16:i="Do you want to leave this group and remove ";case 17:e.next=20;break;case 19:i="Do you want to remove ";case 20:s.forEach((function(e,t){c[t]!==ne.userName&&(i+="'".concat(e,"'"),t!==s.length-1&&(i+=", "))})),je(i+=" from this chat?"),e.next=27;break;case 25:return e.next=27,de();case 27:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function de(){return ue.apply(this,arguments)}function ue(){return(ue=Object(Q.a)(K.a.mark((function e(){var t,n,a,s,c;return K.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=null===r||void 0===r?void 0:r.participants.map((function(e){return e.userName})),n=D.map((function(e){return e.userName})),a=[],s=[],n.forEach((function(e){t.includes(e)||a.push(e)})),t.forEach((function(e){n.includes(e)||s.push(e)})),c={newGroupName:x,participantUserNamesToAdd:a,participantUserNamesToRemove:s},Y.updateGroupChat(null===r||void 0===r?void 0:r.id,c).then(function(){var e=Object(Q.a)(K.a.mark((function e(t){return K.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!k){e.next=3;break}return e.next=3,me();case 3:fe("Success","Update info successfully!");case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),s.some((function(e){return e===ne.userName}))&&re(w(0)),pe();case 11:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function me(e){return be.apply(this,arguments)}function be(){return(be=Object(Q.a)(K.a.mark((function e(t){var n;return K.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(n=new FormData).append("Avatar",k),e.next=4,Y.updateGroupAvatar(null===r||void 0===r?void 0:r.id,n);case 4:C(!1);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function fe(e,t){ee({isOpen:!0,title:e,content:t})}function je(e){l(!0),b(e)}function pe(){l(!1),b("")}return Object(a.useEffect)((function(){E(!!(null===x||void 0===x?void 0:x.trim()))}),[x]),Object(a.useEffect)((function(){var e=function(e){t&&ce.current&&!ce.current.contains(e.target)&&n(!1)};return document.addEventListener("mousedown",e),function(){document.removeEventListener("mousedown",e)}}),[t]),Object(a.useEffect)((function(){var e=function(e){R&&oe.current&&!oe.current.contains(e.target)&&P(!1)};return document.addEventListener("mousedown",e),function(){document.removeEventListener("mousedown",e)}}),[R]),Object(a.useEffect)((function(){Z.getUserList().then((function(e){var t;e&&z(null!==(t=e.items)&&void 0!==t?t:e)}))}),[]),Object(a.useEffect)((function(){G(null===r||void 0===r?void 0:r.participants),p(null===r||void 0===r?void 0:r.name)}),[r]),t?Object(W.jsx)("div",{className:"animate-fadeIn fixed inset-0 grid place-items-center h-screen w-screen px-4 py-10 z-30 bg-gray-500 bg-opacity-30 dark:bg-dark-primary dark:bg-opacity-50",children:Object(W.jsxs)("div",{ref:ce,className:"px-6 md:px-14 md:py-6 flex flex-col bg-white dark:bg-dark-secondary dark:border-dark-third rounded-xl shadow-xl border border-gray-300 w-full md:w-5/6 lg:w-2/5 transition-all duration-300 max-h-full overflow-y-auto "+(R?"mb-16":""),children:[Object(W.jsx)(_,{title:H.title,isOpen:H.isOpen,content:H.content,onClick:function(){return ee({isOpen:!1})}}),Object(W.jsx)(Re,{isOpen:o,closeAction:function(){return l(!1)},title:"Are you sure?",content:m,confirmButtonTitle:"Yes",confirmButtonAction:de}),Object(W.jsx)("div",{className:"flex pt-6 pb-5 h-full",children:Object(W.jsx)("h3",{className:"font-semibold text-lg md:text-2xl text-green-600 dark:text-green-400",children:"Chat info!"})}),Object(W.jsx)("div",{className:"space-y-2 md:space-y-4",children:(null===r||void 0===r?void 0:r.type)===ie?Object(W.jsxs)(W.Fragment,{children:[Object(W.jsxs)("div",{className:"space-y-2",children:[Object(W.jsxs)("label",{htmlFor:"groupName",className:"font-semibold dark:text-dark-txt text-base md:text-lg",children:["Group name ",Object(W.jsx)("span",{className:"text-red-500",children:"*"})]}),Object(W.jsx)("input",{id:"groupName",value:x,onChange:function(e){return p(e.target.value)},type:"text",className:"dark:bg-dark-third bg-gray-100 rounded-lg w-full py-2 px-3 focus:ring-2 focus:ring-green-500 focus:ring-opacity-50 outline-none transition-all duration-200 mb-2 "})]}),Object(W.jsxs)("div",{ref:oe,className:"space-y-2",children:[Object(W.jsx)("label",{htmlFor:"search",className:"font-semibold dark:text-dark-txt text-base md:text-lg",children:"Add Members"}),Object(W.jsxs)("div",{className:"relative",children:[Object(W.jsx)("input",{id:"search",type:"search",onFocus:function(){return P(!0)},value:h,autoComplete:"off",onChange:function(e){return O(e.target.value)},className:"dark:bg-dark-third bg-gray-100 rounded-lg w-full py-2 px-3 focus:ring-2 focus:ring-green-500 focus:ring-opacity-50 outline-none transition-all duration-200 mb-2 "}),R&&Object(W.jsx)(W.Fragment,{children:Object(W.jsxs)("div",{className:"animate-fadeIn absolute top-full bg-white dark:bg-dark-third border border-gray-400 border-opacity-50 rounded-lg w-full md:py-4 py-2 md:px-8 px-6 space-y-1 max-h-48 md:max-h-72 overflow-y-auto select-none z-10 shadow-2xl ",children:[Object(W.jsx)("h4",{className:"font-semibold dark:text-gray-200 mb-2",children:"Friend list"}),A.filter((function(e){var t,n;return((null===(t=e.fullName)||void 0===t?void 0:t.toLowerCase().includes(null===h||void 0===h?void 0:h.toLowerCase()))||(null===(n=e.userName)||void 0===n?void 0:n.toLowerCase().includes(null===h||void 0===h?void 0:h.toLowerCase())))&&!D.some((function(t){return t.userName===e.userName}))})).sort((function(e,t){return e.fullName.localeCompare(t.fullName)})).map((function(e,t){var n,a;return Object(W.jsxs)("div",{onClick:function(){var t=Object(te.a)(D);t.some((function(t){return t.userName===e.userName}))||(t.push(e),G(t))},className:"h-full w-full rounded-lg px-3 py-2 flex items-center space-x-2  dark:bg-dark-hover bg-gray-100 hover:bg-green-200 dark:hover:bg-green-600 cursor-pointer transform active:scale-100 hover:scale-105 hover:shadow-xl transition-all duration-300",children:[Object(W.jsx)(ae,{size:"xs",src:e.avatarUrl,userName:null===e||void 0===e?void 0:e.userName}),Object(W.jsx)("span",{className:"break-full w-full overflow-ellipsis truncate md:text-base text-sm",children:null!==(a=e.fullName)&&void 0!==a?a:se})]},null!==(n=null===e||void 0===e?void 0:e.id)&&void 0!==n?n:"friend"+t)}))]})})]})]}),Object(W.jsxs)("div",{className:"space-y-2",children:[Object(W.jsxs)("label",{htmlFor:"search",className:"font-semibold text-base md:text-lg dark:text-dark-txt",children:["Members ",Object(W.jsx)("span",{className:"text-red-500",children:"*"})," ",Object(W.jsx)("span",{className:"text-sm text-gray-400",children:"(Click to remove)"})]}),Object(W.jsx)("div",{className:"bg-white border dark:bg-dark-third dark:border-dark-third border-gray-400 border-opacity-50 rounded-lg w-full py-4 md:px-8 px-6 space-y-1 max-h-48 md:max-h-72 overflow-y-auto select-none",children:Object(te.a)(D).sort((function(e,t){return e.fullName.localeCompare(t.fullName)})).map((function(e,t){var n,a;return Object(W.jsxs)("div",{onClick:function(){var t=Object(te.a)(D),n=t.findIndex((function(t){return t.userName===e.userName}));n>=0&&(t.splice(n,1),G(t))},className:"h-full w-full rounded-lg px-3 py-2 flex items-center space-x-2 dark:hover:bg-red-500 dark:bg-dark-hover bg-gray-100 hover:bg-red-200 cursor-pointer transform active:scale-100 hover:scale-105 hover:shadow-xl transition-all duration-300",children:[Object(W.jsx)(ae,{size:"xs",src:e.avatarUrl,userName:null===e||void 0===e?void 0:e.userName}),Object(W.jsx)("span",{className:"break-full w-full overflow-ellipsis truncate md:text-base text-sm",children:null!==(a=e.fullName)&&void 0!==a?a:se})]},null!==(n=null===e||void 0===e?void 0:e.id)&&void 0!==n?n:"friend"+t)}))})]}),Object(W.jsxs)("div",{className:"space-y-2 mr-2 flex flex-col",children:[Object(W.jsx)("label",{htmlFor:"avatar",className:"dark:text-dark-txt text-base md:text-lg font-semibold ",children:"Group Avatar"}),Object(W.jsx)("input",{id:"avatar",onChange:function(e){return C(e.target.files[0])},type:"file",className:"w-full",accept:"image/png, image/jpg, image/tiff, image/tif, image/jpeg"})]})]}):Object(W.jsxs)("div",{ref:oe,className:"space-y-2",children:[Object(W.jsxs)("div",{className:"font-bold dark:text-dark-txt",children:["Creator:"," ",Object(W.jsx)("span",{className:"font-normal",children:null===r||void 0===r?void 0:r.creatorFullName})]}),Object(W.jsxs)("div",{className:"font-bold dark:text-dark-txt",children:["Created at:"," ",Object(W.jsx)("span",{className:"font-normal",children:xe(null===r||void 0===r?void 0:r.dateCreated)})]}),Object(W.jsxs)("div",{className:"font-bold dark:text-dark-txt",children:["Total messages:"," ",Object(W.jsx)("span",{className:"font-normal",children:null===r||void 0===r?void 0:r.totalRecords})]})]})}),Object(W.jsx)("div",{className:"flex justify-end py-6 space-x-4",children:Object(W.jsxs)("div",{className:"space-x-2 flex items-center",children:[Object(W.jsx)(V,{outline:!0,content:"Close",onClick:function(){return n(!1)}}),(null===r||void 0===r?void 0:r.type)===ie?Object(W.jsx)(V,{disabled:!I,content:"Save",onClick:function(){return function(){return le.apply(this,arguments)}()}}):""]})})]})}):""};var Ge=function(e){var t,n,r=e.chat,s=Object(i.b)(),c=Object(i.c)((function(e){return e.users.currentUser})),o=Me(),l=Object(a.useState)([]),d=Object(X.a)(l,2),u=d[0],m=d[1],b=Object(a.useState)(!1),f=Object(X.a)(b,2),j=f[0],x=f[1],p=Object(a.useState)({}),g=Object(X.a)(p,2),O=g[0],N=g[1],y=Object(a.useState)(""),k=Object(X.a)(y,2),C=k[0],S=k[1];function U(e){var t=Object(te.a)(u);t.findIndex((function(t){return t===e}))>=0?t=t.filter((function(t){return t!==e})):t.push(e),m(t)}var I=Object(a.useState)(1),E=Object(X.a)(I,2),F=E[0],L=E[1],A=function(e,t){var n=Object(a.useState)(!1),r=Object(X.a)(n,2),s=r[0],c=r[1],i=Object(a.useState)(""),o=Object(X.a)(i,2),l=o[0],d=o[1],u=Object(a.useState)({}),m=Object(X.a)(u,2),b=m[0],f=m[1],j=Object(a.useState)(!1),x=Object(X.a)(j,2),p=x[0],v=x[1],g=Me();return Object(a.useEffect)((function(){if(t>1&&p){c(!0),d(!1);var n={page:t};g.getById(e.id,n).then((function(e){f(e),v(t<e.pageCount),c(!1)})).catch((function(e){d(e)}))}}),[t]),Object(a.useEffect)((function(){v(t<(null===e||void 0===e?void 0:e.pageCount))}),[e]),{loading:s,error:l,appendChat:b,hasMore:p}}(r,F),z=A.appendChat,M=A.hasMore,B=A.loading,R=A.error,P=Object(a.useRef)();return Object(a.useEffect)((function(){if((null===r||void 0===r?void 0:r.numOfUnreadMessages)>0&&o.readChat(null===r||void 0===r?void 0:r.id).then((function(e){s(h(null===r||void 0===r?void 0:r.id))})),(null===r||void 0===r?void 0:r.participants.length)>0){var e,t,n=null===r||void 0===r||null===(e=r.participants)||void 0===e?void 0:e.filter((function(e){return e.userName!==(null===c||void 0===c?void 0:c.userName)})).shift();if(N(null!==n&&void 0!==n?n:c),(null===r||void 0===r||null===(t=r.readByUserNames)||void 0===t?void 0:t.length)>1){var a,i,l="",d=null===r||void 0===r||null===(a=r.readByUserNames)||void 0===a||null===(i=a.filter((function(e){return e!==(null===c||void 0===c?void 0:c.userName)})))||void 0===i?void 0:i.map((function(e){var t,n;return null===(t=r.participants.filter((function(t){return t.userName===e})))||void 0===t||null===(n=t.shift())||void 0===n?void 0:n.firstName}));(null===d||void 0===d?void 0:d.length)>1?(l="Seen by "+d.filter((function(e){return e})).join(", "),S(l)):S("")}}}),[r]),Object(a.useEffect)((function(){s(v(z))}),[z]),Object(a.useEffect)((function(){(null===r||void 0===r?void 0:r.page)<2&&function(){var e;P&&(null===P||void 0===P||null===(e=P.current)||void 0===e||e.scrollIntoView())}()}),[r]),Object(W.jsxs)(W.Fragment,{children:[Object(W.jsx)(De,{isOpen:j,setIsOpen:x,chat:r}),Object(W.jsxs)("div",{className:"flex flex-col w-full h-full pb-4 flex-shrink-0 min-w-0",children:[Object(W.jsxs)("div",{className:"w-full border-b border-gray-300 dark:border-dark-third flex justify-between items-center md:p-3 md:px-4 p-2 px-3 flex-shrink-0 overflow-hidden",children:[Object(W.jsxs)("div",{className:"flex min-w-0 justify-start items-center space-x-3",children:[Object(W.jsx)("img",{src:Ne,alt:"Arrow icon",className:"h-5 w-5 md:hidden cursor-pointer",onClick:function(){var e=w(0);s(e)}}),Object(W.jsx)(ae,{src:""!==(null===r||void 0===r?void 0:r.groupAvatarUrl)?null===r||void 0===r?void 0:r.groupAvatarUrl:null===O||void 0===O?void 0:O.avatarUrl,participants:null===r||void 0===r?void 0:r.participants}),Object(W.jsx)("span",{className:"text-lg font-semibold dark:text-dark-txt truncate overflow-hidden",children:(null===r||void 0===r?void 0:r.type)===ce?null===O||void 0===O?void 0:O.fullName:null!==(t=null===r||void 0===r?void 0:r.name)&&void 0!==t?t:re})]}),Object(W.jsx)(Ce,{className:"h-10 w-10 p-2 mr-2",icon:Oe,onClick:function(){return x(!j)}})]}),(null===r||void 0===r?void 0:r.messages)&&Object(W.jsxs)("div",{className:"flex-grow overflow-y-auto overflow-x-hidden px-4 pb-4 pt-2 space-y-1 flex flex-col min-w-0",children:[B&&Object(W.jsx)("div",{className:"text-gray-500 text-center my-2",children:"Loading..."}),M&&!B&&Object(W.jsx)("div",{className:"flex",children:Object(W.jsx)("button",{className:"mx-auto px-4 bg-gray-200 py-2 rounded-lg transform active:scale-95 hover:bg-gray-300 dark:hover:bg-dark-hover dark:bg-dark-third dark:text-gray-300 text-xs md:text-sm transition-all duration-200",onClick:function(){F<(null===r||void 0===r?void 0:r.pageCount)&&L((function(e){return e+1}))},children:"Load more messages..."})}),!M&&Object(W.jsx)("div",{className:"text-gray-500 text-xs md:text-sm text-center mb-2",children:xe(null===r||void 0===r?void 0:r.dateCreated)}),Object(W.jsx)("div",{children:R?"Error":""}),null===(n=Object(te.a)(null===r||void 0===r?void 0:r.messages))||void 0===n?void 0:n.sort((function(e,t){return(null===e||void 0===e?void 0:e.dateCreated)>(null===t||void 0===t?void 0:t.dateCreated)?1:-1})).map((function(e,t){var n,a,s,i,o,l,d;return e.senderUserName===c.userName?Object(W.jsxs)("div",{className:"flex-shrink-0",children:[Object(W.jsxs)("div",{className:"flex-shrink-0 flex flex-col items-end w-full",children:[u.includes(t)&&Object(W.jsx)("span",{className:"transition-all animate-fadeIn text-xs md:text-sm text-gray-400 left-0 bottom-full mb-1 ml-1 space-x-2 md:w-80 w-60 truncate overflow-ellipsis text-right",children:null!==(a=xe(e.dateCreated))&&void 0!==a?a:""}),e.imageUrl?Object(W.jsx)("img",{onClick:function(){return U(t)},className:"md:max-w-300 max-w-200 rounded-lg shadow transition-all duration-200 cursor-pointer",src:e.imageUrl,alt:"Message"}):Object(W.jsx)("span",{onClick:function(){return U(t)},className:"text-white rounded-3xl md:px-5 md:py-3 px-3 py-2 break-word rounded-br-none cursor-pointer overflow-x-auto max-w-3/4 text-sm md:text-base "+(u.includes(t)?"bg-green-600 dark:bg-green-800":"bg-gradient-to-br from-green-400 to-green-600 dark:from-green-500 dark:to-green-800 shadow-md"),children:e.content})]}),(null===r||void 0===r?void 0:r.type)===ce&&(null===r||void 0===r||null===(s=r.messages)||void 0===s?void 0:s.length)===t+1&&Object(W.jsx)(W.Fragment,{children:Object(W.jsx)("div",{className:"text-xs font-semibold text-right text-gray-600 dark:text-dark-txt mr-2 select-none",children:(null===r||void 0===r||null===(i=r.readByUserNames)||void 0===i?void 0:i.includes(null===O||void 0===O?void 0:O.userName))?"Seen":""})})]},null!==(n=e.id)&&void 0!==n?n:"message"+t):Object(W.jsxs)("div",{className:"flex-shrink-0 flex items-end space-x-2",children:[Object(W.jsx)(ae,{src:null===r||void 0===r||null===(l=r.participants.filter((function(t){return t.userName===e.senderUserName})).shift())||void 0===l?void 0:l.avatarUrl,size:"sm",userName:e.senderUserName}),Object(W.jsxs)("div",{className:"flex flex-col w-full items-start",children:[u.includes(t)&&Object(W.jsx)("span",{className:"transition-all animate-fadeIn text-xs md:text-sm text-gray-400 bottom-full mb-1 ml-1 space-x-2 md:w-80 w-60 truncate overflow-ellipsis text-left",children:null!==(d=e.senderFullName+" - "+xe(e.dateCreated))&&void 0!==d?d:""}),e.imageUrl?Object(W.jsx)("img",{onClick:function(){return U(t)},className:"md:max-w-300 max-w-200 rounded-lg shadow cursor-pointer",src:e.imageUrl,alt:"Message"}):Object(W.jsx)("span",{className:" rounded-3xl md:px-5 md:py-3 px-3 py-2 break-word rounded-bl-none shadow-sm cursor-pointer overflow-x-auto max-w-3/4 text-sm md:text-base "+(u.includes(t)?"bg-gray-300 dark:bg-dark-third":"bg-gradient-to-br from-gray-100 to-gray-300 dark:from-gray-500 dark:to-gray-600 "),onClick:function(){return U(t)},children:e.content})]})]},null!==(o=e.id)&&void 0!==o?o:"message"+t)})),(null===r||void 0===r?void 0:r.type)===ie&&Object(W.jsx)(W.Fragment,{children:Object(W.jsx)("div",{className:"text-xs font-semibold text-right text-gray-600 dark:text-dark-txt mr-2 select-none",children:C})}),Object(W.jsx)("div",{ref:P})]}),Object(W.jsx)(Be,{chatId:null===r||void 0===r?void 0:r.id})]})]})};var Ye=function(e){var t,n,r,s,c=e.isOpen,o=e.setIsOpen,l=Object(a.useState)(ce),d=Object(X.a)(l,2),u=d[0],m=d[1],b=Object(a.useState)(!1),f=Object(X.a)(b,2),j=f[0],x=f[1],p=Object(a.useState)(!1),v=Object(X.a)(p,2),g=v[0],h=v[1],O=Object(a.useState)(""),N=Object(X.a)(O,2),y=N[0],k=N[1],C=Object(a.useState)(""),S=Object(X.a)(C,2),U=S[0],I=S[1],E=Object(a.useState)([]),F=Object(X.a)(E,2),L=F[0],A=F[1],z=Object(a.useState)([]),M=Object(X.a)(z,2),B=M[0],R=M[1],P=Object(a.useRef)(),T=Object(a.useRef)(),q=Object(i.b)(),D=Me(),G=qe();function Y(){return(Y=Object(Q.a)(K.a.mark((function e(){var t,n;return K.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:g&&(u===ie?(t={participantUserNames:B.map((function(e){return e.userName})),name:y},D.createGroupChat(t).then((function(e){e.id&&q(w(e.id)),R([]),k(""),o(!1)}))):u===ce&&(n={participantUserName:B.map((function(e){return e.userName})).shift()},D.createPrivateChat(n).then((function(e){e.id&&q(w(e.id)),R([]),k(""),o(!1)}))));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(a.useEffect)((function(){var e=function(e){c&&P.current&&!P.current.contains(e.target)&&o(!1)};return document.addEventListener("mousedown",e),function(){document.removeEventListener("mousedown",e)}}),[c]),Object(a.useEffect)((function(){var e=function(e){j&&T.current&&!T.current.contains(e.target)&&x(!1)};return document.addEventListener("mousedown",e),function(){document.removeEventListener("mousedown",e)}}),[j]),Object(a.useEffect)((function(){return G.getUserList().then((function(e){var t;e&&A(null!==(t=e.items)&&void 0!==t?t:e)})),function(){R([]),k("")}}),[]),Object(a.useEffect)((function(){if(u===ie){var e=(null===B||void 0===B?void 0:B.length)>=2&&(null===y||void 0===y?void 0:y.trim());h(e)}else u===ce&&h(0!==(null===B||void 0===B?void 0:B.length))}),[B,y,u]),c?Object(W.jsx)("div",{className:"animate-fadeIn fixed inset-0 grid place-items-center h-screen w-screen px-4 py-10  z-30 bg-gray-500 bg-opacity-30 dark:bg-dark-primary dark:bg-opacity-50",children:Object(W.jsxs)("div",{ref:P,className:"px-6 md:px-14 md:py-6 flex flex-col bg-white dark:bg-dark-secondary dark:border-dark-third rounded-xl shadow-xl border border-gray-300 w-full md:w-5/6 lg:w-2/5 transition-all duration-300 max-h-full overflow-y-auto md:overflow-visible "+(j?"mb-16":""),children:[Object(W.jsxs)("div",{className:"flex pt-6 pb-5 justify-between h-full items-center",children:[Object(W.jsx)("h3",{className:"font-semibold text-lg md:text-2xl text-green-600 dark:text-green-400",children:"New chat!"}),Object(W.jsxs)("div",{className:"relative flex rounded-lg items-center border border-green-500 cursor-pointer overflow-hidden",children:[Object(W.jsx)("div",{className:"absolute bg-gradient-to-br from-green-400 to-green-600 w-1/2 h-full rounded transition-all duration-200 z-0 "+(u===ie?"transform translate-x-full left-0":"left-0 ")}),Object(W.jsx)("span",{className:" px-3 py-2 z-10 text-xs md:text-sm select-none  "+(u===ce?"text-white":" text-green-600 dark:text-green-400"),onClick:function(){return m(ce)},children:"Private"}),Object(W.jsx)("span",{className:" px-3 py-2 z-10 text-xs md:text-sm select-none  "+(u===ie?"text-white":" text-green-600 dark:text-green-400"),onClick:function(){return m(ie)},children:"Group"})]})]}),Object(W.jsx)("div",{className:"space-y-2 md:space-y-4",children:u===ie?Object(W.jsxs)(W.Fragment,{children:[Object(W.jsxs)("div",{className:"space-y-2",children:[Object(W.jsxs)("label",{htmlFor:"groupName",className:"font-semibold text-base md:text-lg dark:text-gray-200",children:["Group name ",Object(W.jsx)("span",{className:"text-red-500",children:"*"})]}),Object(W.jsx)("input",{id:"groupName",value:y,onChange:function(e){return k(e.target.value)},type:"text",className:"dark:bg-dark-third bg-gray-100 rounded-lg w-full py-2 px-3 focus:ring-2 focus:ring-green-500 focus:ring-opacity-50 outline-none transition-all duration-200 mb-2 "})]}),Object(W.jsxs)("div",{ref:T,className:"space-y-2",children:[Object(W.jsx)("label",{htmlFor:"search",className:"font-semibold text-base md:text-lg dark:text-gray-200",children:"Find Friends"}),Object(W.jsxs)("div",{className:"relative",children:[Object(W.jsx)("input",{id:"search",type:"search",onFocus:function(){return x(!0)},value:U,autoComplete:"off",onChange:function(e){return I(e.target.value)},className:"dark:bg-dark-third bg-gray-100 rounded-lg w-full py-2 px-3 focus:ring-2 focus:ring-green-500 focus:ring-opacity-50 outline-none transition-all duration-200 mb-2 "}),j&&Object(W.jsx)(W.Fragment,{children:Object(W.jsxs)("div",{className:"animate-fadeIn absolute top-full bg-white dark:bg-dark-secondary dark:border-dark-hover border border-gray-300 border-opacity-50 rounded-lg w-full py-2 md:py-4 md:px-8 px-6 space-y-1 max-h-36 md:max-h-72 overflow-y-auto select-none z-10 shadow-2xl",children:[Object(W.jsx)("h4",{className:"font-semibold mb-2 dark:text-gray-200",children:"Friend list"}),null===L||void 0===L||null===(t=L.filter((function(e){var t,n;return((null===(t=e.fullName)||void 0===t?void 0:t.toLowerCase().includes(null===U||void 0===U?void 0:U.toLowerCase()))||(null===(n=e.userName)||void 0===n?void 0:n.toLowerCase().includes(null===U||void 0===U?void 0:U.toLowerCase())))&&!B.some((function(t){return t.userName===e.userName}))})))||void 0===t||null===(n=t.sort((function(e,t){return e.fullName.localeCompare(t.fullName)})))||void 0===n?void 0:n.map((function(e,t){var n,a;return Object(W.jsxs)("div",{onClick:function(){var t=Object(te.a)(B);t.some((function(t){return t.userName===e.userName}))||(t.push(e),R(t))},className:"h-full w-full rounded-lg px-3 py-2 flex items-center space-x-2  dark:bg-dark-third bg-gray-100 hover:bg-green-200 dark:hover:bg-green-600 cursor-pointer transform active:scale-100 hover:scale-105 hover:shadow-xl transition-all duration-300",children:[Object(W.jsx)(ae,{size:"xs",src:e.avatarUrl,userName:null===e||void 0===e?void 0:e.userName}),Object(W.jsx)("span",{className:"break-full w-full overflow-ellipsis truncate md:text-base text-sm",children:null!==(a=e.fullName)&&void 0!==a?a:se})]},null!==(n=null===e||void 0===e?void 0:e.id)&&void 0!==n?n:"friend"+t)}))]})})]})]}),Object(W.jsxs)("div",{className:"space-y-2",children:[Object(W.jsxs)("label",{htmlFor:"search",className:"font-semibold text-base md:text-lg dark:text-gray-200",children:["Selected ",Object(W.jsx)("span",{className:"text-red-500",children:"*"})," ",Object(W.jsx)("span",{className:"text-sm text-gray-400",children:"(At least 2 people. Click to remove)"})]}),Object(W.jsx)("div",{className:"bg-white dark:bg-dark-secondary border dark:border-dark-hover border-gray-400 border-opacity-50 rounded-lg w-full py-4 md:px-8 px-6 space-y-1 max-h-48 md:max-h-72 overflow-y-auto select-none",children:B.sort((function(e,t){return e.fullName.localeCompare(t.fullName)})).map((function(e,t){var n,a;return Object(W.jsxs)("div",{onClick:function(){var t=Object(te.a)(B),n=t.findIndex((function(t){return t.userName===e.userName}));n>=0&&(t.splice(n,1),R(t))},className:"h-full w-full rounded-lg px-3 py-2 flex items-center space-x-2  dark:bg-dark-third bg-gray-100 hover:bg-red-200 dark:hover:bg-red-500 cursor-pointer transform active:scale-100 hover:scale-105 hover:shadow-xl transition-all duration-300",children:[Object(W.jsx)(ae,{size:"xs",src:e.avatarUrl,userName:null===e||void 0===e?void 0:e.userName}),Object(W.jsx)("span",{className:"break-full w-full overflow-ellipsis truncate md:text-base text-sm",children:null!==(a=e.fullName)&&void 0!==a?a:se})]},null!==(n=null===e||void 0===e?void 0:e.id)&&void 0!==n?n:"friend"+t)}))})]})]}):Object(W.jsxs)("div",{ref:T,className:"space-y-2",children:[Object(W.jsx)("label",{htmlFor:"selectFriend",className:"font-semibold md:text-lg dark:text-gray-200",children:"Select Friend"}),Object(W.jsxs)("div",{className:"relative",children:[Object(W.jsx)("input",{id:"selectFriend",type:"search",onFocus:function(){return x(!0)},value:U,autoComplete:"off",onChange:function(e){return I(e.target.value)},className:"dark:bg-dark-third bg-gray-100 rounded-lg w-full py-2 px-3 focus:ring-2 focus:ring-green-500 focus:ring-opacity-50 outline-none transition-all duration-200 mb-2 "}),j&&Object(W.jsx)(W.Fragment,{children:Object(W.jsxs)("div",{className:"animate-fadeIn absolute top-full bg-white dark:bg-dark-secondary border border-gray-400 border-opacity-50 rounded-lg w-full space-y-1 max-h-36 md:max-h-72 overflow-y-auto select-none z-10 shadow-2xl py-2 md:py-4 md:px-8 px-6",children:[Object(W.jsx)("h4",{className:"font-semibold mb-2 text-start dark:text-gray-200",children:"Friend list"}),null===L||void 0===L||null===(r=L.sort((function(e,t){return e.fullName.localeCompare(t.fullName)})))||void 0===r||null===(s=r.filter((function(e){var t,n;return((null===(t=e.fullName)||void 0===t?void 0:t.toLowerCase().includes(null===U||void 0===U?void 0:U.toLowerCase()))||(null===(n=e.userName)||void 0===n?void 0:n.toLowerCase().includes(null===U||void 0===U?void 0:U.toLowerCase())))&&!B.some((function(t){return t.userName===e.userName}))})))||void 0===s?void 0:s.map((function(e,t){var n,a;return Object(W.jsxs)("div",{onClick:function(){var t=[];t.push(e),x(!1),R(t)},className:"h-full w-full rounded-lg px-3 py-2 flex items-center space-x-2  dark:bg-dark-third bg-gray-100 hover:bg-green-200 dark:hover:bg-green-600 cursor-pointer transform active:scale-100 hover:scale-105 hover:shadow-xl transition-all duration-300",children:[Object(W.jsx)(ae,{size:"xs",src:e.avatarUrl,userName:null===e||void 0===e?void 0:e.userName}),Object(W.jsx)("span",{className:"break-full w-full overflow-ellipsis truncate text-sm md:text-base",children:null!==(a=e.fullName)&&void 0!==a?a:se})]},null!==(n=null===e||void 0===e?void 0:e.id)&&void 0!==n?n:"friend"+t)}))]})})]}),Object(W.jsxs)("div",{className:"space-y-2",children:[Object(W.jsxs)("label",{htmlFor:"search",className:"font-semibold md:text-lg dark:text-gray-200",children:["Selected ",Object(W.jsx)("span",{className:"text-red-500",children:"*"})," ",Object(W.jsx)("span",{className:"text-sm text-gray-400",children:"(Click to remove)"})]}),Object(W.jsx)("div",{className:"bg-white dark:bg-dark-secondary border dark:border-dark-hover border-gray-400 border-opacity-50 rounded-lg w-full py-4 md:px-8 px-6 space-y-1 max-h-48 md:max-h-72 overflow-y-auto select-none ",children:Object(te.a)(B).map((function(e,t){var n,a;return 0===t?Object(W.jsxs)("div",{onClick:function(){var t=Object(te.a)(B),n=t.findIndex((function(t){return t.userName===e.userName}));n>=0&&(t.splice(n,1),R(t))},className:"h-full w-full rounded-lg px-3 py-2 flex items-center space-x-2  dark:bg-dark-third bg-gray-100 hover:bg-red-200 cursor-pointer transform active:scale-100 hover:scale-105 hover:shadow-xl transition-all duration-300 dark:hover:bg-red-500",children:[Object(W.jsx)(ae,{size:"xs",src:e.avatarUrl,userName:null===e||void 0===e?void 0:e.userName}),Object(W.jsx)("span",{className:"break-full w-full overflow-ellipsis truncate md:text-base text-sm",children:null!==(a=e.fullName)&&void 0!==a?a:se})]},null!==(n=null===e||void 0===e?void 0:e.id)&&void 0!==n?n:"friend"+t):Object(W.jsx)(W.Fragment,{})}))})]})]})}),Object(W.jsx)("div",{className:"flex justify-end py-6 space-x-4",children:Object(W.jsxs)("div",{className:"space-x-2 flex items-center",children:[Object(W.jsx)(V,{outline:!0,content:"Close",onClick:function(){return o(!1)}}),Object(W.jsx)(V,{disabled:!g,content:"Create",onClick:function(){return function(){return Y.apply(this,arguments)}()}})]})})]})}):""};var Ze=function(e){var t=e.isOpen,n=e.setIsOpen,r=e.currentUser,s=Object(a.useState)(""),c=Object(X.a)(s,2),o=c[0],l=c[1],d=Object(a.useState)(""),u=Object(X.a)(d,2),m=u[0],b=u[1],f=Object(a.useState)({}),j=Object(X.a)(f,2),x=j[0],p=j[1],v=qe(),g=Object(a.useRef)(),h=Object(i.b)();function O(){return(O=Object(Q.a)(K.a.mark((function e(){var t;return K.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:(t=new FormData).append("File",x),v.updateAvatar(t).then((function(e){v.updateInformation({firstName:o,lastName:m,aboutMe:r.aboutMe,phoneNumber:r.phoneNumber}).then((function(e){h(R(e)),N("Success","Update info successfully!")}))})),n(!1);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function N(e,t){h(I({isOpen:!0,title:e,content:t}))}return Object(a.useEffect)((function(){var e=function(e){t&&g.current&&!g.current.contains(e.target)&&n(!1)};return document.addEventListener("mousedown",e),function(){document.removeEventListener("mousedown",e)}}),[t]),Object(a.useEffect)((function(){r.firstName&&r.lastName&&(l(r.firstName),b(r.lastName))}),[r]),t?Object(W.jsx)("div",{className:"animate-fadeIn fixed inset-0 grid place-items-center h-screen w-screen px-4 py-10  z-30 bg-gray-500 bg-opacity-30 dark:bg-dark-primary dark:bg-opacity-50",children:Object(W.jsxs)("div",{ref:g,className:"w-full md:w-5/6 lg:w-2/5 md:px-14 px-6 md:py-6 flex flex-col dark:bg-dark-secondary dark:border-dark-third bg-white rounded-xl shadow-xl border border-gray-300 transition-all duration-300",children:[Object(W.jsx)("h3",{className:"pt-6 pb-5 font-semibold text-lg md:text-2xl text-green-600 dark:text-green-400",children:"User info!"}),Object(W.jsxs)("div",{className:"space-y-4",children:[Object(W.jsxs)("div",{className:"mb-3 flex flex-col md:grid md:grid-cols-2 md:place-items-start space-y-4 md:space-y-0",children:[Object(W.jsxs)("div",{className:"md:col-span-1 md:mr-2 space-y-2",children:[Object(W.jsxs)("label",{htmlFor:"fistName",className:"md:text-lg font-semibold dark:text-dark-txt",children:["First Name ",Object(W.jsx)("span",{className:"text-red-500",children:"*"})]}),Object(W.jsx)("input",{id:"firstName",value:o,onChange:function(e){return l(e.target.value)},type:"text",className:"bg-gray-100 dark:bg-dark-third rounded-lg w-full py-2 px-3 focus:ring-2 focus:ring-green-500 focus:ring-opacity-50 outline-none transition-all duration-200"})]}),Object(W.jsxs)("div",{className:"md:col-span-1 md:ml-2 space-y-2",children:[Object(W.jsxs)("label",{htmlFor:"lastName",className:"md:text-lg font-semibold dark:text-dark-txt",children:["Last Name ",Object(W.jsx)("span",{className:"text-red-500",children:"*"})]}),Object(W.jsx)("input",{id:"lastName",value:m,onChange:function(e){return b(e.target.value)},type:"text",className:"bg-gray-100 dark:bg-dark-third rounded-lg w-full py-2 px-3 focus:ring-2 focus:ring-green-500 focus:ring-opacity-50 outline-none transition-all duration-200 mb-2"})]}),Object(W.jsxs)("div",{className:"space-y-2 flex flex-col",children:[Object(W.jsx)("label",{htmlFor:"avatar",className:"md:text-lg font-semibold md:mt-4 dark:text-dark-txt",children:"Avatar"}),Object(W.jsx)("input",{id:"avatar",onChange:function(e){return p(e.target.files[0])},type:"file",className:"w-full",accept:"image/png, image/jpg, image/tiff, image/tif, image/jpeg"})]})]}),Object(W.jsxs)("div",{className:"flex justify-end space-x-2 items-center py-6",children:[Object(W.jsx)(V,{outline:!0,content:"Close",onClick:function(){return n(!1)}}),Object(W.jsx)(V,{content:"Save",onClick:function(){return function(){return O.apply(this,arguments)}()}})]})]})]})}):""};var $e=function(){var e=Object(a.useState)(!1),t=Object(X.a)(e,2),n=t[0],r=t[1];return Object(a.useEffect)((function(){"dark"===window.localStorage.getItem("theme")&&(window.document.documentElement.classList.add("dark"),r(!0))}),[]),Object(a.useEffect)((function(){n?(window.document.documentElement.classList.add("dark"),window.localStorage.setItem("theme","dark")):(window.document.documentElement.classList.remove("dark"),window.localStorage.setItem("theme","light"))}),[n]),{darkMode:n,setDarkMode:r}};var We=function(e){var t=e.logout,n=Object(i.c)((function(e){return e.users.currentUser})),r=Object(a.useState)(!1),s=Object(X.a)(r,2),c=s[0],o=s[1],l=Object(a.useState)(!1),d=Object(X.a)(l,2),u=d[0],m=d[1],b=Object(a.useState)({isOpen:!1,title:"",content:"",confirmButtonTitle:""}),f=Object(X.a)(b,2),j=f[0],x=f[1],p=$e(),v=p.darkMode,g=p.setDarkMode,h=n.avatarUrl,O=Object(a.useState)(!1),N=Object(X.a)(O,2),w=N[0],y=N[1],k=Object(a.useRef)();return Object(a.useEffect)((function(){var e=function(e){w&&k.current&&!k.current.contains(e.target)&&y(!1)};return document.addEventListener("mousedown",e),function(){document.removeEventListener("mousedown",e)}}),[w]),Object(W.jsxs)(W.Fragment,{children:[j.isOpen&&Object(W.jsx)(Re,{isOpen:j.isOpen,closeAction:function(){return x({isOpen:!1})},title:"Are you sure?",content:j.content,confirmButtonTitle:j.confirmButtonTitle,confirmButtonAction:j.confirmButtonAction}),Object(W.jsx)(Ze,{currentUser:n,isOpen:u,setIsOpen:m}),Object(W.jsx)(Ye,{isOpen:c,setIsOpen:o}),Object(W.jsxs)("div",{className:"pb-1 pt-4 flex justify-between items-center",children:[Object(W.jsxs)("div",{className:"flex items-center space-x-3",children:[Object(W.jsx)("div",{className:"transition-all duration-200 ring ring-green-500 p-1 transform active:scale-95 rounded-full cursor-pointer",onClick:function(){return m((function(e){return!e}))},children:Object(W.jsx)(ae,{src:h,size:"md",userName:n.userName})}),Object(W.jsx)("h1",{className:"font-bold text-3xl",children:"Chats"})]}),Object(W.jsxs)("div",{className:"flex space-x-2 items-center",children:[Object(W.jsx)(Ce,{iconClass:"bx bxs-edit",onClick:function(){return o(!0)},className:"dark:bg-dark-third bg-gray-100"}),Object(W.jsxs)("div",{className:"relative",ref:k,children:[Object(W.jsx)(Ce,{iconClass:"bx bx-dots-horizontal-rounded",onClick:function(){return y(!w)},className:"dark:bg-dark-third bg-gray-100"}),w&&Object(W.jsxs)("div",{className:"animate-fadeIn transition-all duration-200 absolute right-0 border border-gray-200 bg-white w-52 rounded-lg shadow-md overflow-hidden p-1 dark:bg-dark-secondary dark:border-dark-third mt-2 select-none z-30",children:[Object(W.jsxs)("button",{className:"flex items-center space-x-3 w-full pl-2 pr-4 py-2 rounded-md text-left hover:bg-gray-200 active:bg-gray-300 transition-all duration-200 transform active:scale-95 dark:hover:bg-dark-third",onClick:function(){return g(!v)},children:[Object(W.jsx)("span",{className:"p-1 bg-gray-100 dark:bg-dark-hover rounded-full select-none",children:Object(W.jsx)("i",{className:"text-center-middle text-center text-xl align-middle text-black dark:text-dark-txt w-7 h-7 bx  "+(v?" bx-sun":" bx-moon")})}),Object(W.jsx)("span",{children:v?"Light Mode":"Dark Mode"})]}),Object(W.jsxs)("button",{className:"flex items-center space-x-3 w-full pl-2 pr-4 py-2 rounded-md text-left hover:bg-gray-200 active:bg-gray-300 transition-all duration-200 transform active:scale-95 dark:hover:bg-dark-third",onClick:function(){!function(e,t){x({isOpen:!0,title:arguments.length>3?arguments[3]:void 0,content:e,confirmButtonTitle:arguments.length>2&&void 0!==arguments[2]?arguments[2]:"Yes",confirmButtonAction:t})}("Do you want to log out?",t)},children:[Object(W.jsx)("span",{className:"p-1 bg-gray-100 dark:bg-dark-hover rounded-full select-none",children:Object(W.jsx)("i",{className:" bx bx-log-in-circle text-center text-xl align-middle text-black dark:text-dark-txt w-7 h-7"})}),Object(W.jsx)("span",{children:"Log Out"})]})]})]})]})]})]})};var Je=function(){var e=Object(a.useState)(null),t=Object(X.a)(e,2),n=t[0],r=t[1],s=Object(Z.g)(),c=Object(i.b)(),o=Object(i.c)((function(e){return e.chats.chats})),l=Object(i.c)((function(e){return e.users.currentUser})),d=Object(i.c)((function(e){return e.chats.selectedId})),u=Me(),m=qe();function b(){window.localStorage.removeItem("token"),null===n||void 0===n||n.stop(),s.push("/login")}return Object(a.useEffect)((function(){function e(){return(e=Object(Q.a)(K.a.mark((function e(){return K.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:u.getAll().then((function(e){c(x(e.data))})).catch((function(e){console.error("Connection failed: ",e)})),m.getCurrentUser().then((function(e){c(R(e))})).catch((function(e){b()}));case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}!function(){e.apply(this,arguments)}()}),[]),Object(a.useEffect)((function(){var e=(new ee.a).withUrl("https://teeappapi.azurewebsites.net/hubs/chats",{accessTokenFactory:function(){return localStorage.getItem("token")}}).withAutomaticReconnect().build();r(e)}),[]),Object(a.useEffect)((function(){return n&&!n.connectionStarted&&n.start().then((function(e){n.on(oe,(function(e){var t=p(e);c(t),e.chatId&&d!==e.chatId&&c(O(e.chatId))})),n.on(le,(function(e){var t=f(e);c(t),e.creatorUserName===l.userName&&c(w(e.id))})),n.on(de,(function(e){var t=j(e);c(t)})),n.on(ue,(function(e){var t=g(e);c(t)})),n.on(me,(function(e){var t=N(e);c(t)})),n.on(be,(function(e){var t=P(e);c(t)}))})),function(){n&&n.connectionStarted&&n.stop()}}),[n]),Object(W.jsx)(W.Fragment,{children:Object(W.jsxs)("div",{className:"dark:bg-dark-primary dark:text-white animate-fadeIn grid grid-cols-12 h-screen w-screen overflow-hidden",children:[Object(W.jsxs)("div",{className:"animate-fadeIn lg:col-span-3 md:col-span-4 col-span-12 md:flex flex-col h-screen border-r px-4 dark:border-dark-third border-gray-300 pt-1"+(0!==d?" hidden":"flex"),children:[Object(W.jsx)(We,{logout:b}),Object(W.jsx)(ge,{})]}),d?Object(W.jsx)("div",{className:"dark:bg-dark-primary md:dark:bg-black animate-fadeIn lg:col-span-9 md:col-span-8 col-span-12 flex h-screen w-full overflow-y-auto",children:Object(W.jsx)(Ge,{chat:o.find((function(e){return e.id===d}))})}):0===(null===o||void 0===o?void 0:o.length)?Object(W.jsxs)("div",{className:"dark:bg-black animate-fadeIn hidden text-lg items-center justify-center lg:col-span-9 md:col-span-8 col-span-12 md:flex flex-col h-full w-full ",children:[Object(W.jsx)("img",{src:$,className:"w-32 h-32 mb-3",alt:"logo"}),Object(W.jsxs)("span",{className:"text-center",children:[" ","Welcome to"," ",Object(W.jsx)("span",{className:"text-green-600 dark:text-green-400 font-bold",children:"TeeChat!"})," ",Object(W.jsx)("br",{}),"You do not have any chats, please start a chat!"," "]}),Object(W.jsx)("span",{})]}):Object(W.jsxs)("div",{className:"dark:bg-black animate-fadeIn hidden text-lg items-center justify-center lg:col-span-9 md:col-span-8 col-span-12 md:flex flex-col h-full w-full ",children:[Object(W.jsx)("img",{src:$,className:"w-32 h-32 mb-3",alt:"logo"}),Object(W.jsxs)("span",{className:"text-center",children:[" ","Welcome to"," ",Object(W.jsx)("span",{className:"text-green-600 dark:text-green-400 font-bold",children:"TeeChat!"})," ",Object(W.jsx)("br",{}),"Select a chat to start."," "]})]})]})})},Ve=n.p+"static/media/forbid.7d678d5c.jpg";var _e=function(e){var t=e.message;return Object(W.jsxs)("div",{className:"animate-fadeIn fixed h-screen w-screen flex flex-col justify-center items-center space-y-8 px-2",children:[Object(W.jsx)("img",{className:"md:w-1/3 object-cover",src:Ve,alt:"Error"}),Object(W.jsx)("span",{className:"font-bold text-2xl md:text-3xl text-center",children:null!==t&&void 0!==t?t:"You don't have permission to access this resources"}),Object(W.jsx)(Y.b,{to:"/",children:Object(W.jsx)(V,{content:"Return home page"})})]})},He=n.p+"static/media/login-page.dc5637a7.jpg";var Ke=function(){var e=Object(a.useState)(""),t=Object(X.a)(e,2),n=t[0],r=t[1],s=Object(a.useState)(""),c=Object(X.a)(s,2),o=c[0],l=c[1],d=Object(a.useState)(""),u=Object(X.a)(d,2),m=u[0],b=u[1],f=Object(a.useState)(!1),j=Object(X.a)(f,2),x=j[0],p=j[1],v=(Object(Z.g)(),Object(i.b)()),g=qe();return Object(a.useEffect)((function(){p(!(!n||!m))}),[n,m]),Object(W.jsxs)("div",{className:"animate-fadeIn h-screen grid md:grid-cols-7 place-items-center px-6",children:[Object(W.jsx)("img",{src:He,alt:"login",className:"md:block hidden col-span-3 w-full ml-44"}),Object(W.jsxs)("form",{onSubmit:function(e){return function(e){e.preventDefault();var t={username:n,password:m};l(""),g.login(t).then((function(e){v(B()),window.localStorage.setItem("token",e),window.location.href="/TeeChat/"})).catch((function(e){l("string"===typeof e?e:"Oops, something went wrong! Please contact administrator.")}))}(e)},className:"container rounded-2xl flex flex-col py-10 md:w-auto md:col-span-4",children:[Object(W.jsx)("img",{src:$,alt:"login",className:"h-20 w-20 mx-auto mb-3"}),Object(W.jsx)("h1",{className:"text-3xl font-bold text-primary text-green-600 text-center mb-8",children:"Login to TeeChat!"}),o&&Object(W.jsx)("span",{className:"bg-red-500 rounded-md text-white text-lg mb-2 py-2 text-center",children:null!==o&&void 0!==o?o:"Username or password is incorrect"}),Object(W.jsxs)("div",{className:"space-y-2 mb-3",children:[Object(W.jsx)("label",{htmlFor:"username",className:"text-lg font-semibold px-1",children:"Username or email address"}),Object(W.jsx)("input",{value:n,onChange:function(e){return r(e.target.value)},id:"username",type:"text",className:"bg-gray-100 rounded-lg w-full py-2 px-4 focus:ring-2 focus:ring-green-500 focus:ring-opacity-50 outline-none transition-all duration-200 mb-2"})]}),Object(W.jsxs)("div",{className:"space-y-2 mb-2",children:[Object(W.jsx)("label",{htmlFor:"password",className:"text-lg font-semibold px-1",children:"Password"}),Object(W.jsx)("input",{value:m,onChange:function(e){return b(e.target.value)},type:"password",id:"password",className:"bg-gray-100 rounded-lg w-full py-2 px-4 focus:ring-2 focus:ring-green-500 focus:ring-opacity-50 outline-none transition-all duration-200"})]}),Object(W.jsx)(V,{disabled:!x,content:"Login",className:"mb-4 mt-2 font-bold"}),Object(W.jsxs)("div",{className:"text-center",children:["Not a member?"," ",Object(W.jsx)(Y.b,{to:"/register",className:"text-green-500 font-bold",children:"Sign up now"})]})]})]})},Qe=n.p+"static/media/not-found.500f302c.jpg";var Xe=function(e){var t=e.message;return Object(W.jsxs)("div",{className:"animate-fadeIn fixed h-screen w-screen flex flex-col justify-center items-center space-y-8 px-2",children:[Object(W.jsx)("img",{className:"md:w-1/3 object-cover",src:Qe,alt:"Error"}),Object(W.jsx)("span",{className:" font-bold text-2xl md:text-3xl text-center",children:null!==t&&void 0!==t?t:"Not found resources"}),Object(W.jsx)(Y.b,{to:"/",children:Object(W.jsx)(V,{content:"Return home page"})})]})},et=n(106),tt=n(24),nt=n(30);var at=function(){var e,t,n,r,s,c,i=Object(a.useState)(!1),o=Object(X.a)(i,2),l=o[0],d=o[1],u=Object(a.useState)(!0),m=Object(X.a)(u,2),b=m[0],f=m[1],j=Object(a.useState)({isOpen:!1,content:"",title:"Notification"}),x=Object(X.a)(j,2),p=x[0],v=x[1],g=Object(Z.g)(),h=qe(),O=nt.a().shape({firstName:nt.b().required("First Name is required"),lastName:nt.b().required("Last Name is required"),userName:nt.b().required("User Name is required").min(6,"Username must be 6-20 characters").max(20,"Username must be 6-20 characters").test("checkUsername","Username does not contain special characters",(function(e){return pe(e,"^[a-zA-Z0-9!@#$%^&*)(+=._-]{6,}$")})).test("existsUsername","Username is already taken",(function(e){return!b})),email:nt.b().required("Email is required").test("checkEmail","Email is invalid",(function(e){return pe(e,/^[a-zA-Z0-9_.+-]+@[a-zA-Z0-9-]+\.[a-zA-Z0-9-.]+$/)})),password:nt.b().required("Password is required").test("checkPassword","Passwords must be at least 8 characters, one digit, one uppercase, one non alphanumeric character",(function(e){return pe(e,"^(?=.*[a-z])(?=.*[A-Z])(?=.*\\d)(?=.*[#$^+=!*()@%&]).{8,}$")})),confirmPassword:nt.b().required("Confirm Password is required").test("ConfirmPasswordMatch","Password and Confirmation Password must match",(function(e){return e===E.password}))}),N=Object(tt.d)({resolver:Object(et.a)(O),defaultValues:{}}),w=N.register,y=N.handleSubmit,k=N.control,C=N.setError,S=N.clearErrors,U=N.reset,I=N.formState.errors,E=Object(tt.e)({control:k});function F(e,t){v({isOpen:!0,title:e,content:t})}return Object(a.useEffect)((function(){h.checkUserNameExists(E.userName).then((function(e){e.isExists?(C("userName",{type:"required",message:"Username '".concat(E.userName,"' is already taken")},{shouldFocus:!0}),f(!0)):(S("userName"),f(!1))}))}),[E.userName]),Object(a.useEffect)((function(){!function(){var e,t,n;(null===(e=E.firstName)||void 0===e?void 0:e.trim())&&(null===(t=E.lastName)||void 0===t?void 0:t.trim())&&(null===(n=E.userName)||void 0===n?void 0:n.trim())&&E.email&&E.password&&E.confirmPassword?d(!0):d(!1)}()}),[E]),Object(W.jsxs)(W.Fragment,{children:[Object(W.jsx)(_,{title:p.title,isOpen:p.isOpen,content:p.content,onClick:function(){v({isOpen:!1}),g.push("/login")}}),Object(W.jsxs)("div",{className:"animate-fadeIn z-10 h-screen grid md:grid-cols-7 place-items-center px-6",children:[Object(W.jsx)("img",{src:He,alt:"login",className:"md:block hidden col-span-3 w-full ml-44"}),Object(W.jsxs)("form",{onSubmit:y((function(e){h.register(e).then((function(e){F("Success",Object(W.jsxs)("span",{children:['"Create account successfully! Please'," ",Object(W.jsx)(Y.b,{className:"font-bold text-green-600",to:"/login",children:"log in"}),'!"']})),U({})})).catch((function(e){F("Notification",(null===e||void 0===e?void 0:e.errors)?ve(null===e||void 0===e?void 0:e.errors):"")}))})),className:"container rounded-2xl flex flex-col py-10 md:w-full md:col-span-4 md:px-20 lg:px-48",children:[Object(W.jsx)("img",{src:$,alt:"login",className:"h-20 w-20 mx-auto mb-3"}),Object(W.jsx)("h1",{className:"text-3xl font-bold text-primary text-green-600 text-center mb-8",children:"Sign up to TeeChat!"}),Object(W.jsxs)("div",{className:"mb-3 grid grid-cols-2 place-items-start ",children:[Object(W.jsxs)("div",{className:"col-span-1 space-y-2 mr-2 w-full",children:[Object(W.jsxs)("label",{htmlFor:"fistName",className:"text-lg font-semibold ",children:["First Name ",Object(W.jsx)("span",{className:"text-red-500",children:"*"})]}),Object(W.jsx)("input",Object(D.a)(Object(D.a)({},w("firstName")),{},{type:"text",className:"bg-gray-100 rounded-lg w-full py-2 px-3 focus:ring-2 focus:ring-green-500 focus:ring-opacity-50 outline-none transition-all duration-200"})),Object(W.jsx)("div",{className:"text-red-500 text-sm",children:null===(e=I.firstName)||void 0===e?void 0:e.message})]}),Object(W.jsxs)("div",{className:"col-span-1 space-y-2 ml-2 w-full",children:[Object(W.jsxs)("label",{htmlFor:"lastName",className:"text-lg font-semibold ",children:["Last Name ",Object(W.jsx)("span",{className:"text-red-500",children:"*"})]}),Object(W.jsx)("input",Object(D.a)(Object(D.a)({},w("lastName")),{},{type:"text",className:"bg-gray-100 rounded-lg w-full py-2 px-3 focus:ring-2 focus:ring-green-500 focus:ring-opacity-50 outline-none transition-all duration-200 mb-2"})),Object(W.jsx)("div",{className:"text-red-500 text-sm",children:null===(t=I.lastName)||void 0===t?void 0:t.message})]})]}),Object(W.jsxs)("div",{className:"space-y-2 mb-3",children:[Object(W.jsxs)("label",{htmlFor:"userName",className:"text-lg font-semibold ",children:["Username ",Object(W.jsx)("span",{className:"text-red-500",children:"*"})]}),Object(W.jsx)("input",Object(D.a)(Object(D.a)({},w("userName")),{},{type:"text",className:"bg-gray-100 rounded-lg w-full py-2 px-3 focus:ring-2 focus:ring-green-500 focus:ring-opacity-50 outline-none transition-all duration-200 mb-2"})),Object(W.jsx)("div",{className:"text-red-500 text-sm",children:null===(n=I.userName)||void 0===n?void 0:n.message})]}),Object(W.jsxs)("div",{className:"space-y-2 mb-3",children:[Object(W.jsxs)("label",{htmlFor:"email",className:"text-lg font-semibold ",children:["Email ",Object(W.jsx)("span",{className:"text-red-500",children:"*"})]}),Object(W.jsx)("input",Object(D.a)(Object(D.a)({},w("email")),{},{type:"text",className:"bg-gray-100 rounded-lg w-full py-2 px-3 focus:ring-2 focus:ring-green-500 focus:ring-opacity-50 outline-none transition-all duration-200 mb-2"})),Object(W.jsx)("div",{className:"text-red-500 text-sm",children:null===(r=I.email)||void 0===r?void 0:r.message})]}),Object(W.jsxs)("div",{className:"space-y-2 mb-2",children:[Object(W.jsxs)("label",{htmlFor:"password",className:"text-lg font-semibold ",children:["Password ",Object(W.jsx)("span",{className:"text-red-500",children:"*"})]}),Object(W.jsx)("input",Object(D.a)(Object(D.a)({type:"password"},w("password")),{},{className:"bg-gray-100 rounded-lg w-full py-2 px-3 focus:ring-2 focus:ring-green-500 focus:ring-opacity-50 outline-none transition-all duration-200"})),Object(W.jsx)("div",{className:"text-red-500 text-sm",children:null===(s=I.password)||void 0===s?void 0:s.message})]}),Object(W.jsxs)("div",{className:"space-y-2 mb-2",children:[Object(W.jsxs)("label",{htmlFor:"confirmPassword",className:"text-lg font-semibold ",children:["Confirm Password ",Object(W.jsx)("span",{className:"text-red-500",children:"*"})]}),Object(W.jsx)("input",Object(D.a)(Object(D.a)({type:"password"},w("confirmPassword")),{},{className:"bg-gray-100 rounded-lg w-full py-2 px-3 focus:ring-2 focus:ring-green-500 focus:ring-opacity-50 outline-none transition-all duration-200"})),Object(W.jsx)("div",{className:"text-red-500 text-sm",children:null===(c=I.confirmPassword)||void 0===c?void 0:c.message})]}),Object(W.jsx)(V,{disabled:!l,content:"Sign Up",className:"mb-4 mt-2 font-bold"}),Object(W.jsxs)("div",{className:"text-center",children:["Already a member?"," ",Object(W.jsx)(Y.b,{to:"/login",className:"text-green-500 font-bold",children:"Sign in"})]})]})]})]})},rt=n.p+"static/media/error.c72c9a3e.jpg";var st=function(e){var t=e.message;return Object(W.jsxs)("div",{className:"animate-fadeIn fixed h-screen w-screen flex flex-col justify-center items-center space-y-8 px-2",children:[Object(W.jsx)("img",{className:"md:w-1/3 object-cover",src:rt,alt:"Error"}),Object(W.jsx)("span",{className:"font-bold text-2xl md:text-3xl text-center",children:null!==t&&void 0!==t?t:"Oops! Something went wrong!"}),Object(W.jsx)(Y.b,{to:"/",children:Object(W.jsx)(V,{content:"Return home page"})})]})},ct=["component"];var it=function(){var e=Object(i.c)((function(e){return e.app.isLoading})),t=Object(i.c)((function(e){return e.app.popup})),n=Object(i.b)();return Object(W.jsx)(W.Fragment,{children:Object(W.jsxs)(Y.a,{basename:"/TeeChat",children:[Object(W.jsx)(J,{isOpen:e,className:"z-50"}),Object(W.jsx)(_,{title:t.title,isOpen:t.isOpen,content:t.content,onClick:function(){n(I({isOpen:!1}))}}),Object(W.jsxs)(Z.d,{children:[Object(W.jsx)(Z.b,{path:"/login",component:Ke}),Object(W.jsx)(Z.b,{path:"/register",component:at}),Object(W.jsx)(Z.b,{path:"/forbid",component:_e}),Object(W.jsx)(Z.b,{path:"/ServerError",component:st}),Object(W.jsx)(ot,{path:"/chats",component:Je}),Object(W.jsx)(ot,{exact:!0,path:"/",component:Je}),Object(W.jsx)(Z.b,{path:"*",component:Xe})]})]})})};function ot(e){var t=e.component,n=Object(G.a)(e,ct),a=!!window.localStorage.getItem("token");return Object(W.jsx)(Z.b,Object(D.a)(Object(D.a)({},n),{},{render:function(e){return!0===a?Object(W.jsx)(t,Object(D.a)({},e)):Object(W.jsx)(Z.a,{to:{pathname:"/login",state:{from:e.location}}})}}))}n(251);c.a.render(Object(W.jsx)(r.a.StrictMode,{children:Object(W.jsx)(i.a,{store:q,children:Object(W.jsx)(it,{})})}),document.getElementById("root"))}},[[252,1,2]]]);
//# sourceMappingURL=main.33d9fc35.chunk.js.map